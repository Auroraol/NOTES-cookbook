<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>程序运行发布(给别人电脑上能够正常运行): &mdash; X-NOTES latest 文档</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/translations.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> X-NOTES
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Linux.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Cmake/cmake.html">CMake</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">X-NOTES</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>程序运行发布(给别人电脑上能够正常运行):</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/Qt/note/QT笔记.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>程序运行发布和设置APP图标</p>
<section id="id1">
<h1>程序运行发布(给别人电脑上能够正常运行):<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h1>
<ul class="simple">
<li><p><strong>用  release</strong> 下创建</p></li>
</ul>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/SP%24XGJY5C28V%7DAAJ9&#64;C5F.png" /></p>
<ul class="simple">
<li><p>得到 exe文件</p></li>
</ul>
<p><img alt="image-20220618213542612" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220618213542612.png" /></p>
<ul class="simple">
<li><p>拷贝exe文件道要发布的文件夹里</p></li>
</ul>
<p><strong>cmd 打开</strong></p>
<ul>
<li><p>借助工具–&gt;自动生成exe文件的一系列依赖</p>
<p>添加好环境变量就能直接使用工具      windeployqt</p>
</li>
</ul>
<p><img alt="image-20220618213457203" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220618213457203.png" /></p>
<ul class="simple">
<li><p>最终结果(可以打包成压缩包)</p></li>
</ul>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/IRMZJRU3G%7DJTGCA%60ZT6N%7BII.png" /></p>
</section>
<section id="app">
<h1>设置APP图标<a class="headerlink" href="#app" title="永久链接至标题">¶</a></h1>
<ul class="simple">
<li><p>原本的:(比较丑)</p></li>
</ul>
<p><img alt="image-20220618214137098" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220618214137098.png" /></p>
<ul class="simple">
<li><p>**修改方式 ** 如下:</p></li>
</ul>
<ol class="simple">
<li><p>网上找 .ico后缀的图片</p></li>
<li><p>把图片放到源代码中,注意不是release中</p></li>
<li><p>添加一行代码</p></li>
<li><p><img alt="image-20220618214734781" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220618214734781.png" /></p></li>
</ol>
</section>
<hr class="docutils" />
<section id="qmainwindowqwidgetqdialog">
<h1>QMainWindow、QWidget、QDialog的区别<a class="headerlink" href="#qmainwindowqwidgetqdialog" title="永久链接至标题">¶</a></h1>
<p><strong>QMainWindow 类提供一个有菜单条、锚接窗口（例如工具条）和一个状态条的主应用程序窗口。</strong> 主窗口通常用在提供一个大的中央窗口部件（例如文本编辑或者绘制画布）以及周围菜单、工具条和一个状态条。QMainWindow常常被继承，因为这使得封装中央部件、菜单和工具条以及窗口状态条变得更容易，当用户点击菜单项或者工具条按钮时，槽会被调用。</p>
<p><strong>QWidget类是所有用户界面对象的基类。</strong> 窗口部件是用户界面的一个基本单元：它从窗口系统接收鼠标、键盘和其它事件，并且在屏幕上绘制自己。每一个窗口部件都是矩形的，并且它们按Z轴顺序排列。一个窗口部件可以被它的父窗口部件或者它前面的窗口部件盖住一部分。</p>
<p><strong>QDialog 是最普通的顶级窗口。</strong> 一个不会被嵌入到父窗口部件的窗口部件叫做顶级窗口部件。通常情况下，顶级窗口部件是有框架和标题栏的窗口（尽管使用了一定的窗口部件标记，创建顶级窗口部件时也可能没有这些装饰。）在Qt中，QMainWindow和不同的QDialog的子类是最普通的顶级窗口</p>
<section id="id2">
<h2>选用原则<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<ol class="simple">
<li><p><strong>如果是主窗体</strong>，则基于QMainWindow创建。</p></li>
<li><p>如果是顶级对话框，则基于QDialog创建。</p></li>
<li><p><strong>如果需要嵌入到其他窗体中</strong>，则基于QWidget创建</p></li>
<li><p>如果不确定，或者1 2两种情况都有，那么，就选择QWidget。</p></li>
</ol>
<hr class="docutils" />
<ul class="simple">
<li></li>
</ul>
</section>
</section>
<section id="id3">
<h1>项目文件组成及分析<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h1>
<section id="id4">
<h2>0.创建项目注意事项<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h2>
<p><img alt="image-20220718164826418" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220718164826418.png" /></p>
<hr class="docutils" />
<p><strong>类名一定遵循首字母大写</strong></p>
<p><img alt="image-20220718180408126" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220718180408126.png" /></p>
<hr class="docutils" />
<p>Qt项目文件</p>
<ul class="simple">
<li><p><a class="reference external" href="https://blog.csdn.net/weixin_43288201/article/details/105105777#pro_10">介绍一下项目管理文件（.pro文件）</a></p></li>
<li><p><a class="reference external" href="https://blog.csdn.net/weixin_43288201/article/details/105105777#Qtmain_49">Qt的main介绍</a></p></li>
<li><p><a class="reference external" href="https://blog.csdn.net/weixin_43288201/article/details/105105777#Qtwidgeth_72">Qt的widget.h介绍</a></p></li>
<li><p><a class="reference external" href="https://blog.csdn.net/weixin_43288201/article/details/105105777#Qtwidgetcpp_92">Qt的widget.cpp介绍</a></p></li>
<li><ul>
<li><p><a class="reference external" href="https://blog.csdn.net/weixin_43288201/article/details/105105777#WidgetWidgetQWidget_parent__QWidgetparent_109">Widget::Widget(QWidget *parent) : QWidget(parent)</a></p></li>
</ul>
</li>
</ul>
<p>在 Qt Creator 中新建一个 Widget Application 项目 samp2_1，在选择窗口<a class="reference external" href="https://so.csdn.net/so/search?q=%E5%9F%BA%E7%B1%BB&amp;spm=1001.2101.3001.7020">基类</a>的页面选择 QWidget 作为窗体基类，并选中“Generate form”复选框。创建后的项目文件目录树如图 1 所示。
<img alt="在这里插入图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/20200325215703867.png" />图 1 项目文件的目录树
这个项目包含以下一些文件：#千锋教育#</p>
<ul class="simple">
<li><p>项目管理文件 samp2_1.pro，存储项目设置的文件。</p></li>
<li><p>主程序入口文件 main.cpp，实现 main()函数的程序文件。</p></li>
<li><p>窗体界面文件 widget.ui，一个 XML 格式存储的窗体上的元件及 其布局的文件。</p></li>
<li><p>widget.h 是所设计的窗体类的头文件，widget.cpp 是 widget.h 里 定义类的实现文件。C++ 中，任何窗体或界面组件都是用类封装的，一个类一般有一个头文件（.h 文件）和一个源程序文件（.cpp 文件）。</p></li>
</ul>
</section>
<section id="pro">
<h2>一. 项目管理文件（.pro文件）<a class="headerlink" href="#pro" title="永久链接至标题">¶</a></h2>
<p><strong>后缀为“.pro”的文件是项目的管理文件，文件名就是项目的名称，如本项目中的 samp2_1.pro。 下面是 samp2_1.pro 文件的内容。</strong></p>
<ul>
<li><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>QT       += core gui	//包含的模块
//QT       += sql  // 需要sql
greaterThan(QT_MAJOR_VERSION, 4): QT += widgets	  //大于Qt4的版本 才需要包含widgets
TARGET = samp2_1		//应用程序名 生成的.exe文件名
TEMPLATE = app			//模板类型 应用程序模板
SOURCES += \			//包含的源文件
        main.cpp \
        widget.cpp
HEADERS += \			//包含的头文件
        widget.h
FORMS += \				//包含的ui文件
        widget.ui
</pre></div>
</div>
</li>
</ul>
<p>项目管理文件用于记录项目的一些设置，以及项目包含文件的组织管理。</p>
<ul>
<li><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>“Qt += core gui”表示项目中加入 core gui 模块。core gui 是 Qt 用于 GUI 设计的类库模块，
如果创建的是控制台（Console）应用程序，就不需要添加 core gui。
</pre></div>
</div>
</li>
</ul>
<p>Qt 类库以模块的形式组织各种功能的类，根据项目涉及的功能需求，在项目中添加适当的类库模块支持。例如，如果项目中使用到了涉及数据库操作的类就需要用到 sql 模块，在 pro 文件中需要增加如下一行：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Qt</span> <span class="o">+=</span><span class="n">sql</span>
</pre></div>
</div>
<p>samp2_1.pro 中的第 2 行是：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">greaterThan</span><span class="p">(</span><span class="n">Qt_MAJOR_VERSION</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span> <span class="n">Qt</span> <span class="o">+=</span> <span class="n">widgets</span>
</pre></div>
</div>
<p>这是个条件执行语句，表示当 Qt 主版本大于 4 时，才加入 widgets 模块。</p>
<ul>
<li><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>“TARGET = samp2_1”表示生成的目标可执行文件的名称，即编译后生成的可执行文件是 samp2_1.exe。

“TEMPLATE = app”表示项目使用的模板是 app，是一般的应用程序。
</pre></div>
</div>
</li>
</ul>
<p>后面的 SOURCES、HEADERS、FORMS 记录了项目中包含的源程序文件、头文件和窗体文件（.ui 文件）的名称。这些文件列表是 Qt Creator 自动添加到项目管理文件里面的，用户不需要手动修改。当添加一个文件到项目，或从项目里删除一个文件时，项目管理文件里的条目会自动修改。</p>
</section>
<section id="main-cpp">
<h2>二. main.cpp介绍<a class="headerlink" href="#main-cpp" title="永久链接至标题">¶</a></h2>
<p>main.cpp</p>
<ul>
<li><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QApplication&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="c1">//QApplication 应用程序类 初始化我们的应用程序</span>
    <span class="n">QApplication</span> <span class="n">a</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span>

    <span class="c1">//创建一个窗口控件</span>
    <span class="n">Widget</span> <span class="n">w</span><span class="p">;</span>

    <span class="c1">//显示一个窗口  hide隐藏窗口</span>
    <span class="c1">//窗口默认是隐藏的</span>
    <span class="n">w</span><span class="p">.</span><span class="n">show</span><span class="p">();</span>

    <span class="c1">//a.exec() 主事件循环（带阻塞 等待用户操作界面）</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">exec</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p><img alt="image-20220317214141637" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220317214141637.png" /></p>
</li>
</ul>
</section>
<section id="qtwidget-h">
<h2>三. Qt的widget.h介绍<a class="headerlink" href="#qtwidget-h" title="永久链接至标题">¶</a></h2>
<p>widget.h</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifndef HELLOWORLD_H</span>
<span class="cp">#define HELLOWORLD_H</span>

<span class="cp">#include</span> <span class="cpf">&lt;QWidget&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">Ui</span> <span class="p">{</span>  <span class="c1">// 名称空间</span>
<span class="k">class</span> <span class="nc">HelloWorld</span><span class="p">;</span>  <span class="c1">//自动生成的ui-xxx文件</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">HelloWorld</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QWidget</span>   <span class="c1">//HelloWorld 和上面的那个不是一会事,只是同名.   // 这个是继承 QWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>  <span class="c1">// 宏 //让Widget支持信号和槽机制</span>

<span class="k">public</span><span class="o">:</span>
    <span class="k">explicit</span> <span class="n">HelloWorld</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>  <span class="c1">// 构造</span>
    <span class="o">~</span><span class="n">HelloWorld</span><span class="p">();</span>  <span class="c1">// 析构</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">Ui</span><span class="o">::</span><span class="n">HelloWorld</span> <span class="o">*</span><span class="n">ui</span><span class="p">;</span>  <span class="c1">//通过ui 指向ui界面的组件</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="c1">// HELLOWORLD_H</span>
</pre></div>
</div>
</section>
<section id="qtwidget-cpp">
<h2>四.Qt的widget.cpp介绍<a class="headerlink" href="#qtwidget-cpp" title="永久链接至标题">¶</a></h2>
<ul>
<li><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;helloworld.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;ui_helloworld.h&quot;</span><span class="cp"></span>

<span class="n">HelloWorld</span><span class="o">::</span><span class="n">HelloWorld</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="o">:</span>      <span class="c1">// 派生类的构造函数   //QWidget(parent)是基类的构造函数</span>
    <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">),</span>        <span class="c1">// Widget是调用了QWidget下面的构造函数</span>
    <span class="n">ui</span><span class="p">(</span><span class="k">new</span> <span class="n">Ui</span><span class="o">::</span><span class="n">HelloWorld</span><span class="p">)</span>  <span class="c1">// 成员初始化列表的方式</span>
<span class="p">{</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">setupUi</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>   <span class="c1">// setupUi()一个函数,实现各种基础功能 //界面的设计是在 窗口控件的构造函数中设计</span>
<span class="p">}</span>

<span class="n">HelloWorld</span><span class="o">::~</span><span class="n">HelloWorld</span><span class="p">()</span>  <span class="c1">//析构</span>
<span class="p">{</span>
    <span class="k">delete</span> <span class="n">ui</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
<p>Widget::Widget(QWidget *parent) : QWidget(parent)</p>
<p>既然调用了QWidget(parent)这个构造函数，QWidget父类都做了哪些动作呢？
下面是QWidget源码中的一部分节选：</p>
<ul>
<li><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">QWidget</span><span class="o">::</span><span class="n">QWidget</span><span class="p">(</span> <span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="n">WFlags</span> <span class="n">f</span> <span class="p">)</span>
    <span class="o">:</span> <span class="n">QObject</span><span class="p">(</span> <span class="n">parent</span><span class="p">,</span> <span class="n">name</span> <span class="p">),</span> <span class="n">QPaintDevice</span><span class="p">(</span> <span class="n">PDT_WIDGET</span> <span class="p">),</span>
      <span class="n">pal</span><span class="p">(</span> <span class="n">parent</span> <span class="o">?</span> <span class="n">parent</span><span class="o">-&gt;</span><span class="n">palette</span><span class="p">()</span>		<span class="c1">// use parent&#39;s palette//使用父母的板</span>
           <span class="o">:</span> <span class="o">*</span><span class="n">qApp</span><span class="o">-&gt;</span><span class="n">palette</span><span class="p">()</span> <span class="p">)</span>			<span class="c1">// use application palette</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">parent</span> <span class="p">)</span> <span class="p">{</span>
	<span class="n">QChildEvent</span> <span class="o">*</span><span class="n">e</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QChildEvent</span><span class="p">(</span> <span class="n">Event_ChildInserted</span><span class="p">,</span> <span class="k">this</span> <span class="p">);</span>
	<span class="n">QApplication</span><span class="o">::</span><span class="n">postEvent</span><span class="p">(</span> <span class="n">parent</span><span class="p">,</span> <span class="n">e</span> <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
<p>从上面可以看出，如果parent参数非空的话，那么该构造函数使用了其父窗口的调色板，并且发送了QChildEvent事件，这会让新的窗口成为parent所指窗口的子窗口，那么当父窗口被删除时，子窗口也会自动的被删除。</p>
</section>
<section id="ui-widght-h">
<h2>五ui_widght.h文件<a class="headerlink" href="#ui-widght-h" title="永久链接至标题">¶</a></h2>
<p>自动生成的</p>
<p><img alt="image-20220618223909429" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220618223909429.png" /></p>
</section>
</section>
<hr class="docutils" />
<section id="main">
<h1><strong>main（）认识：</strong><a class="headerlink" href="#main" title="永久链接至标题">¶</a></h1>
<p><strong>快捷键</strong></p>
<p>//注释  ctrl + /
//运行  ctrl + r
==//保存  ctrl + s==
==//编译  ctrl + b==
//查找  ctrl + f
//字体缩放 ctrl+ 鼠标滚轮
==//帮助文档  f1==
==//自动对齐  ctrl + i==
==//同名之间的.h 和.cpp文件的切换 f4==</p>
<ul class="simple">
<li><p>2，文件名和创建路径==一定不能用中文==</p></li>
<li><p><strong>QT中main（）认识：</strong></p></li>
<li><p><img alt="image-20220317214141637" src="Qt/note/C:%5CUsers%5C16658%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20220317214141637.png" /></p></li>
</ul>
<p>+++++</p>
<p><strong>QT有的类为什么不添加头文件也能直接使用原因</strong>：</p>
<p>==类继承很复杂你已经添加头文件中已经引入其他类的头文件了==</p>
<p>++++</p>
<p><strong>代码化ui设计的原则:</strong></p>
<ul class="simple">
<li><p>能用可视化u的方式就用可视化的方式,有些组件不能通过ui的方式就用代码</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="id5">
<h1>知识点一: 按钮的使用与窗体的简单设置(重要)<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h1>
<p><strong>代码化ui设计的原则 :</strong></p>
<ul class="simple">
<li><p><strong>能用可视化u的方式就用可视化的方式,有些组件不能通过ui的方式就用代码</strong></p></li>
</ul>
<hr class="docutils" />
<ul>
<li><ol>
<li><p>#include <QPushButton></p></li>
<li><p>QPushButton  * btn3 = new  QPushButton(”按键内容” , this);</p></li>
<li><p>尽量别再方法中声明按钮</p></li>
<li><p><strong>内存自动回收：</strong></p></li>
<li><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    QT中的对象指针在满足下列情况会自动回收内存
    // 1. 从QObject派生的类 1.直接 2.间接
    // 2. 指定父类, 父亲析构的时候,先析构他的孩子
    // 创建自定义按钮对象
QPushButton的常用信号：&amp;QPushButton::clicked  
</pre></div>
</div>
</li>
<li><p>窗体相关属性设置：</p>
<p><strong>下列全是方法</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>

show()方法  //默认是会以顶层方式重新弹出来一个窗口

showFullScreen() // 全屏显示


move（x,y）  //改变子窗位置

&quot;&quot;&quot;
setText(”文本“) 设置文本   &lt;=&gt; QPushButton  * btn3 = new                                                                                       QPushButton(&quot;文本&quot; ,this); 
setParent（this）设置父类  &lt;=&gt;
&quot;&quot;&quot;  

resize(600,1200);   //设置窗口大小，左上角是原点 

setFixedSize(600,800); //设置窗体固定窗口的大小,不能被移动

setWindowIcon(QIcon(&quot;E:\\1.jpg图片路径&quot;)); //给窗口加图标

setWindowTitle（”标题“） //设置窗口标题

setStyleSheet(&quot;background-color: balck&quot;);    // 设置背景黑色
setStyleSheet(&quot;background-image:url(资源文件));    

//当前主窗口的宽度与高度
int a = this-&gt;width();   
int b = this-&gt;height() ;

</pre></div>
</div>
</li>
</ol>
</li>
<li><p><strong>资源文件：</strong></p>
<ul class="simple">
<li><p>设置图片（==setWindowIcon(QIcon(”E:\1.jpg图片路径”)); //给窗口加图标== ）</p></li>
<li><p><img alt="image-20220317222311789" src="Qt/note/C:%5CUsers%5C16658%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20220317222311789.png" /></p></li>
</ul>
</li>
</ul>
</section>
<section id="id6">
<h1>对象树<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h1>
<ul>
<li><p><strong>当创建一个以另一个对象作为父对象的QObject时，它被添加到父对象的children()列表中，并在父对象是时被删除。</strong></p></li>
<li><p><strong>但关闭窗口时,组件是依附窗体,会自动关闭. 所以不用delete</strong></p></li>
<li><p><strong>内存自动回收:</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">QT中的对象指针在满足下列情况会自动回收内存</span>
<span class="c1">// 1. 从QObject派生的类 1.直接 2.间接</span>
<span class="c1">// 2. 指定父类, 父亲析构的时候,先析构他的孩子</span>
<span class="c1">// 创建自定义按钮对象</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="id7">
<h1>知识点二: 信号槽机制(重要)(难点)<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h1>
<p>signal and slot</p>
<ul class="simple">
<li><p><img alt="信号槽" src="https://img-blog.csdnimg.cn/c75f8f72221c46c5b0f78bb930bfe382.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16" /></p></li>
</ul>
<section id="id8">
<h2>普通信号普通槽(系统自带)<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h2>
<ul>
<li><p>例如QPushButton的父类QAbstractButton 有Signals里面有 <strong>clicked , pressed , released,toggled</strong>
​</p></li>
<li><p>信号和槽函数 都是函数,</p></li>
<li><p><strong>信号只需要声明(只是函数的声明)</strong>（需要发出去时要用emit发送）,不需要函数定义 ,</p></li>
<li><p><strong>槽需要声明和定义</strong>,属于回调函数</p></li>
<li><p><strong>使用connect()</strong></p>
<p>==格式如下不要去深究:==</p>
</li>
</ul>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// 需求 点击上面的btn按钮,执行窗口关闭动作  </span>

    <span class="c1">//建立两者的连接:  connect(btn, 发出的信号, this, 处理信号的槽函数);</span>

    <span class="n">connect</span><span class="p">(</span><span class="o">&amp;</span><span class="n">btn</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">QPushButton</span><span class="o">::</span><span class="n">clicked</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">MyWidget</span><span class="o">::</span><span class="n">close</span><span class="p">);</span>

    <span class="cm">/*      格式:  &amp; + 信号发出者类的名字 + :: + 信号的名字</span>
<span class="cm">     * b1: 信号的发出者, 此参数必须是是一个指针</span>
<span class="cm">     * &amp;QPushButton::clicked: 信号发出者, 内部的一个信号   // 在类以外直接用类的属性或者方法 用::</span>
<span class="cm">     * this: 信号的接收者, 此参数是一个指针</span>
<span class="cm">     * &amp;MyWidget::close: 信号的处理函数, 属于this</span>
<span class="cm">    */</span> <span class="n">emit</span>
</pre></div>
</div>
<p>==<strong>注意：是发出槽函数的类，不一定是qt自带的类</strong>==</p>
<ol class="simple">
<li><p>槽函数可以发出信号或者自己做某些功能</p></li>
<li><p>一个信号可以触发另一个信号，</p></li>
<li><p>一个信号关联多个槽函数</p></li>
</ol>
<hr class="docutils" />
<section id="id9">
<h3>自定义槽函数<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h3>
<p>不创建新的c++的情况</p>
<ol class="simple">
<li><p>声明</p></li>
</ol>
<p><img alt="image-20220619215514168" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220619215514168.png" /></p>
<ol class="simple">
<li><p>定义</p></li>
</ol>
<p><img alt="image-20220619215342075" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220619215342075.png" /></p>
<ol class="simple">
<li><p>使用</p></li>
</ol>
<p><img alt="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220619215329089.png" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220619215329089.png" /></p>
</section>
<section id="signal-slot">
<h3>重点  看 Signal_Slot的代码<a class="headerlink" href="#signal-slot" title="永久链接至标题">¶</a></h3>
</section>
</section>
<section id="id10">
<h2>**自定义信号和槽函数 **<a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h2>
<p>定义对象-&gt;声明一个槽函数-&gt;定义一个槽函数：写明具体功能</p>
<p>==回去： 先通过槽函数发出信号 ，主窗口接受再发过来信号  （定义一个槽函数和信号（目的通过这个槽函数发起信号）再主窗口定义一个槽函数去接受发过来的信号==</p>
<div class="highlight-ASN.1 notranslate"><div class="highlight"><pre><span></span>// 自定义槽函数
    /*
     * 1. 槽函数在Qt5 可以是任意类成员函数, 全局函数, 静态函数, lambda表达式(隐式函数)
     * 2. 槽函数需要与信号对相应(返回值, 参数)
     * 3. 信号,槽函数返回值是: void
     定义成共有部分
     * 4. void mysig(int, double, QString);
     *    void myslot(int, double);
     * 5. 槽函数的参数是为了接受信号传过来的的数据
     * 6. 槽函数的参数应该是不能够大于信号的参数个数, 可以少于信号的参数个数
     * 7. 槽函数可以重载，注意槽函数重载了，必须使用函数指针QT的格式: void (Subwigdet::*MySigSub)() = 
                                                                           &amp;Subwigdet::sigSub;
     
     * 8. emit发信号
</pre></div>
</div>
<p><strong>需要新建一个.cpp文件</strong></p>
<ul class="simple">
<li><p>在signals: 下面定义信号</p></li>
<li><p>在public slots: 下声明槽函数</p></li>
</ul>
<p><strong>代码</strong>：</p>
<section id="id11">
<h3>定义槽函数<a class="headerlink" href="#id11" title="永久链接至标题">¶</a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">mainwidget</span><span class="p">.</span><span class="n">h文件</span>
    
<span class="cp">#ifndef WIDGET_H</span>
<span class="cp">#define WIDGET_H</span>

<span class="cp">#include</span> <span class="cpf">&lt;QWidget&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;QPushButton&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;subwigdet.h&gt; //a自己添加的类在那用就要include</span><span class="cp"></span>

<span class="k">class</span> <span class="nc">Widget</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>

<span class="k">public</span><span class="o">:</span>
    <span class="n">Widget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
    <span class="o">~</span><span class="n">Widget</span><span class="p">();</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">QPushButton</span><span class="o">*</span> <span class="n">btn</span><span class="p">;</span>
    <span class="n">QPushButton</span> <span class="n">b1</span><span class="p">;</span>
    <span class="c1">//a1</span>
    <span class="n">QPushButton</span><span class="o">*</span> <span class="n">b3</span><span class="p">;</span>

 <span class="c1">//1自定义槽函数</span>
    <span class="kt">void</span> <span class="nf">slotForwidget</span><span class="p">();</span>

    <span class="kt">void</span> <span class="nf">slotHideme</span><span class="p">();</span> <span class="c1">// a4</span>
 
    <span class="c1">//创建一个子窗口对象（a）</span>
    <span class="n">Subwigdet</span> <span class="n">subw</span><span class="p">;</span>       <span class="c1">//b2  // 创建一个子窗口对象 Subwidget: 就是封装了一个子窗口</span>
    <span class="c1">//  b 槽函数</span>
    <span class="kt">void</span> <span class="nf">slotshowme</span><span class="p">();</span>   <span class="c1">//b3</span>
    <span class="kt">void</span> <span class="nf">slotsubmsg</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">,</span> <span class="n">QString</span> <span class="n">str</span><span class="p">);</span> <span class="c1">//c</span>

<span class="p">};</span>

<span class="cp">#endif </span><span class="c1">// WIDGET_H</span>
</pre></div>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">mainwidget</span><span class="p">.</span><span class="n">cpp文件</span>

<span class="cp">#include</span> <span class="cpf">&quot;widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;QPushButton&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;QDebug&gt;  //输出</span><span class="cp"></span>

<span class="n">Widget</span><span class="o">::</span><span class="n">Widget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span>
    <span class="o">:</span> <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">btn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s">&quot;按钮&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">);</span>
    <span class="n">btn</span><span class="o">-&gt;</span><span class="n">move</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="mi">200</span><span class="p">);</span>

    <span class="k">this</span><span class="o">-&gt;</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s">&quot;fcc&quot;</span><span class="p">);</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="s">&quot;c:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">16658</span><span class="se">\\</span><span class="s">Desktop</span><span class="se">\\</span><span class="s">q&quot;</span><span class="p">));</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">btn</span><span class="p">,</span><span class="o">&amp;</span><span class="n">QPushButton</span><span class="o">::</span><span class="n">clicked</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="o">&amp;</span><span class="n">Widget</span><span class="o">::</span><span class="n">close</span><span class="p">);</span>

    <span class="c1">//1定义槽函数：</span>
    <span class="n">b1</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;老二&quot;</span><span class="p">);</span>
    <span class="n">b1</span><span class="p">.</span><span class="n">setParent</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">connect</span><span class="p">(</span><span class="o">&amp;</span><span class="n">b1</span><span class="p">,</span><span class="o">&amp;</span><span class="n">QPushButton</span><span class="o">::</span><span class="n">released</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="o">&amp;</span><span class="n">Widget</span><span class="o">::</span><span class="n">slotForwidget</span><span class="p">);</span> <span class="c1">// 简单的使用自定义槽函数</span>


    <span class="c1">//a2</span>
    <span class="n">b3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s">&quot;软件园&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">);</span>
    <span class="n">b3</span><span class="o">-&gt;</span><span class="n">move</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">);</span>
    <span class="n">b3</span><span class="o">-&gt;</span><span class="n">resize</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">50</span><span class="p">);</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">b3</span><span class="p">,</span><span class="o">&amp;</span><span class="n">QPushButton</span><span class="o">::</span><span class="n">clicked</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="o">&amp;</span><span class="n">Widget</span><span class="o">::</span><span class="n">slotHideme</span><span class="p">);</span>  <span class="c1">//a3开始定义槽函数</span>
    <span class="c1">//a进去子窗口之后在回到主窗口b1</span>
    <span class="c1">//b2开始设置信号和信号接收对象</span>
    <span class="kt">void</span> <span class="p">(</span><span class="n">Subwigdet</span><span class="o">::*</span><span class="n">MySigSub</span><span class="p">)()</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">Subwigdet</span><span class="o">::</span><span class="n">sigSub</span><span class="p">;</span>  <span class="c1">//函数指针</span>
    <span class="n">connect</span><span class="p">(</span><span class="o">&amp;</span><span class="n">subw</span><span class="p">,</span><span class="n">MySigSub</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="o">&amp;</span><span class="n">Widget</span><span class="o">::</span><span class="n">slotshowme</span><span class="p">);</span>   <span class="c1">//slotshowme槽函数</span>

    <span class="kt">void</span> <span class="p">(</span><span class="n">Subwigdet</span><span class="o">::*</span><span class="n">MysigPlus</span><span class="p">)(</span><span class="kt">int</span><span class="p">,</span><span class="n">QString</span><span class="p">)</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">Subwigdet</span><span class="o">::</span><span class="n">sigSub</span><span class="p">;</span> <span class="c1">//函数指针</span>
    <span class="n">connect</span><span class="p">(</span><span class="o">&amp;</span><span class="n">subw</span><span class="p">,</span><span class="n">MysigPlus</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="o">&amp;</span><span class="n">Widget</span><span class="o">::</span><span class="n">slotsubmsg</span><span class="p">);</span>  <span class="c1">//槽函数重载c //函数指针,如果你的信号或者超发生重载就要使用函数指针</span>

<span class="p">}</span>
<span class="n">Widget</span><span class="o">::~</span><span class="n">Widget</span><span class="p">(){}</span>
<span class="c1">//1</span>
<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">slotForwidget</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">b1</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;修改了&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">//a5 写槽函数的目的  写明具体功能</span>
<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">slotHideme</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">//隐藏自己（主窗口）</span>
    <span class="n">hide</span><span class="p">();</span>
    <span class="c1">//显示软件园窗口 a6去编写子窗口按钮</span>
    <span class="n">subw</span><span class="p">.</span><span class="n">show</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">//b</span>
<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">slotshowme</span><span class="p">()</span>  <span class="c1">//slotshowme</span>
<span class="p">{</span>
    <span class="c1">//显示自己</span>
    <span class="n">show</span><span class="p">();</span>
    <span class="c1">//软件园窗口</span>
    <span class="n">subw</span><span class="p">.</span><span class="n">hide</span><span class="p">();</span>
<span class="p">}</span>
<span class="c1">//显示一下发过来的重载信号</span>
<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">slotsubmsg</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">,</span> <span class="n">QString</span> <span class="n">str</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">qDebug</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">num</span> <span class="o">&lt;&lt;</span> <span class="n">str</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="id12">
<h3>定义信号<a class="headerlink" href="#id12" title="永久链接至标题">¶</a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">subwidget</span><span class="p">.</span><span class="n">h</span>

<span class="cp">#ifndef SUBWIGDET_H</span>
<span class="cp">#define SUBWIGDET_H</span>

<span class="cp">#include</span> <span class="cpf">&lt;QWidget&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;QPushButton&gt;</span><span class="cp"></span>

<span class="c1">//Subwiget是一个窗口类但是一个子窗口</span>
<span class="k">class</span> <span class="nc">Subwigdet</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>
<span class="k">public</span><span class="o">:</span>
    <span class="k">explicit</span> <span class="n">Subwigdet</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="k">nullptr</span><span class="p">);</span>

<span class="nl">signals</span><span class="p">:</span>
    <span class="c1">//在signals下面定义信号</span>
    <span class="kt">void</span> <span class="n">sigSub</span><span class="p">();</span>        <span class="c1">//b2</span>
    <span class="c1">//1,可以有参数</span>
    <span class="c1">//2,可以重载</span>
    <span class="c1">//3,返回zhi为void</span>
    <span class="c1">//4,发送信号： emit + 信号名</span>
                <span class="c1">//emit sigsub()；</span>
    <span class="kt">void</span> <span class="nf">sigSub</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="n">QString</span><span class="p">);</span> <span class="c1">//c</span>


<span class="k">public</span> <span class="nl">slots</span><span class="p">:</span>
    <span class="kt">void</span> <span class="n">myslot</span><span class="p">();</span>        <span class="c1">//b3</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">QPushButton</span><span class="o">*</span> <span class="n">b1</span><span class="p">;</span> <span class="c1">//a7（1）</span>

<span class="p">};</span>

<span class="cp">#endif </span><span class="c1">// SUBWIGDET_H</span>
</pre></div>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">subwidget</span><span class="p">.</span><span class="n">cpp</span>

<span class="cp">#include</span> <span class="cpf">&quot;subwigdet.h&quot;</span><span class="cp"></span>

<span class="n">Subwigdet</span><span class="o">::</span><span class="n">Subwigdet</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="o">:</span> <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">//b7 子窗口的编写</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s">&quot;中层&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">);</span>
    <span class="n">b1</span><span class="o">-&gt;</span><span class="n">resize</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">);</span>
    <span class="n">b1</span><span class="o">-&gt;</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s">&quot;软件园窗口&quot;</span><span class="p">);</span>
    <span class="n">resize</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">);</span>

    <span class="c1">//a进去子窗口之后在回到主窗口b</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span><span class="o">&amp;</span><span class="n">QPushButton</span><span class="o">::</span><span class="n">clicked</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="o">&amp;</span><span class="n">Subwigdet</span><span class="o">::</span><span class="n">myslot</span><span class="p">);</span>  <span class="c1">//myslot() 子窗口的槽函数</span>

<span class="p">}</span>

<span class="c1">//b  子窗口的槽函数</span>
<span class="kt">void</span> <span class="n">Subwigdet</span><span class="o">::</span><span class="n">myslot</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">//发出信号</span>
    <span class="n">emit</span> <span class="n">sigSub</span><span class="p">();</span>
    <span class="n">emit</span> <span class="nf">sigSub</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="s">&quot;二百五&quot;</span><span class="p">);</span> <span class="c1">//c</span>
<span class="p">}</span>
</pre></div>
</div>
<p>重点：</p>
<p>==<strong>注意：是发出槽函数的类，不一定是qt自带的类</strong>==</p>
<p>==<strong>信号的发出者, 此参数必须是是一个指针</strong>==</p>
<p>==<strong>尽量别再方法中声明按钮</strong>==,除非用动态对象时</p>
<p>==<strong>要用就必须连用  public slots:和  signals: 在去定义相应的槽函数和信号</strong>==</p>
</section>
</section>
</section>
<hr class="docutils" />
<section id="qtqdebug">
<h1>QT的输出qDebug()函数<a class="headerlink" href="#qtqdebug" title="永久链接至标题">¶</a></h1>
<p><strong>qDebug()  &lt;&lt;</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;QDebug&gt;</span><span class="cp"></span>

<span class="n">qDebug</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;hello , 您好&quot;</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">18</span><span class="p">;</span>
<span class="n">QString</span> <span class="n">str</span> <span class="o">=</span> <span class="s">&quot;小魔女琪琪&quot;</span><span class="p">;</span>
<span class="n">qDebug</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">num</span> <span class="o">&lt;&lt;</span> <span class="n">str</span><span class="p">;</span>
<span class="n">qDebug</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">num</span> <span class="o">&lt;&lt;</span> <span class="n">str</span><span class="p">.</span><span class="n">toUtf8</span><span class="p">().</span><span class="n">data</span><span class="p">();</span>  <span class="c1">//如果出现中文乱码的情况,可以这样</span>
</pre></div>
</div>
</section>
<section id="qstringlist">
<h1>QStringlist  所有字符串的列表<a class="headerlink" href="#qstringlist" title="永久链接至标题">¶</a></h1>
<p><strong>返回包含子字符串 str 的所有字符串的列表：</strong></p>
<ol>
<li><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span>  <span class="n">QStringList</span> <span class="n">list</span><span class="p">;</span>
<span class="mf">2.</span>  <span class="n">list</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Bill Murray&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;John Doe&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Bill Clinton&quot;</span><span class="p">;</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="qtlambda">
<h1>知识点四: QT中的lambda表达式<a class="headerlink" href="#qtlambda" title="永久链接至标题">¶</a></h1>
<p><img alt="请添加图片描述" src="https://img-blog.csdnimg.cn/a1cc9e4d285e410ba8023e46bcb57d53.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16" /></p>
<ul>
<li><p>**lambda作为槽函数就不需要额外的定义了 **（槽函数简单的时候用来直接代替槽函数）<code class="docutils literal notranslate"><span class="pre">,当然这种方式需要在</span> <span class="pre">.pro文件中</span> <span class="pre">引入c+11的特性,因为lambda是c++11的一个特性,引入命令</span></code></p></li>
<li><p>1.<strong>CONFIG += c++11</strong></p></li>
<li><ol class="simple">
<li></li>
</ol>
<p>connect(对象, &amp;+ 信号发出者类的名字 + :: + 信号的名字,对象，【=】()</p>
<p>{</p>
<p>​          <strong>………….</strong></p>
<p>});</p>
<p>==如：==</p>
<p><img alt="img" src="https://img-blog.csdnimg.cn/25a3a46463f54aad87d5ca2a8eb225ee.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16" /></p>
</li>
</ul>
<p>要的：</p>
<p>==<strong>#include <QDebug></strong>==</p>
<p>==<strong>qDebug() &lt;&lt; “hello , 您好”;</strong>==</p>
</section>
<hr class="docutils" />
<section id="ui">
<h1>知识点五: 带UI界面的项目<a class="headerlink" href="#ui" title="永久链接至标题">¶</a></h1>
<p><img alt="image-20220618204639922" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220618204639922.png" /></p>
<section id="id13">
<h2><strong>通过ui-&gt;控件名</strong>        访问到控件<a class="headerlink" href="#id13" title="永久链接至标题">¶</a></h2>
</section>
<section id="id14">
<h2>一般情况下;   回去点击跳转到槽—–&gt;可以直接自动声明槽函数(方便)<a class="headerlink" href="#id14" title="永久链接至标题">¶</a></h2>
<p>+++++</p>
</section>
<section id="id15">
<h2>各种控件作用<a class="headerlink" href="#id15" title="永久链接至标题">¶</a></h2>
<p><img alt="image-20220318102127545" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318102127545.png" /></p>
</section>
<section id="buttons">
<h2>Buttons控件<a class="headerlink" href="#buttons" title="永久链接至标题">¶</a></h2>
<p><img alt="image-20220318102916601" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318102916601.png" />![image-2022031810</p>
<section id="push-button">
<h3>0. Push Button样式设置<a class="headerlink" href="#push-button" title="永久链接至标题">¶</a></h3>
</section>
<section id="toolbutton">
<h3>1. ToolButton<a class="headerlink" href="#toolbutton" title="永久链接至标题">¶</a></h3>
<p><img alt="image-20220623211906934" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220623211906934.png" /></p>
<p><img alt="image-20220623212348014" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220623212348014.png" /></p>
<p><img alt="image-20220623212617590" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220623212617590.png" /></p>
</section>
<hr class="docutils" />
<section id="radio-button-group-button">
<h3>2.Radio Button  &amp;&amp;  Group Button<a class="headerlink" href="#radio-button-group-button" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li><p><strong>成组使用, 只能单选.</strong></p></li>
</ul>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/S2OZ5NTJWY%5B%5D&#64;QT9V52PD.png" /></p>
<p><img alt="image-20220623213202592" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220623213202592.png" /></p>
<p><strong>组框一般与radio button 连用</strong>  .  目的: 让几个成组的radio button不是同一个组的东西,</p>
<p><img alt="3208852" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318103208852.png" /></p>
</section>
<section id="cheak-bax">
<h3>3.Cheak Bax<a class="headerlink" href="#cheak-bax" title="永久链接至标题">¶</a></h3>
<p><img alt="image-20220623214910746" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220623214910746.png" /></p>
<p><img alt="image-20220623214959003" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220623214959003.png" /></p>
<p>​																<strong>勾选后会有三种状态</strong></p>
</section>
</section>
<section id="list-widget">
<h2>List Widget控件<a class="headerlink" href="#list-widget" title="永久链接至标题">¶</a></h2>
<section id="id16">
<h3>1.list Widget<a class="headerlink" href="#id16" title="永久链接至标题">¶</a></h3>
<p><img alt="image-20220623220520901" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220623220520901.png" /></p>
<section id="additem">
<h4>additem(字符串)<a class="headerlink" href="#additem" title="永久链接至标题">¶</a></h4>
<p>==<strong>使用在控件中添加一行内容 ：      additem（“一行内容”）</strong>==：    可以是文本可以是 图片 ,可以同时加</p>
<p><img alt="image-20220623220804509" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220623220804509.png" /></p>
<section id="id17">
<h5>同时加上图标<a class="headerlink" href="#id17" title="永久链接至标题">¶</a></h5>
<p><img alt="image-20220623220452530" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220623220452530.png" /></p>
<hr class="docutils" />
<p><strong>文本对齐方式</strong>:     ==setTextAlignment()==    Alignment   对齐</p>
<hr class="docutils" />
<p><img alt="image-20220623221136135" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220623221136135.png" /></p>
</section>
</section>
<section id="additems-list">
<h4>addItems(list列表)<a class="headerlink" href="#additems-list" title="永久链接至标题">¶</a></h4>
<p><img alt="image-20220623223011341" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220623223011341.png" /></p>
<p><img alt="image-20220623223029168" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220623223029168.png" /></p>
</section>
</section>
<hr class="docutils" />
<section id="tree-widget">
<h3>2. Tree Widget控件<a class="headerlink" href="#tree-widget" title="永久链接至标题">¶</a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>
ui -&gt; 组件名-&gt; setHeaderlabels(列表)   // 设置表头
    
// 设置内容   
QTreeWidget *一级文件 = new QTreeWidget(QStringList &lt;&lt; )  
ui -&gt;组名-&gt;addTopLevelItem(一级文件)
p-&gt;setIcon(索引, 图片路径);

QTreeWidget *二级文件 = new QTreeWidget(QStringList &lt;&lt; )  
 p-&gt;addChild(二级文件);   


反正就是找到对应的位置在使用对应的函数
</pre></div>
</div>
<p>基本</p>
<p><img alt="image-20220629202516154" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220629202516154.png" /></p>
<p><img alt="image-20220629202627715" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220629202627715.png" /></p>
<p>设计图标</p>
<p><img alt="image-20220629202713995" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220629202713995.png" /></p>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/%5B%7B%60%5BZS26%7DY52CAWEZRD1SOG.png" /></p>
<hr class="docutils" />
<p>再添加分支:</p>
<p><img alt="image-20220629203337070" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220629203337070.png" /></p>
<p><img alt="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220629203152639.png" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220629203152639.png" /></p>
</section>
<section id="table-widget">
<h3>3.Table Widget<a class="headerlink" href="#table-widget" title="永久链接至标题">¶</a></h3>
<p>表格</p>
<p><img alt="image-20220623224109784" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220623224109784.png" /></p>
<p><img alt="image-20220623224206049" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220623224206049.png" /></p>
<p><img alt="image-20220623224227521" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220623224227521.png" /></p>
<ul class="simple">
<li></li>
</ul>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>Table Widget设置：
setRowCount（10） 设置行数   “肉”
setColumnCount（6）设置列数  “抗蒙”

QStringList list；                              //
list &lt;&lt;  &quot;&quot; &lt;&lt; &quot;&quot; &lt;&lt; &quot;&quot; &lt;&lt; &quot;&quot; ;  一次性加多个    // 等价 QStringList() &lt;&lt; &lt;&lt;  

setHorizontalHeaderLables(list)     以水平的方式设置上述内容
----------------------
setItem（row, col, list）            以一行一行的设置内容
</pre></div>
</div>
<p>–&gt;==</p>
<hr class="docutils" />
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/23SIK3_UC%60_W8CUV%5B%5B9JT2.png" /></p>
<p><img alt="image-20220629204216635" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220629204216635.png" /></p>
<p><img alt="image-20220629204231719" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220629204231719.png" /></p>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/&#64;SSV1PZKAXD&#64;G7%7DFZ%7D%7BKEBR.png" /></p>
</section>
</section>
<hr class="docutils" />
<section id="containers">
<h2>Containers控件<a class="headerlink" href="#containers" title="永久链接至标题">¶</a></h2>
<p>++++</p>
<p><img alt="image-20220629204842941" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220629204842941.png" /></p>
<hr class="docutils" />
<p><img alt="image-20220629204905208" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220629204905208.png" /></p>
<hr class="docutils" />
<p><img alt="image-20220629205047913" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220629205047913.png" /></p>
<hr class="docutils" />
<p><strong>通过按钮才能切换控件</strong></p>
<p>stack wight 顾名思义一推控件</p>
<p><img alt="image-20220629205329485" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220629205329485.png" /></p>
<!---->==**使用setCurrentIndex（索引）**==   **跳转到相应页面**   “可瑞婷大克斯”<p>+++++++</p>
</section>
<hr class="docutils" />
<section id="input-widget">
<h2>Input Widget控件<a class="headerlink" href="#input-widget" title="永久链接至标题">¶</a></h2>
<p><img alt="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318110540280.png" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318110540280.png" /></p>
<p>**读出edit中的文字   : **</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">toPlainText</span><span class="p">()</span>  
</pre></div>
</div>
<p>**Combo Box : **</p>
<p><img alt="image-20220629211447646" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220629211447646.png" /></p>
<section id="id18">
<h3><strong>同时加上图标</strong><a class="headerlink" href="#id18" title="永久链接至标题">¶</a></h3>
<p><img alt="image-20220629211508312" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220629211508312.png" /></p>
<p><img alt="image-20220629211621655" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220629211621655.png" /></p>
<p>……………</p>
<p>++++</p>
</section>
</section>
<section id="id19">
<h2>自定义控件<a class="headerlink" href="#id19" title="永久链接至标题">¶</a></h2>
<p><img alt="image-20220318145309087" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318145309087.png" /></p>
<p><img alt="image-20220318145012878" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318145012878.png" /></p>
<p>++++</p>
<p><img alt="假如我们有如下的需求," src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164758606287253.png" /></p>
<p><img alt="请添加图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164758610205255.png" /></p>
<p><img alt="请添加图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164758611333557.png" /></p>
<p><img alt="image-20220318145446910" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318145446910.png" /></p>
<p>+++</p>
<p>QSpinBox ”死频波克斯 “和 horizontalSlider:   “死来爹儿”：</p>
<p><img alt="image-20220318151833890" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318151833890.png" /></p>
<hr class="docutils" />
<p><strong>是和上面有所不同的</strong></p>
<p>代码：</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>子窗口.h
    
#ifndef SMALLWIDGET_H
#define SMALLWIDGET_H

#include &lt;QWidget&gt;

namespace Ui {
class SmallWidget;
}

class SmallWidget : public QWidget
{
    Q_OBJECT

public:
    explicit SmallWidget(QWidget *parent = 0);
    ~SmallWidget();

    // 获取值
    int getValue();
    // 设置值
    void SetValue(int value);

private:
    Ui::SmallWidget *ui;
};

#endif // SMALLWIDGET_H
</pre></div>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>子窗口.cpp

#include &quot;smallwidget.h&quot;
#include &quot;ui_smallwidget.h&quot;

SmallWidget::SmallWidget(QWidget *parent) 
    QWidget(parent
    ui(new Ui::SmallWidget)
{
    ui-&gt;setupUi(this);

    // 指向正确的函数版本,z   5/11
    void (QSpinBox::*sigValueChange)(int) = &amp;QSpinBox::valueChanged;   // 指向正确的函数版本
    connect(ui-&gt;spinBox, sigValueChange, ui-&gt;horizontalSlider, &amp;QSlider::setValue);

    connect(ui-&gt;horizontalSlider, &amp;QSlider::valueChanged, ui-&gt;spinBox, &amp;QSpinBox::setValue);
}

SmallWidget::~SmallWidget()
{
    delete ui;
}

void SmallWidget::SetValue(int value)
{
    if(value &gt; 0 &amp;&amp; value &lt; 100)
    {
        ui-&gt;spinBox-&gt;setValue(value);
    }
}

int SmallWidget::getValue() //获取值
{
    return ui-&gt;spinBox-&gt;value();
}
</pre></div>
</div>
<p><img alt="image-20220318153243042" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318153243042.png" /></p>
<p><strong>上述代码用指针函数的原因：该信号就是重载的</strong></p>
</section>
<section id="lable">
<h2>lable标签控件(重要)<a class="headerlink" href="#lable" title="永久链接至标题">¶</a></h2>
<section id="id20">
<h3>加图片\动态图片<a class="headerlink" href="#id20" title="永久链接至标题">¶</a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;QMovie&gt;    //加动态图片</span><span class="cp"></span>
</pre></div>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">setupUi</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="c1">//显示文字</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">label</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;I love you Rick!&quot;</span><span class="p">);</span>  
    
    
    <span class="c1">//显示图片</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">label_2</span><span class="o">-&gt;</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s">&quot;:/Image/Image/1.jpeg&quot;</span><span class="p">));</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">label_2</span><span class="o">-&gt;</span><span class="n">setScaledContents</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>   <span class="c1">// 缩放</span>
    
    
    <span class="c1">//or    ui-&gt;label-&gt;setStyleSheet(&quot;image: url(:/res/rate.png);&quot;);   更好点</span>
    
    
    <span class="c1">//or</span>
    <span class="n">Qlable</span> <span class="n">lable</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Qlabel</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
    <span class="n">QPixmap</span> <span class="n">map</span>                   <span class="c1">//   可以使用Qpixmap(推荐) 或者 QPicture</span>
    <span class="n">map</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;D:</span><span class="se">\\</span><span class="s">mypic.pic&quot;</span><span class="p">);</span>     <span class="c1">// 核心   // pic.width() ---&gt; 得到图片的宽度  </span>
    <span class="n">lable</span><span class="p">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">map</span><span class="p">);</span>
    <span class="o">---</span>
    
    
    
    
    <span class="c1">//显示动图</span>
    <span class="n">QMovie</span> <span class="o">*</span><span class="n">mv</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QMovie</span><span class="p">(</span><span class="s">&quot;:/Image/Image/2.gif&quot;</span><span class="p">);</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">label_3</span><span class="o">-&gt;</span><span class="n">setMovie</span><span class="p">(</span><span class="n">mv</span><span class="p">);</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">label_3</span><span class="o">-&gt;</span><span class="n">setScaledContents</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>  <span class="c1">// 缩放</span>
    <span class="n">mv</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p><img alt="image-20220701214706248" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220701214706248.png" /></p>
<p><video src="../QQ录屏20220701214808.mp4"></video></p>
<hr class="docutils" />
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164758212004548.png" /></p>
<p><img alt="请添加图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/77ec39d7dda04f44a0ece15f8ee9b48d-164758226287551.gif" /></p>
</section>
<section id="label">
<h3>设置label的颜色：<a class="headerlink" href="#label" title="永久链接至标题">¶</a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">background</span><span class="o">-</span><span class="nl">color</span><span class="p">:</span> <span class="n">rgb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="image-20220320163514008" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220320163514008.png" /></p>
<p>+++</p>
</section>
</section>
</section>
<hr class="docutils" />
<section id="id21">
<h1>项目动态桌面壁纸开发<a class="headerlink" href="#id21" title="永久链接至标题">¶</a></h1>
<p>**lable标签控件显示动图 + 透明窗口  + 窗口阴影 + 按钮样式设置 **</p>
<p><img alt="image-20220804095127313" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220804095127313.png" /></p>
<p><img alt="image-20220804095228306" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220804095228306.png" /></p>
<p><img alt="image-20220804095303399" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220804095303399.png" /></p>
</section>
<section id="id22">
<h1>————————————————<a class="headerlink" href="#id22" title="永久链接至标题">¶</a></h1>
</section>
<section id="qmainwindow">
<h1>QMainWindow<a class="headerlink" href="#qmainwindow" title="永久链接至标题">¶</a></h1>
<section id="id23">
<h2>QMainWindow(代码版 )<a class="headerlink" href="#id23" title="永久链接至标题">¶</a></h2>
<section id="id24">
<h3><strong>QMainWindow_菜单栏和工具栏</strong><a class="headerlink" href="#id24" title="永久链接至标题">¶</a></h3>
<p>​    // MenuBar</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;mainwindow.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QMenuBar&gt;    // 创建菜单栏</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QToolBar&gt;    // 创建工具栏</span><span class="cp"></span>
<span class="n">MainWindow</span><span class="o">::</span><span class="n">MainWindow</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span>
    <span class="o">:</span> <span class="n">QMainWindow</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">resize</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span>  <span class="mi">400</span><span class="p">);</span>
        
    <span class="c1">// MenuBar</span>
    <span class="n">QMenuBar</span> <span class="o">*</span><span class="n">menubar</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QMenuBar</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">setMenuBar</span><span class="p">(</span><span class="n">menubar</span><span class="p">);</span>  <span class="c1">//设置进去主窗体</span>

    <span class="c1">//添加菜单选项</span>
    <span class="n">QMenu</span> <span class="o">*</span><span class="n">filename</span> <span class="o">=</span> <span class="n">menubar</span><span class="o">-&gt;</span><span class="n">addMenu</span><span class="p">(</span><span class="s">&quot;文件(&amp;f)&quot;</span><span class="p">);</span>  <span class="c1">// 设置快捷键的方式 : f</span>
    <span class="n">QMenu</span> <span class="o">*</span><span class="n">editmnue</span> <span class="o">=</span> <span class="n">menubar</span><span class="o">-&gt;</span><span class="n">addMenu</span><span class="p">(</span><span class="s">&quot;编辑(&amp;e)&quot;</span><span class="p">);</span>
    <span class="n">QMenu</span> <span class="o">*</span><span class="n">buildname</span> <span class="o">=</span> <span class="n">menubar</span><span class="o">-&gt;</span><span class="n">addMenu</span><span class="p">(</span><span class="s">&quot;构建(&amp;b)&quot;</span><span class="p">);</span>

    <span class="c1">// 添加选项的动作 如: 新建,打开,关闭</span>
    <span class="n">filename</span><span class="o">-&gt;</span><span class="n">addAction</span><span class="p">(</span><span class="s">&quot;新建文件&quot;</span><span class="p">);</span>
    <span class="n">filename</span><span class="o">-&gt;</span><span class="n">addAction</span><span class="p">(</span><span class="s">&quot;打开文件&quot;</span><span class="p">);</span>
    <span class="n">filename</span><span class="o">-&gt;</span><span class="n">addSeparator</span><span class="p">();</span>      <span class="c1">// 分隔线   [计] 分隔符</span>
    <span class="n">filename</span><span class="o">-&gt;</span><span class="n">addAction</span><span class="p">(</span><span class="s">&quot;关闭文件&quot;</span><span class="p">);</span>
        
        
    <span class="c1">// ToolBar</span>
    <span class="n">QToolBar</span> <span class="o">*</span><span class="n">toolbar</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QToolBar</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">addToolBar</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">TopToolBarArea</span><span class="p">,</span> <span class="n">toolbar</span><span class="p">);</span>

    <span class="n">toolbar</span><span class="o">-&gt;</span><span class="n">addAction</span><span class="p">(</span><span class="s">&quot;新建&quot;</span><span class="p">);</span>
    <span class="n">toolbar</span><span class="o">-&gt;</span><span class="n">addSeparator</span><span class="p">();</span>  <span class="c1">// 分隔线</span>
    <span class="n">toolbar</span><span class="o">-&gt;</span><span class="n">addAction</span><span class="p">(</span><span class="s">&quot;打开&quot;</span><span class="p">);</span>    

<span class="p">}</span>
</pre></div>
</div>
<p><img alt="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/QQ%E5%9B%BE%E7%89%8720220620211709.png" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/QQ%E5%9B%BE%E7%89%8720220620211709.png" /></p>
</section>
<section id="id25">
<h3>QMainWindow_状态栏和停靠窗口<a class="headerlink" href="#id25" title="永久链接至标题">¶</a></h3>
<p>// QStatusBar</p>
<p>// QDockWidget</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;QStatusBar&gt;  // 状态栏</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QLabel&gt;</span><span class="cp"></span>

<span class="p">.........</span>
   
<span class="c1">// QStatusBar</span>
<span class="n">QStatusBar</span> <span class="o">*</span><span class="n">stbar</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QStatusBar</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="n">setStatusBar</span><span class="p">(</span><span class="n">stbar</span><span class="p">);</span>
<span class="n">QLabel</span> <span class="o">*</span><span class="n">label</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QLabel</span><span class="p">(</span><span class="s">&quot;状态栏&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">);</span>
<span class="n">stbar</span><span class="o">-&gt;</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label</span><span class="p">);</span>
</pre></div>
</div>
<img src="QT笔记.assets/image-20220620213321781.png" alt="image-20220620213321781" style="zoom:80%;" /><hr class="docutils" />
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;QDockWidget&gt;    //停靠窗口</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QTextEdit&gt;     //用来做中心组件</span><span class="cp"></span>

<span class="p">...........</span>

<span class="c1">// QDockWidget</span>
<span class="n">QDockWidget</span> <span class="o">*</span><span class="n">dockwidget</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QDockWidget</span><span class="p">(</span><span class="s">&quot;小窗口&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>  <span class="c1">// Dock 船坞 /停靠 /船厂</span>
<span class="n">addDockWidget</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">LeftDockWidgetArea</span><span class="p">,</span> <span class="n">dockwidget</span><span class="p">);</span>   <span class="c1">// 放在中心部件的相对位置</span>

<span class="c1">//Central widget</span>
<span class="n">QTextEdit</span> <span class="o">*</span><span class="n">edit</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QTextEdit</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="n">setCentralWidget</span><span class="p">(</span><span class="n">edit</span><span class="p">);</span>  <span class="c1">// 设置成中心组件</span>
</pre></div>
</div>
<img src="QT笔记.assets/image-20220620214639259.png" alt="image-20220620214639259" style="zoom:67%;" /></section>
</section>
<section id="qmainwindow-ui">
<h2>QMainWindow(ui界面版)<a class="headerlink" href="#qmainwindow-ui" title="永久链接至标题">¶</a></h2>
<section id="id26">
<h3>1.<strong>菜单栏</strong>：<a class="headerlink" href="#id26" title="永久链接至标题">¶</a></h3>
<p>==single一般用==      <strong>&amp;QAction::triggered</strong></p>
<p><strong>快捷键:  (&amp; 快捷键的符号)</strong></p>
<p>注意:  objectname 一定是中文</p>
<p><strong>默认是不能输入中问的但是可以之后手动修改,找到text修改成中文即可</strong></p>
<img src="QT笔记.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164757324127214.png" alt="请添加图片描述"  /><p>​                                                                                                                                                          <strong>通过这个名字访问控件</strong></p>
</section>
<section id="id27">
<h3>2.<strong>工具栏：</strong><a class="headerlink" href="#id27" title="永久链接至标题">¶</a></h3>
<p>拖拽的是菜单栏中的东西</p>
<img src="QT笔记.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164757346059716.png" alt="请添加图片描述" style="zoom:200%;" /><p><strong>点击工具栏, 找到绿色区域 (其实绿色区域大部分都是这些)   :</strong></p>
<p><img alt="请添加图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164757370624118.png" /></p>
<p>+++</p>
</section>
<section id="id28">
<h3>3.状态栏：<a class="headerlink" href="#id28" title="永久链接至标题">¶</a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>状态栏只能通过代码控制进行插入,可以插入widget派生的任何东西.

状态栏的名字默认叫statusBar  通过ui-&gt;statusBar访问
addWidget( 控件 )          将控件添加到状态栏 
</pre></div>
</div>
<p><img alt="在这里插入图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164757453569420.png" /></p>
<p><strong>效果：</strong></p>
<p><img alt="：" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318113632372.png" /></p>
<p>++++</p>
</section>
<section id="id29">
<h3>4.  浮动窗口<a class="headerlink" href="#id29" title="永久链接至标题">¶</a></h3>
<p><img alt="image-20220620220527329" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220620220527329.png" /></p>
<p><img alt="image-20220620220850474" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220620220850474.png" /></p>
<p><img alt="image-20220620220900025" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220620220900025.png" /></p>
<hr class="docutils" />
<p><strong>浮动窗口：</strong></p>
<p><img alt="image-20220318112349358" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318112349358.png" /></p>
<p><img alt="image-20220318112423519" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318112423519.png" /></p>
<p>浮动窗口要使用show()方法   会以顶层方式重新弹出来一个窗口</p>
<hr class="docutils" />
</section>
<hr class="docutils" />
<section id="id30">
<h3>5. 中心组件<a class="headerlink" href="#id30" title="永久链接至标题">¶</a></h3>
<p><img alt="image-20220620221206461" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220620221206461.png" /></p>
</section>
</section>
</section>
<hr class="docutils" />
<section id="id31">
<h1>设置图标   和   设置按钮背景图片   (资源文件)<a class="headerlink" href="#id31" title="永久链接至标题">¶</a></h1>
<p><strong>使用代码的方式</strong></p>
<section id="id32">
<h2>具体操作<a class="headerlink" href="#id32" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li><p><strong>现自己 定义文件放好东西,再把这个文件夹加入资源文件</strong></p></li>
<li><p><img alt="image-20220620230512256" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220620230512256.png" /></p></li>
<li><p><strong>添加新文件    选择   资源文件：</strong></p></li>
<li><ul>
<li><p><img alt="image-20220317222311789" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220317222311789.png" /></p></li>
</ul>
</li>
<li><p>命名   <strong>resource</strong></p></li>
<li><p>前缀  :   /xxx</p></li>
</ul>
<hr class="docutils" />
<p><strong>详细步骤:</strong></p>
<p><img alt="image-20220718172911760" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220718172911760.png" /></p>
<p><img alt="image-20220718173007323" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220718173007323.png" /></p>
<p><img alt="image-20220718173018646" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220718173018646.png" /><img alt="image-20220718173043633" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220718173043633.png" /></p>
<p><img alt="image-20220718173104956" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220718173104956.png" /></p>
<hr class="docutils" />
<p><img alt="image-20220718173120380" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220718173120380.png" /></p>
<p>利用cmd打开终端，定位到res.qrc的目录下，输入命令</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rcc</span> <span class="o">-</span><span class="n">binary</span> <span class="o">.</span>\<span class="n">res</span><span class="o">.</span><span class="n">qrc</span> <span class="o">-</span><span class="n">o</span> <span class="n">plane</span><span class="o">.</span><span class="n">rcc</span>
</pre></div>
</div>
<p><img alt="image-20220718173213172" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220718173213172.png" /></p>
<p><img alt="image-20220718173251731" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220718173251731.png" /></p>
<hr class="docutils" />
<p>#define GAME_RES_PATH “./plane.rcc” //rcc文件路径</p>
<p><img alt="image-20220718173309985" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220718173309985.png" /></p>
<hr class="docutils" />
<p>核心</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;QResource&gt;</span><span class="cp"></span>
<span class="c1">//注册外部的二进制资源文件</span>
<span class="n">QResource</span><span class="o">::</span><span class="n">registerResource</span><span class="p">(</span><span class="n">GAME_RES_PATH</span><span class="p">);</span>
</pre></div>
</div>
<p><img alt="image-20220718173357146" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220718173357146.png" /></p>
<p><img alt="image-20220718173427931" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220718173427931.png" /></p>
<p><img alt="image-20220718173446575" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220718173446575.png" /></p>
<p><strong>res 存放是文件的名字 比如 也可以取img</strong></p>
</section>
<section id="id33">
<h2>使用格式:<a class="headerlink" href="#id33" title="永久链接至标题">¶</a></h2>
<section id="id34">
<h3>设置图标<a class="headerlink" href="#id34" title="永久链接至标题">¶</a></h3>
<div class="highlight-qt notranslate"><div class="highlight"><pre><span></span>#include &lt;QIcon&gt;
</pre></div>
</div>
<ul class="simple">
<li><p><strong>“:    +  前缀  + 文件名”</strong></p></li>
<li></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>设置窗口的图标（setWindowIcon(QIcon(&quot;E:\\1.jpg图片路径&quot;)); //给窗口加图标 ）
</pre></div>
</div>
<ul class="simple">
<li><p>设置控件的图标   setIcon()</p></li>
</ul>
<p><img alt="image-20220620230602157" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220620230602157.png" /></p>
<p><img alt="image-20220803175230403" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220803175230403.png" /></p>
</section>
<section id="id35">
<h3>按钮设置背景图片<a class="headerlink" href="#id35" title="永久链接至标题">¶</a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">ui某某</span><span class="p">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s">&quot;background-color: balck&quot;</span><span class="p">);</span>        <span class="c1">// 设置背景黑色</span>
<span class="n">ui某某</span><span class="p">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s">&quot;background-image:url(资源文件));    // 设置背景图片</span>
</pre></div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="id36">
<h1>设置任务栏托盘角标<a class="headerlink" href="#id36" title="永久链接至标题">¶</a></h1>
<p>n. 托盘，碟；文件盘</p>
<p><strong>当点击“叉叉”时，关闭窗口，但是不退出程序，用户通过点击任务栏角标再次打开窗口</strong></p>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/20210730220918741.png" /></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>#include &lt;QSystemTrayIcon&gt;
#include &lt;QMenu&gt;

QSystemTrayIcon tray;*//任务栏托盘角标*
    
 

void BingDesktop::addtray()
{
    tray.setToolTip(&quot;BingDesktop&quot;);
    tray.setIcon(QIcon(&quot;:/res/logo.png&quot;));
    QMenu* menu = new QMenu();
    action_showDialog = new QAction(&quot;显示主窗口&quot;);
    action_exit = new QAction(&quot;退出&quot;);
    menu-&gt;addAction(action_showDialog);//添加菜单
    menu-&gt;addAction(action_exit);//添加菜单
    tray.setContextMenu(menu);//绑定菜单
    
    //绑定托盘小图标点击事件
    connect(&amp;tray, SIGNAL(activated(QSystemTrayIcon::ActivationReason)), this, SLOT(OnSystemTrayClicked(QSystemTrayIcon::ActivationReason)));
    
    //绑定菜单点击事件
    connect(action_showDialog, &amp;QAction::triggered, this, &amp;onShowDialogClick);
    connect(action_exit, &amp;QAction::triggered, this, &amp;on_exitButton_clicked);
    tray.show(); //显示小图标
}
 //点击“打开主窗口”时显示窗口
 //点击了任务栏托盘小图标
void Widget::OnSystemTrayClicked(QSystemTrayIcon::ActivationReason reason) {
    if (reason == QSystemTrayIcon::Trigger) {
        this-&gt;showNormal();//如果点击了任务栏托盘小图标，则显示本窗口
    }
}
 
//“退出”时相当于点击主窗口里面的“退出”按钮，所以直接绑定到“退出”按钮的点击事件
 //退出按钮点击事件，同时任务栏小图标的”退出“菜单也会执行这个函数
void Widget::on_exitButton_clicked() {
    this-&gt;hide();//隐藏窗口
    WriteSetting();//写入设置
    qApp-&gt;exit(0);//退出
}
</pre></div>
</div>
</section>
<section id="id37">
<h1>八大对话框<a class="headerlink" href="#id37" title="永久链接至标题">¶</a></h1>
<section id="id38">
<h2>**标准对话框分类 **<a class="headerlink" href="#id38" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li><p>颜色对话框</p></li>
<li><p>文件对话框</p></li>
<li><p>字体对话框</p></li>
<li><p>输入对话框</p></li>
<li><p>消息对话框</p></li>
<li><p>进度对话框</p></li>
<li><p>错误信息对话框</p></li>
<li><p>向导对话框</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="id39">
<h2>模态和非模块对话框<a class="headerlink" href="#id39" title="永久链接至标题">¶</a></h2>
<p><strong>类型一:   模态对话框 ,特点弹出对话框不能操作其他窗口.</strong></p>
<p><strong>类型二:   非模态对话框 ,特点弹出对话框依然能操作其他窗口.</strong></p>
<div class="highlight-ASN.1 notranslate"><div class="highlight"><pre><span></span>类型一: 模态对话框 ,特点弹出对话框不能操作其他窗口.
</pre></div>
</div>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164757649566822.png" /></p>
<hr class="docutils" />
<div class="highlight-ASN.1 notranslate"><div class="highlight"><pre><span></span>类型二: 非模态对话框 ,特点弹出对话框依然能操作其他窗口.
</pre></div>
</div>
<p>解释一：</p>
<p><img alt="在这里插入图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318121046124.png" /></p>
<p>解释二：</p>
<p><img alt="在这里插入图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164757677125428.png" /></p>
<p><em>===要点：====</em>*</p>
<ul class="simple">
<li><p><strong>加一行 dialog-&gt;setModl(true);   // 阻塞 成为模态对话框</strong></p></li>
</ul>
<p><strong>头文件 :</strong>    #include<QDialog></p>
<p>第一种：<strong>模态对话框</strong></p>
<p>​        **QDialog dig(this);  **</p>
<p>​        <strong>dig.exec();</strong></p>
<p>或者   (推荐)</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">QDialog</span> <span class="n">dialog</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QDialog</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>  
<span class="n">dialog</span><span class="o">-&gt;</span><span class="n">setModl</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>              <span class="c1">// 阻塞</span>
<span class="n">dialog</span><span class="o">-&gt;</span><span class="n">show</span><span class="p">()</span>
<span class="n">dialog</span><span class="o">-&gt;</span><span class="n">setAttribute</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">WA_DeleteOnClose</span><span class="p">);</span>    <span class="c1">// ==Qt::WA_DeleteOnClose==主动关闭时候去析构</span>
</pre></div>
</div>
<p>​</p>
<p>第二种： <strong>非模块对话窗</strong></p>
<p>​      **QDialog *  dig = new QDialog(this)  **</p>
<p>​     **dig-&gt;setAttribute(Qt::WA_DeleteOnClose); **    ///==Qt::WA_DeleteOnClose==主动关闭时候去析构      setAttribute（） 设     置属性</p>
<p>​     **dig-&gt;show();  **</p>
<p>==效果：==</p>
<p><img alt="image-20220318123418308" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318123418308.png" /></p>
</section>
<hr class="docutils" />
<section id="id40">
<h2>文件对话窗<a class="headerlink" href="#id40" title="永久链接至标题">¶</a></h2>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>//方法：
#include&lt;QFileDialog&gt;  //文件对话窗
#include&lt;QMessageBox&gt;   //提示对话框

connect(ui-&gt;selectFile,&amp;QPushButton::clicked,this,[=]()
{
      // this 变成 null 就是独立的窗口
     QString filename = QFileDialog::getOpenFileName(this,&quot;窗口名（“标题”）&quot;,&quot;窗口路径  （&quot;C:\\&quot;）&quot;，&quot;过滤条件&quot;) ; //会弹出相应窗口，并且返回打开文件的一个路径；
   
  //没有选择文件进行警告：
 if (filename.isEmpty()==true)
 {
      QMessageBox::warning(this,&quot;warning&quot;,&quot;select file faild!&quot;);
      return;
  }
//ui-&gt;filePath-&gt;setText(filename); //把文件路径显示到到filePath文本窗口中
//创建文件对象,并打开文件（filename）：
//QFile file(filename);
    
}
</pre></div>
</div>
<p>==要点：==</p>
<p><strong>#include<QFileDialog>  //文件对话窗</strong></p>
<p><strong>QString filename = QFileDialog::getOpenFileName(this,”窗口名（“标题”）”, “窗口路径（”C:\”）, “过滤条件”)</strong></p>
<p>==效果：==</p>
<p><img alt="image-20220318123722575" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318123722575.png" /></p>
<p>加了过滤条件的</p>
<ul class="simple">
<li><p><strong>写字符串的内容都会显示</strong></p></li>
</ul>
<p><img alt="image-20220622213610380" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220622213610380.png" /></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="n">QString</span> <span class="n">PLAYER_FILTER</span> <span class="o">=</span> <span class="s">&quot;视频(*.mp4 *.avi *.wmv);;图片(*.jpg *.png *.bmp);;所有文件(*.*)&quot;</span><span class="p">;</span>
<span class="n">QString</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">::</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s">&quot;打看文件&quot;</span><span class="p">,</span> <span class="s">&quot;C:</span><span class="se">\\</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">PLAYER_FILTER</span><span class="p">);</span>
</pre></div>
</div>
<p><img alt="image-20220804112940040" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220804112940040.png" /></p>
<p>+++</p>
<p>+++</p>
</section>
<section id="id41">
<h2>消息对话框<a class="headerlink" href="#id41" title="永久链接至标题">¶</a></h2>
<section id="id42">
<h3>消息对话框<a class="headerlink" href="#id42" title="永久链接至标题">¶</a></h3>
<p>messaqe  n.消息</p>
<section id="id43">
<h4>不带图片:<a class="headerlink" href="#id43" title="永久链接至标题">¶</a></h4>
<p><img alt="image-20220622225509124" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220622225509124.png" /></p>
</section>
<section id="id44">
<h4>带图片<a class="headerlink" href="#id44" title="永久链接至标题">¶</a></h4>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164757893056236.png" /></p>
<p><strong>事实证明pixmap用来显示图片</strong></p>
</section>
</section>
<hr class="docutils" />
<section id="id45">
<h3>问题对话框<a class="headerlink" href="#id45" title="永久链接至标题">¶</a></h3>
<p>==question:问题==</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">//方法：</span>
<span class="cp">#include</span> <span class="cpf">&lt;QMessageBox&gt;</span><span class="cp"></span>
</pre></div>
</div>
<p>例子1.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">QMessageBox</span><span class="o">::</span><span class="n">question</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s">&quot;erro&quot;</span><span class="p">,</span><span class="s">&quot;系统文件错误&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">::</span><span class="n">Ok</span>   <span class="n">QMessageBox</span><span class="o">::</span><span class="n">Cancel</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">::</span><span class="n">Cancel</span><span class="p">);</span>   <span class="c1">//返回值是设置的按钮（QMessageBox::Cancel）</span>
</pre></div>
</div>
<p>+++</p>
<p>例子2.</p>
<p>代码</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">//问題对活框</span>
<span class="kt">int</span> <span class="n">ret1</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">::</span><span class="n">question</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s">&quot;问题对话框&quot;</span><span class="p">,</span> <span class="s">&quot;你是否使用Qt&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">::</span><span class="n">Yes</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">::</span><span class="n">No</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">ret1</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">::</span><span class="n">Yes</span><span class="p">)</span>
     <span class="n">qDebug</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Great&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p><img alt="image-20220622223941559" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220622223941559.png" /></p>
<p><img alt="image-20220622223315310" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220622223315310.png" /></p>
</section>
<hr class="docutils" />
<section id="id46">
<h3>警告对话框<a class="headerlink" href="#id46" title="永久链接至标题">¶</a></h3>
</section>
<section id="id47">
<h3>提示对话框<a class="headerlink" href="#id47" title="永久链接至标题">¶</a></h3>
<p><img alt="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/QQ%E5%9B%BE%E7%89%8720220622225221.png" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/QQ%E5%9B%BE%E7%89%8720220622225221.png" /></p>
</section>
<hr class="docutils" />
<section id="id48">
<h3>错误对话框<a class="headerlink" href="#id48" title="永久链接至标题">¶</a></h3>
<p>==critical:错误提示== ”亏提口“</p>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164757895003838.png" /></p>
</section>
<hr class="docutils" />
<section id="id49">
<h3>关于对话框<a class="headerlink" href="#id49" title="永久链接至标题">¶</a></h3>
<p>==about: 关于==</p>
<ul class="simple">
<li><p>不用设置按钮</p></li>
</ul>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">//方法：</span>
<span class="cp">#include</span> <span class="cpf">&lt;QMessageBox&gt;</span><span class="cp"></span>
</pre></div>
</div>
<p><img alt="image-20220622225536908" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220622225536908.png" /></p>
<hr class="docutils" />
<p><strong>没有静态方法,只能创建类对象的方式</strong></p>
</section>
</section>
<hr class="docutils" />
<section id="id50">
<h2>知识点九: 颜色对话框<a class="headerlink" href="#id50" title="永久链接至标题">¶</a></h2>
<p><strong>头文件</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;QColorDialog&gt; //颜色对话框   ”卡勒儿“</span><span class="cp"></span>
</pre></div>
</div>
<p>创建方法:</p>
<p>法一:     省略去创建类</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">QColor</span> <span class="n">color</span> <span class="o">=</span> <span class="n">QColorDialog</span><span class="o">::</span><span class="n">getColor</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">red</span><span class="p">,</span> <span class="k">this</span><span class="p">)</span> 
    
<span class="c1">//QColorDialog::grtColor 的原因是 getColor是静态方法, 使用方法是== 类名::静态函数 </span>
</pre></div>
</div>
<p>法二:  创建了类来使用(不推荐)</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">QColorDialog</span> <span class="n">color</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QColorDialog</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</pre></div>
</div>
<p><img alt="image-20220622214050413" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220622214050413.png" /></p>
</section>
<section id="id51">
<h2>字体对话框 和 输入对话框<a class="headerlink" href="#id51" title="永久链接至标题">¶</a></h2>
<section id="id52">
<h3>字体对话框<a class="headerlink" href="#id52" title="永久链接至标题">¶</a></h3>
<p>头文件</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;QFontDialog&gt;  //字体对话框   ”放特“</span><span class="cp"></span>
</pre></div>
</div>
<p><img alt="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220622213944796.png" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220622213944796.png" /></p>
<p><img alt="image-20220622215546218" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220622215546218.png" /></p>
<p>++++</p>
</section>
<section id="id53">
<h3>输入对话框<a class="headerlink" href="#id53" title="永久链接至标题">¶</a></h3>
<p>头文件 #include<QInputDialog></p>
<p><img alt="image-20220622222210753" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220622222210753.png" /></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>    <span class="kt">bool</span> <span class="n">ok</span><span class="p">;</span>
    <span class="n">QString</span> <span class="n">string</span>  <span class="o">=</span> <span class="n">QInputDialog</span><span class="o">::</span><span class="n">getText</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s">&quot;输入字符串对话框&quot;</span><span class="p">,</span> <span class="s">&quot;请输入用户名&quot;</span><span class="p">,</span> <span class="n">QLineEdit</span><span class="o">::</span><span class="n">Normal</span><span class="p">,</span> <span class="s">&quot;hello&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ok</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ok</span><span class="p">)</span>
        <span class="n">qDebug</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;string&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">string</span><span class="p">;</span>

    <span class="c1">// 输入整数对话框</span>
    <span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="n">QInputDialog</span><span class="o">::</span><span class="n">getInt</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s">&quot;输入整数对话框&quot;</span><span class="p">,</span> <span class="s">&quot;请输入0--100&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="o">&amp;</span><span class="n">ok</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ok</span><span class="p">)</span>
        <span class="n">qDebug</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;value&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">value</span><span class="p">;</span>
</pre></div>
</div>
<p>效果:</p>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/F03Q38KP574U&#64;S7%7BHNAI6H.png" /></p>
</section>
</section>
<hr class="docutils" />
<section id="id54">
<h2>进度对话框<a class="headerlink" href="#id54" title="永久链接至标题">¶</a></h2>
<p>==Progress: 进程==</p>
<ul class="simple">
<li><p><strong>没有静态方法,只能创建类对象的方式</strong></p>
<ul>
<li><p>用new的方式创建的话，如果不delete它就会一直存在.所以不用new的方式</p></li>
</ul>
</li>
</ul>
<p>代码:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span> <span class="n">QProgressDialog</span> <span class="nf">prodlg</span><span class="p">(</span><span class="s">&quot;复制内容&quot;</span><span class="p">,</span><span class="s">&quot;取消&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50000</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
    <span class="n">prodlg</span><span class="p">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s">&quot;复制文件&quot;</span><span class="p">);</span>
    <span class="n">prodlg</span><span class="p">.</span><span class="n">setWindowModality</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">WindowModal</span><span class="p">);</span>  <span class="c1">// 设置模态</span>
    <span class="n">prodlg</span><span class="p">.</span><span class="n">show</span><span class="p">();</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span> <span class="mi">50000</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">prodlg</span><span class="p">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>  <span class="c1">// 进度条</span>
        <span class="n">QCoreApplication</span><span class="o">::</span><span class="n">processEvents</span><span class="p">();</span>   <span class="c1">// 检查是否有其他任务 // 相当于多进程</span>
        <span class="k">if</span><span class="p">(</span><span class="n">prodlg</span><span class="p">.</span><span class="n">wasCanceled</span><span class="p">())</span>  <span class="c1">// 点击了取消</span>
            <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">prodlg</span><span class="p">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">50000</span><span class="p">);</span>
     <span class="n">qDebug</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;拷贝完成&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p><img alt="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/QQ%E5%9B%BE%E7%89%8720220622232945.png" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/QQ%E5%9B%BE%E7%89%8720220622232945.png" /></p>
</section>
<hr class="docutils" />
<section id="id55">
<h2>导向对话框<a class="headerlink" href="#id55" title="永久链接至标题">¶</a></h2>
<p><strong>QWizard</strong>        Wizard 向导</p>
<ul class="simple">
<li><p><strong>没有静态方法,只能创建类对象的方式</strong></p></li>
</ul>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">QWizard</span> <span class="nf">wizard</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
 <span class="n">wizard</span><span class="p">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s">&quot;向导对话框&quot;</span><span class="p">);</span>
 <span class="n">wizard</span><span class="p">.</span><span class="n">addPage</span><span class="p">(</span><span class="n">createPage1</span><span class="p">);</span>   <span class="c1">// 设置页面</span>
 <span class="n">wizard</span><span class="p">.</span><span class="n">addPage</span><span class="p">(</span><span class="n">createPage2</span><span class="p">);</span>
</pre></div>
</div>
<p><img alt="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/QQ%E5%9B%BE%E7%89%8720220623205024.png" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/QQ%E5%9B%BE%E7%89%8720220623205024.png" /></p>
<p><img alt="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/QQ%E5%9B%BE%E7%89%8720220623205108.png" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/QQ%E5%9B%BE%E7%89%8720220623205108.png" /></p>
<p><img alt="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/QQ%E5%9B%BE%E7%89%8720220623205045.png" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/QQ%E5%9B%BE%E7%89%8720220623205045.png" /></p>
</section>
<hr class="docutils" />
<section id="id56">
<h2>对话框的总结<a class="headerlink" href="#id56" title="永久链接至标题">¶</a></h2>
<p>字体对话框 ,   输入对话框   === 需要   bool ok</p>
<p>进度对话框,  导向对话框              ===没有静态方法, 使用类就好. 不用指针.</p>
<p>关于对话框            === 不用设置按钮</p>
</section>
<hr class="docutils" />
<section id="qstring">
<h2>知识点十二: QString（格式化输出）<a class="headerlink" href="#qstring" title="永久链接至标题">¶</a></h2>
<p><strong>qt字符串的拼接</strong>：</p>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164759041731159.png" /></p>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/7a8592337d9947ce96df73c72bf25a66.png" /></p>
<p><strong>常用方法:</strong></p>
<p><strong>QString::number(数字)      // 可以将数字转成字符串</strong></p>
<p>toLatin1();</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">QString</span><span class="o">::</span><span class="n">number</span><span class="p">((</span><span class="n">Receive_Byte</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">receiveText</span><span class="p">.</span><span class="n">toLatin1</span><span class="p">();</span>  <span class="c1">// toLatin1() 相当于输出ascll  和 转换成 QByteArray</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id57">
<h1>项目: 串口调试助手<a class="headerlink" href="#id57" title="永久链接至标题">¶</a></h1>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifndef WIDGET_H</span>
<span class="cp">#define WIDGET_H</span>

<span class="cp">#include</span> <span class="cpf">&lt;QWidget&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QtSerialPort/QtSerialPort&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QTimer&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">Ui</span> <span class="p">{</span>
<span class="k">class</span> <span class="nc">Widget</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Widget</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>

<span class="k">public</span><span class="o">:</span>
    <span class="k">explicit</span> <span class="n">Widget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
    <span class="o">~</span><span class="n">Widget</span><span class="p">();</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">Ui</span><span class="o">::</span><span class="n">Widget</span> <span class="o">*</span><span class="n">ui</span><span class="p">;</span>
    <span class="n">QTimer</span> <span class="o">*</span><span class="n">timer</span><span class="p">;</span>
    <span class="n">QStringList</span> <span class="n">portStringList</span><span class="p">;</span>
    <span class="n">QSerialPort</span> <span class="o">*</span><span class="n">serial</span><span class="p">;</span>
    <span class="n">QString</span> <span class="n">receiveText</span><span class="p">,</span> <span class="n">sendText</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">Receive_Byte</span><span class="p">,</span> <span class="n">Send_Byte</span><span class="p">;</span>
<span class="k">private</span> <span class="nl">slots</span><span class="p">:</span>
    <span class="kt">void</span> <span class="n">TimerEvent</span><span class="p">();</span>
    <span class="kt">void</span> <span class="nf">on_pushButton_clicked</span><span class="p">();</span>
    <span class="kt">void</span> <span class="nf">serialPort_readyRead</span><span class="p">();</span>
    <span class="kt">void</span> <span class="nf">on_ch6_clicked</span><span class="p">();</span>
    <span class="kt">void</span> <span class="nf">on_ch7_clicked</span><span class="p">();</span>
    <span class="kt">void</span> <span class="nf">on_ch8_clicked</span><span class="p">();</span>
    <span class="kt">void</span> <span class="nf">on_Button_2_pressed</span><span class="p">();</span>
    <span class="kt">void</span> <span class="nf">on_pushButton_2_clicked</span><span class="p">();</span>
    <span class="kt">void</span> <span class="nf">on_pushButton_3_clicked</span><span class="p">();</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="c1">// WIDGET_H</span>
</pre></div>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;ui_widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QMessageBox&gt;</span><span class="cp"></span>



<span class="n">Widget</span><span class="o">::</span><span class="n">Widget</span><span class="p">(</span><span class="n">QWidget</span><span class="o">*</span> <span class="n">parent</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">),</span>
    <span class="n">ui</span><span class="p">(</span><span class="k">new</span> <span class="n">Ui</span><span class="o">::</span><span class="n">Widget</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">setupUi</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="c1">//resize(650, 550);</span>
    <span class="n">setFixedSize</span><span class="p">(</span><span class="mi">650</span><span class="p">,</span> <span class="mi">550</span><span class="p">);</span>
    <span class="n">setWindowTitle</span><span class="p">(</span><span class="s">&quot;串口调试助手&quot;</span><span class="p">);</span>
    <span class="n">timer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QTimer</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">timer</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">timer</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">QTimer</span><span class="o">::</span><span class="n">timeout</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Widget</span><span class="o">::</span><span class="n">TimerEvent</span><span class="p">);</span>
    <span class="c1">// 创建串口类</span>
    <span class="n">serial</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QSerialPort</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="c1">// 设置默认值</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox_2</span><span class="o">-&gt;</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox_3</span><span class="o">-&gt;</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox_4</span><span class="o">-&gt;</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox_5</span><span class="o">-&gt;</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">serial</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">QSerialPort</span><span class="o">::</span><span class="n">readyRead</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Widget</span><span class="o">::</span><span class="n">serialPort_readyRead</span><span class="p">);</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">ch6</span><span class="o">-&gt;</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">Checked</span><span class="p">);</span>
    <span class="n">Receive_Byte</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">Send_Byte</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Widget</span><span class="o">::~</span><span class="n">Widget</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">delete</span> <span class="n">ui</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 该槽函数每隔500ms进入</span>
<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">TimerEvent</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">QStringList</span> <span class="n">newPort</span><span class="p">;</span>
    <span class="n">newPort</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">const</span> <span class="n">QSerialPortInfo</span><span class="o">&amp;</span> <span class="nl">info</span> <span class="p">:</span> <span class="n">QSerialPortInfo</span><span class="o">::</span><span class="n">availablePorts</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="c1">// 返回可用的窗口</span>
        <span class="n">newPort</span> <span class="o">+=</span> <span class="n">info</span><span class="p">.</span><span class="n">portName</span><span class="p">();</span>   <span class="c1">// 返回窗口名字</span>
    <span class="p">};</span>
    <span class="c1">// 有新增才增加</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">newPort</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">!=</span> <span class="n">portStringList</span><span class="p">.</span><span class="n">size</span><span class="p">())</span>  <span class="c1">// portStringList.size()当前的可用窗口</span>
    <span class="p">{</span>
        <span class="n">portStringList</span> <span class="o">=</span> <span class="n">newPort</span><span class="p">;</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox</span><span class="o">-&gt;</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox</span><span class="o">-&gt;</span><span class="n">addItems</span><span class="p">(</span><span class="n">portStringList</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 点击打开按钮</span>
<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">on_pushButton_clicked</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">pushButton</span><span class="o">-&gt;</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="n">QString</span><span class="p">(</span><span class="s">&quot;打开串口&quot;</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="c1">// 设置串口</span>
        <span class="n">serial</span><span class="o">-&gt;</span><span class="n">setPortName</span><span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox</span><span class="o">-&gt;</span><span class="n">currentText</span><span class="p">());</span>
        <span class="c1">// 设置波特率</span>
        <span class="n">serial</span><span class="o">-&gt;</span><span class="n">setBaudRate</span><span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox_2</span><span class="o">-&gt;</span><span class="n">currentText</span><span class="p">().</span><span class="n">toInt</span><span class="p">());</span>
        <span class="c1">// 设置数据位的长度</span>
        <span class="k">switch</span> <span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox_3</span><span class="o">-&gt;</span><span class="n">currentText</span><span class="p">().</span><span class="n">toInt</span><span class="p">())</span>   <span class="c1">// qt中switch() 参数必须是整数</span>
        <span class="p">{</span>
            <span class="k">case</span> <span class="mi">5</span><span class="o">:</span>
                <span class="n">serial</span><span class="o">-&gt;</span><span class="n">setDataBits</span><span class="p">(</span><span class="n">QSerialPort</span><span class="o">::</span><span class="n">Data5</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="mi">6</span><span class="o">:</span>
                <span class="n">serial</span><span class="o">-&gt;</span><span class="n">setDataBits</span><span class="p">(</span><span class="n">QSerialPort</span><span class="o">::</span><span class="n">Data6</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="mi">7</span><span class="o">:</span>
                <span class="n">serial</span><span class="o">-&gt;</span><span class="n">setDataBits</span><span class="p">(</span><span class="n">QSerialPort</span><span class="o">::</span><span class="n">Data7</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="mi">8</span><span class="o">:</span>
                <span class="n">serial</span><span class="o">-&gt;</span><span class="n">setDataBits</span><span class="p">(</span><span class="n">QSerialPort</span><span class="o">::</span><span class="n">Data8</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">default</span><span class="o">:</span>
                <span class="n">serial</span><span class="o">-&gt;</span><span class="n">setDataBits</span><span class="p">(</span><span class="n">QSerialPort</span><span class="o">::</span><span class="n">UnknownDataBits</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="c1">// 设置奇偶校验</span>
        <span class="k">switch</span> <span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox_4</span><span class="o">-&gt;</span><span class="n">currentIndex</span><span class="p">())</span>
        <span class="p">{</span>
            <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>
                <span class="n">serial</span><span class="o">-&gt;</span><span class="n">setParity</span><span class="p">(</span> <span class="n">QSerialPort</span><span class="o">::</span><span class="n">EvenParity</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
                <span class="n">serial</span><span class="o">-&gt;</span><span class="n">setParity</span><span class="p">(</span> <span class="n">QSerialPort</span><span class="o">::</span><span class="n">OddParity</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
                <span class="n">serial</span><span class="o">-&gt;</span><span class="n">setParity</span><span class="p">(</span><span class="n">QSerialPort</span><span class="o">::</span><span class="n">NoParity</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">default</span><span class="o">:</span>
                <span class="n">serial</span><span class="o">-&gt;</span><span class="n">setParity</span><span class="p">(</span> <span class="n">QSerialPort</span><span class="o">::</span><span class="n">UnknownParity</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="c1">// 设置停止位</span>
        <span class="k">switch</span> <span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox_5</span><span class="o">-&gt;</span><span class="n">currentIndex</span><span class="p">())</span>
        <span class="p">{</span>
            <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>
                <span class="n">serial</span><span class="o">-&gt;</span><span class="n">setStopBits</span><span class="p">(</span> <span class="n">QSerialPort</span><span class="o">::</span><span class="n">OneStop</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
                <span class="n">serial</span><span class="o">-&gt;</span><span class="n">setStopBits</span><span class="p">(</span><span class="n">QSerialPort</span><span class="o">::</span><span class="n">OneAndHalfStop</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
                <span class="n">serial</span><span class="o">-&gt;</span><span class="n">setStopBits</span><span class="p">(</span><span class="n">QSerialPort</span><span class="o">::</span><span class="n">TwoStop</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">default</span><span class="o">:</span>
                <span class="n">serial</span><span class="o">-&gt;</span><span class="n">setStopBits</span><span class="p">(</span><span class="n">QSerialPort</span><span class="o">::</span><span class="n">UnknownStopBits</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="c1">// 设置留空</span>
        <span class="n">serial</span><span class="o">-&gt;</span><span class="n">setFlowControl</span><span class="p">(</span><span class="n">QSerialPort</span><span class="o">::</span><span class="n">UnknownFlowControl</span><span class="p">);</span>
        <span class="c1">// 打开</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">serial</span><span class="o">-&gt;</span><span class="n">open</span><span class="p">(</span><span class="n">QIODevice</span><span class="o">::</span><span class="n">ReadWrite</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="n">QMessageBox</span><span class="o">::</span><span class="n">information</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s">&quot;错误提示&quot;</span><span class="p">,</span> <span class="s">&quot;无法打开串口&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">::</span><span class="n">Ok</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox</span><span class="o">-&gt;</span><span class="n">setEditable</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>  <span class="c1">// combox不能修改了;</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox_2</span><span class="o">-&gt;</span><span class="n">setEditable</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox_3</span><span class="o">-&gt;</span><span class="n">setEditable</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox_4</span><span class="o">-&gt;</span><span class="n">setEditable</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox_5</span><span class="o">-&gt;</span><span class="n">setEditable</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">pushButton</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;关闭串口&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">serial</span><span class="o">-&gt;</span><span class="n">close</span><span class="p">();</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox</span><span class="o">-&gt;</span><span class="n">setEditable</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>  <span class="c1">// combox能修改了;</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox_2</span><span class="o">-&gt;</span><span class="n">setEditable</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox_3</span><span class="o">-&gt;</span><span class="n">setEditable</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox_4</span><span class="o">-&gt;</span><span class="n">setEditable</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">comboBox_5</span><span class="o">-&gt;</span><span class="n">setEditable</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">pushButton</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;打开串口&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">serialPort_readyRead</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">QString</span> <span class="n">last_text</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">ch8</span><span class="o">-&gt;</span><span class="n">checkState</span><span class="p">()</span> <span class="o">!=</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Checked</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">last_text</span> <span class="o">=</span> <span class="n">ui</span><span class="o">-&gt;</span><span class="n">textEdit</span><span class="o">-&gt;</span><span class="n">toPlainText</span><span class="p">();</span>    <span class="c1">// toPlainText();读取历史数据</span>
        <span class="c1">// 收到的数据</span>
        <span class="n">receiveText</span> <span class="o">=</span> <span class="n">serial</span><span class="o">-&gt;</span><span class="n">readAll</span><span class="p">();</span>
        <span class="n">Receive_Byte</span> <span class="o">+=</span> <span class="n">receiveText</span><span class="p">.</span><span class="n">length</span><span class="p">();</span>   <span class="c1">// 长度</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">label_10</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="n">QString</span><span class="o">::</span><span class="n">number</span><span class="p">((</span><span class="n">Receive_Byte</span><span class="p">)));</span>   <span class="c1">// 数字转字符串</span>
        <span class="c1">// 显示收到的内容</span>
        <span class="k">if</span><span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">ch7</span><span class="o">-&gt;</span><span class="n">checkState</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Checked</span><span class="p">)</span>  <span class="c1">// hex</span>
        <span class="p">{</span>
            <span class="n">receiveText</span> <span class="o">=</span> <span class="n">receiveText</span><span class="p">.</span><span class="n">toLatin1</span><span class="p">().</span><span class="n">toHex</span><span class="p">();</span>    <span class="c1">// 十六进制</span>
            <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="n">receiveText</span><span class="p">.</span><span class="n">length</span><span class="p">();</span>
            <span class="c1">// 两个两个空个的显示</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">receiveText</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="sc">&#39; &#39;</span><span class="p">);</span> <span class="c1">// 在Qstring 对象中插入</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">ch6</span><span class="o">-&gt;</span><span class="n">checkState</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Checked</span><span class="p">)</span> <span class="c1">//ascll</span>
        <span class="p">{</span>
            <span class="n">receiveText</span> <span class="o">=</span> <span class="n">receiveText</span><span class="p">.</span><span class="n">toLatin1</span><span class="p">();</span>  <span class="c1">// toLatin1() 相当于输出ascll</span>
        <span class="p">}</span>
        <span class="n">last_text</span> <span class="o">=</span> <span class="n">last_text</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">receiveText</span><span class="p">);</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">textEdit</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="n">last_text</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">on_ch6_clicked</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">ch6</span><span class="o">-&gt;</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">Checked</span><span class="p">);</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">ch7</span><span class="o">-&gt;</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">Unchecked</span><span class="p">);</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">ch8</span><span class="o">-&gt;</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">Unchecked</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">on_ch7_clicked</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">ch6</span><span class="o">-&gt;</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">Unchecked</span><span class="p">);</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">ch7</span><span class="o">-&gt;</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">Checked</span><span class="p">);</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">ch8</span><span class="o">-&gt;</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">Unchecked</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">on_ch8_clicked</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">ch6</span><span class="o">-&gt;</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">Unchecked</span><span class="p">);</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">ch7</span><span class="o">-&gt;</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">Unchecked</span><span class="p">);</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">ch8</span><span class="o">-&gt;</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">Checked</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">on_Button_2_pressed</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">QByteArray</span>   <span class="n">bytearray</span><span class="p">;</span>
    <span class="n">sendText</span> <span class="o">=</span>  <span class="n">ui</span><span class="o">-&gt;</span><span class="n">textEdit_2</span><span class="o">-&gt;</span><span class="n">toPlainText</span><span class="p">();</span>   <span class="c1">// 捕获内容</span>
    <span class="n">bytearray</span> <span class="o">=</span>  <span class="n">sendText</span><span class="p">.</span><span class="n">toLatin1</span><span class="p">();</span>   <span class="c1">//toLatin1() 转换成 QByteArray</span>
    <span class="n">serial</span><span class="o">-&gt;</span><span class="n">write</span><span class="p">(</span><span class="n">bytearray</span><span class="p">);</span>
    <span class="n">Send_Byte</span> <span class="o">+=</span>  <span class="n">sendText</span><span class="p">.</span><span class="n">length</span><span class="p">();</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">label_11</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="n">QString</span><span class="o">::</span><span class="n">number</span><span class="p">(</span><span class="n">Send_Byte</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">on_pushButton_2_clicked</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">textEdit</span><span class="o">-&gt;</span><span class="n">clear</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">on_pushButton_3_clicked</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">textEdit_2</span><span class="o">-&gt;</span><span class="n">clear</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id58">
<h1>———————————————<a class="headerlink" href="#id58" title="永久链接至标题">¶</a></h1>
</section>
<section id="id59">
<h1>事件<a class="headerlink" href="#id59" title="永久链接至标题">¶</a></h1>
<section id="id60">
<h2>1.鼠标事件<a class="headerlink" href="#id60" title="永久链接至标题">¶</a></h2>
<p><img alt="请添加图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164759337304062.png" /></p>
<p><img alt="image-20220318165030251" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318165030251.png" /></p>
<p><img alt="image-20220318201159010" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318201159010.png" /></p>
<p>#include <QMouseEvent></p>
<p>子窗口==.h文件：==</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifndef MYLABEL_H</span>
<span class="cp">#define MYLABEL_H</span>

<span class="cp">#include</span> <span class="cpf">&lt;QLabel&gt;        //自己修改的</span><span class="cp"></span>

<span class="k">class</span> <span class="nc">MyLabel</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QLabel</span>   <span class="c1">//自己修改的</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>
<span class="k">public</span><span class="o">:</span>
    <span class="k">explicit</span> <span class="n">MyLabel</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>

<span class="nl">signals</span><span class="p">:</span>

<span class="k">public</span> <span class="nl">slots</span><span class="p">:</span>

<span class="k">protected</span><span class="o">:</span>
    <span class="c1">// 鼠标进入</span>
    <span class="kt">void</span> <span class="n">enterEvent</span><span class="p">(</span><span class="n">QEvent</span> <span class="o">*</span><span class="p">);</span>
    <span class="c1">// 鼠标离开</span>
    <span class="kt">void</span> <span class="nf">leaveEvent</span><span class="p">(</span><span class="n">QEvent</span> <span class="o">*</span><span class="p">);</span>
    <span class="c1">// 鼠标按下</span>
    <span class="kt">void</span> <span class="nf">mousePressEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">ev</span><span class="p">);</span>
    <span class="c1">// 鼠标释放</span>
    <span class="kt">void</span> <span class="nf">mouseReleaseEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">ev</span><span class="p">);</span>
<span class="c1">//    // 鼠标移动</span>
    <span class="kt">void</span> <span class="nf">mouseMoveEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">ev</span><span class="p">);</span>
    
<span class="p">};</span>

<span class="cp">#endif </span><span class="c1">// MYLABEL_H</span>
</pre></div>
</div>
<p>子窗口==.cpp文件：==</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;mylabel.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QMouseEvent&gt;</span><span class="cp"></span>

<span class="c1">// QWidget 默认是不追踪鼠标事件的</span>
<span class="n">MyLabel</span><span class="o">::</span><span class="n">MyLabel</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="o">:</span> <span class="n">QLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// 设置窗口追踪鼠标键</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">setMouseTracking</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 进入还是离开边界的一瞬间来完成的</span>
<span class="c1">// 鼠标进入</span>
<span class="kt">void</span> <span class="n">MyLabel</span><span class="o">::</span><span class="n">enterEvent</span><span class="p">(</span><span class="n">QEvent</span> <span class="o">*</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">setText</span><span class="p">(</span><span class="s">&quot;你不要在我身上乱摸!!!!&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 鼠标离开</span>
<span class="kt">void</span> <span class="n">MyLabel</span><span class="o">::</span><span class="n">leaveEvent</span><span class="p">(</span><span class="n">QEvent</span> <span class="o">*</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">setText</span><span class="p">(</span><span class="s">&quot;终于离开了...&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">MyLabel</span><span class="o">::</span><span class="n">mousePressEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">ev</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// 字符串拼接 QString().arg()</span>
    <span class="c1">// %1, %2, %3 -- 占位符</span>
    <span class="n">QString</span> <span class="n">btn</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ev</span><span class="o">-&gt;</span><span class="n">button</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">::</span><span class="n">LeftButton</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="s">&quot;LeftButton&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">ev</span><span class="o">-&gt;</span><span class="n">button</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">::</span><span class="n">RightButton</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="s">&quot;RightButton&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">ev</span><span class="o">-&gt;</span><span class="n">button</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">::</span><span class="n">MidButton</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="s">&quot;MidButton&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">QString</span> <span class="n">str</span> <span class="o">=</span> <span class="n">QString</span><span class="p">(</span><span class="s">&quot;MousePree[%3]:(%1, %2)&quot;</span><span class="p">).</span><span class="n">arg</span><span class="p">(</span><span class="n">ev</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">()).</span><span class="n">arg</span><span class="p">(</span><span class="n">ev</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">()).</span><span class="n">arg</span><span class="p">(</span><span class="n">btn</span><span class="p">);</span>

    <span class="n">setText</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">MyLabel</span><span class="o">::</span><span class="n">mouseReleaseEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">ev</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">QString</span> <span class="n">btn</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ev</span><span class="o">-&gt;</span><span class="n">button</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">::</span><span class="n">LeftButton</span><span class="p">)</span>              <span class="c1">// button()表示瞬间的状态</span>

    <span class="p">{</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="s">&quot;LeftButton&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">ev</span><span class="o">-&gt;</span><span class="n">button</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">::</span><span class="n">RightButton</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="s">&quot;RightButton&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">ev</span><span class="o">-&gt;</span><span class="n">button</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">::</span><span class="n">MidButton</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="s">&quot;MidButton&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">QString</span> <span class="n">str</span> <span class="o">=</span> <span class="n">QString</span><span class="p">(</span><span class="s">&quot;MouseRelease[%3]:(%1, %2)&quot;</span><span class="p">).</span><span class="n">arg</span><span class="p">(</span><span class="n">ev</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">()).</span><span class="n">arg</span><span class="p">(</span><span class="n">ev</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">()).</span><span class="n">arg</span><span class="p">(</span><span class="n">btn</span><span class="p">);</span>

    <span class="n">setText</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
<span class="p">}</span>

 
<span class="c1">//鼠标移动   // buttons() 按住</span>
<span class="kt">void</span> <span class="n">MyLabel</span><span class="o">::</span><span class="n">mouseMoveEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">ev</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">QString</span> <span class="n">btn</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ev</span><span class="o">-&gt;</span><span class="n">buttons</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">Qt</span><span class="o">::</span><span class="n">LeftButton</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="s">&quot;LeftButton&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">ev</span><span class="o">-&gt;</span><span class="n">buttons</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">Qt</span><span class="o">::</span><span class="n">RightButton</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="s">&quot;RightButton&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">ev</span><span class="o">-&gt;</span><span class="n">buttons</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">Qt</span><span class="o">::</span><span class="n">MidButton</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="s">&quot;MidButton&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">QString</span> <span class="n">str</span> <span class="o">=</span> <span class="n">QString</span><span class="p">(</span><span class="s">&quot;MouseMove[%3]:(%1, %2)&quot;</span><span class="p">).</span><span class="n">arg</span><span class="p">(</span><span class="n">ev</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">()).</span><span class="n">arg</span><span class="p">(</span><span class="n">ev</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">()).</span><span class="n">arg</span><span class="p">(</span><span class="n">btn</span><span class="p">);</span>

    <span class="n">setText</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>==要点：==</p>
<ul class="simple">
<li><p>1.鼠标函数用 protected方式定义</p></li>
<li><p>2.button（）==  表示瞬间的状态</p>
<ul>
<li><p>3.buttons（）&amp;  表示一种连续的方法</p></li>
<li><p>把创建的class c++ 文件（不是qt设计文件） 的.h文件 更改类为自己想定义的类  看上面代码</p></li>
</ul>
</li>
</ul>
<p><strong>#include <QMouseEvent></strong></p>
<p><strong>例子2:</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifndef WIDGET_H</span>
<span class="cp">#define WIDGET_H</span>

<span class="cp">#include</span> <span class="cpf">&lt;QWidget&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">Ui</span> <span class="p">{</span>
<span class="k">class</span> <span class="nc">Widget</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Widget</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>

<span class="k">public</span><span class="o">:</span>
    <span class="k">explicit</span> <span class="n">Widget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
    <span class="o">~</span><span class="n">Widget</span><span class="p">();</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">Ui</span><span class="o">::</span><span class="n">Widget</span> <span class="o">*</span><span class="n">ui</span><span class="p">;</span>
    <span class="n">QPoint</span> <span class="n">pos</span><span class="p">;</span>     <span class="c1">//当前窗体的位置</span>

<span class="k">protected</span><span class="o">:</span>
    <span class="c1">// 鼠标按下</span>
    <span class="kt">void</span> <span class="n">mousePressEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span>
    <span class="c1">//鼠标释放</span>
    <span class="kt">void</span> <span class="nf">mouseReleaseEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span>
    <span class="c1">//鼠标双击事件</span>
    <span class="kt">void</span> <span class="nf">mouseDoubleClickEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span>
    <span class="c1">//鼠标移动</span>
    <span class="kt">void</span> <span class="nf">mouseMoveEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span>
    <span class="c1">// 滚轮</span>
    <span class="kt">void</span> <span class="nf">wheelEvent</span><span class="p">(</span><span class="n">QWheelEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="c1">// WIDGET_H</span>
</pre></div>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;ui_widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QMouseEvent&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QDebug&gt;</span><span class="cp"></span>

<span class="n">Widget</span><span class="o">::</span><span class="n">Widget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">),</span>
    <span class="n">ui</span><span class="p">(</span><span class="k">new</span> <span class="n">Ui</span><span class="o">::</span><span class="n">Widget</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">setupUi</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">Widget</span><span class="o">::~</span><span class="n">Widget</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">delete</span> <span class="n">ui</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">mousePressEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">event</span><span class="o">-&gt;</span><span class="n">button</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">::</span><span class="n">LeftButton</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// 左键被按下</span>
        <span class="n">qDebug</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Left Button is pressed.&quot;</span><span class="p">;</span>
        <span class="c1">//qDebug() &lt;&lt; &quot;x = &quot; &lt;&lt; event-&gt;x() &lt;&lt; &quot;, y = &quot; &lt;&lt; event-&gt;y();   // 显示坐标</span>
        <span class="n">qDebug</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;x = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">event</span><span class="o">-&gt;</span><span class="n">globalX</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, y = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">event</span><span class="o">-&gt;</span><span class="n">globalY</span><span class="p">();</span>  <span class="c1">// 全局的相当于桌面的的坐标</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">event</span><span class="o">-&gt;</span><span class="n">button</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">::</span><span class="n">RightButton</span><span class="p">)</span>
    <span class="p">{</span>
          <span class="n">qDebug</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Right Button is pressed.&quot;</span><span class="p">;</span>
          <span class="n">qDebug</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;x = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">event</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, y = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">event</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">mouseReleaseEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
        <span class="n">qDebug</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Button is released&quot;</span><span class="p">;</span>
<span class="p">}</span>


<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">mouseDoubleClickEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// 目的是左键双击,设置成全屏</span>
    <span class="k">if</span><span class="p">(</span><span class="n">event</span><span class="o">-&gt;</span><span class="n">button</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">::</span><span class="n">LeftButton</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">windowState</span><span class="p">()</span> <span class="o">!=</span> <span class="n">Qt</span><span class="o">::</span><span class="n">WindowFullScreen</span><span class="p">)</span>
        <span class="p">{</span><span class="c1">// 不是全屏</span>
            <span class="n">setWindowState</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">WindowFullScreen</span><span class="p">);</span> <span class="c1">// 设置成满屏</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">setWindowState</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">WindowNoState</span><span class="p">);</span>   <span class="c1">// 再次双击就是回到初始化的状态</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 移动</span>
<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">mouseMoveEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">event</span><span class="o">-&gt;</span><span class="n">buttons</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">Qt</span><span class="o">::</span><span class="n">LeftButton</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">QPoint</span> <span class="n">temp</span><span class="p">;</span>  <span class="c1">//坐标点</span>

        <span class="n">temp</span> <span class="o">=</span> <span class="n">event</span><span class="o">-&gt;</span><span class="n">globalPos</span><span class="p">()</span> <span class="o">-</span> <span class="n">pos</span><span class="p">;</span>   <span class="c1">// 全局位置 - 当前窗体的位置</span>
        <span class="n">move</span><span class="p">(</span><span class="n">temp</span><span class="p">);</span>  <span class="c1">// 进行窗体移动</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="c1">//滚轮--&gt;放大字体之类的</span>
<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">wheelEvent</span><span class="p">(</span><span class="n">QWheelEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">event</span><span class="o">-&gt;</span><span class="n">delta</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">textEdit</span><span class="o">-&gt;</span><span class="n">zoomIn</span><span class="p">();</span>  <span class="c1">// 向上滚放大</span>
    <span class="k">else</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">textEdit</span><span class="o">-&gt;</span><span class="n">zoomOut</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="id61">
<h2>2.定时器<a class="headerlink" href="#id61" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li><p><strong>定时器—&gt;第一种写法</strong>:</p></li>
<li><p><img alt="在这里插入图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164759532236266.png" /></p></li>
</ul>
<p><img alt="在这里插入图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164759539284268.png" /></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>.h文件：
// 定时器
void timerEvent(QTimerEvent *);


.cpp文件：
#include &lt;QTimerEvent&gt;

MyLabel::MyLabel(QWidget *parent) : QLabel(parent)
{
    // 启动定时器
    // 参数 1: 触发定时器的时间, 单位: ms
    // 参数2: 使用默认值
    // 返回值: 定时器ID
    id = startTimer(2000);
}
    
    
// 每触发一次定时器, 进入该函数中
void MyLabel::timerEvent(QTimerEvent *e)
{
    QString str;
    if(e-&gt;timerId() == id)
    {
        static int num = -100;
        str = QString(&quot;%1: %2&quot;).arg(&quot;Time out: &quot;).arg(num++);
        if(num &gt;= 100)
            killTimer(id); // 关闭定时器        
    }
 }   
</pre></div>
</div>
<p>++++</p>
<ul class="simple">
<li><p><strong>定时器—&gt;第二种写法</strong>:</p></li>
</ul>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16.png" /></p>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/ea38d77decb642328ee77daa1c09fa08.png" /></p>
<section id="id62">
<h3>第二种定时器用法：（推荐)<a class="headerlink" href="#id62" title="永久链接至标题">¶</a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>第二种定时器用法：
    
#include &lt;QTimer&gt; //导入QTimer类
     
 QTimer * timer = new QTimer(this);
 timer-&gt;start(100);                                    //说明定时器每隔100ms触发一次
 connect(timer, &amp;QTimer::timeout, this, [=]()          //&amp;QTimer::timeout每到100ms就触发一次信号
 {
     static int number = 0;                            // 只初始化一次  // 静态的
     this-&gt;setText(QString::number(number++));    // QString::number转换
  });

// 每个一秒钟进行
</pre></div>
</div>
<p>++++</p>
</section>
</section>
<section id="id63">
<h2>3.事件分发<a class="headerlink" href="#id63" title="永久链接至标题">¶</a></h2>
</section>
</section>
<hr class="docutils" />
<section id="id64">
<h1>绘图<a class="headerlink" href="#id64" title="永久链接至标题">¶</a></h1>
<section id="qpainter">
<h2>绘图基本操作—&gt;QPainter<a class="headerlink" href="#qpainter" title="永久链接至标题">¶</a></h2>
<p><strong>绘图事件不需要主动调用</strong></p>
<p>”屏特儿”</p>
<p><img alt="请添加图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16.png" /></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifndef WIDGET_H</span>
<span class="cp">#define WIDGET_H</span>

<span class="cp">#include</span> <span class="cpf">&lt;QWidget&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">Ui</span> <span class="p">{</span>
<span class="k">class</span> <span class="nc">Widget</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Widget</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>

<span class="k">public</span><span class="o">:</span>
    <span class="k">explicit</span> <span class="n">Widget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
    <span class="o">~</span><span class="n">Widget</span><span class="p">();</span>

<span class="k">protected</span><span class="o">:</span>
    <span class="cm">/*</span>
<span class="cm">     *  1. 回调函数</span>
<span class="cm">     *  2. 此函数不需要用户与调用, 再刷新的时候会自定调用</span>
<span class="cm">     *      1. 窗口显示的时候</span>
<span class="cm">     *      2. 最大化, 最小化</span>
<span class="cm">     *      3. 窗口被这遮挡, 重新显示的时候</span>
<span class="cm">     *      4. 用户强制刷新的时候</span>
<span class="cm">     *      5. ...........</span>
<span class="cm">     *  3. 如果想使用画家类在窗口中画图, 操作必须在paintEvent函数中完成</span>
<span class="cm">    */</span>
    <span class="kt">void</span> <span class="n">paintEvent</span><span class="p">(</span><span class="n">QPaintEvent</span> <span class="o">*</span><span class="p">);</span>  <span class="c1">// 核心</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">Ui</span><span class="o">::</span><span class="n">Widget</span> <span class="o">*</span><span class="n">ui</span><span class="p">;</span>
 <span class="c1">// int x;</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="c1">// WIDGET_H</span>
</pre></div>
</div>
<p>*<em>重点：在当前窗口实现绘画的话     就是在protected下定义  “画家函数” void paintEvent(QPaintEvent <em>);</em></em></p>
<p>​                                                             <strong>并且只能在画家函数下使用画家类</strong></p>
<section id="id65">
<h3>核心<a class="headerlink" href="#id65" title="永久链接至标题">¶</a></h3>
<p>==形参写  QPaintEvent *==</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">paintEvent</span><span class="p">(</span><span class="n">QPaintEvent</span> <span class="o">*</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">QPainter</span> <span class="n">painter</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

    <span class="c1">// 设置画笔</span>
    <span class="n">QPen</span> <span class="nf">pen</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>  <span class="c1">// QColor()设置颜色agb</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">setWidth</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>  <span class="c1">// 设置宽度</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">setStyle</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">DashDotLine</span><span class="p">);</span>  <span class="c1">// 画的线类型</span>
    <span class="c1">// 画家拿到画笔</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">pen</span><span class="p">);</span>

<span class="c1">// 上述可以一步进行   p.setPen(QPen(t::green, 10));  //设置画家的画笔</span>
    
    
    <span class="c1">//两点确定一条直线</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawLine</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">QPoint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">));</span>
    <span class="c1">//圆心 a b ---&gt;椭圆</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawEllipse</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
    <span class="c1">//左上角的坐标 长 宽 ---&gt;矩形</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawRect</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
    <span class="c1">//坐标 字符串 --&gt;设置文字</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span><span class="s">&quot;文字&quot;</span><span class="p">);</span>  <span class="c1">// 默认的字体</span>
    <span class="n">QFont</span> <span class="nf">font</span><span class="p">(</span><span class="s">&quot;华文彩云&quot;</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>   <span class="c1">//QFont 设置字体：</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="s">&quot;我是中国人, 我爱我的祖国!!!&quot;</span><span class="p">);</span>

   <span class="c1">//设置画刷</span>
    <span class="n">QBrush</span> <span class="nf">brush</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">green</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Dense3Pattern</span><span class="p">);</span> <span class="c1">// 颜色 画刷类型</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">brush</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawRect</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">80</span><span class="p">);</span>

    <span class="c1">//坐标 起始度数(0-360) 锥形渐变</span>
    <span class="n">QConicalGradient</span> <span class="nf">conicalGradint</span><span class="p">(</span><span class="n">QPointF</span><span class="p">(</span><span class="mf">200.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>  <span class="c1">// QPointF 浮点型的坐标点</span>
    <span class="n">conicalGradint</span><span class="p">.</span><span class="n">setColorAt</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">cyan</span><span class="p">);</span>   <span class="c1">// 渐变颜色-&gt;用给定的颜色在给定的位置创建一个停止点。给定位置必须在0到1的范围内。  Qt::cyan青色</span>
    <span class="n">conicalGradint</span><span class="p">.</span><span class="n">setColorAt</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">black</span><span class="p">);</span>
    <span class="n">conicalGradint</span><span class="p">.</span><span class="n">setColorAt</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">red</span><span class="p">);</span>
    <span class="n">conicalGradint</span><span class="p">.</span><span class="n">setColorAt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">yellow</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">conicalGradint</span><span class="p">);</span>   <span class="c1">// 必须使用画刷</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawEllipse</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>

<span class="p">}</span>
</pre></div>
</div>
<p><img alt="image-20220712163605376" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220712163605376.png" /></p>
<p>+++</p>
</section>
<section id="id66">
<h3><strong>常见图形</strong><a class="headerlink" href="#id66" title="永久链接至标题">¶</a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">paintEvent</span><span class="p">(</span><span class="n">QPaintEvent</span> <span class="o">*</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">QPainter</span> <span class="n">painter</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

    <span class="c1">// 两点确定一条直线</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawLine</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">QPoint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">));</span>
    <span class="c1">//圆心 a b ---&gt;椭圆</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawEllipse</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
    <span class="c1">//左上角的坐标 长 宽 ---&gt;矩形</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawRect</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>

<span class="p">}</span>
</pre></div>
</div>
<p><img alt="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220712154046295.png" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220712154046295.png" /></p>
<p><img alt="image-20220712154057116" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220712154057116.png" /></p>
<hr class="docutils" />
<section id="id67">
<h4>个一个图片创建矩形<a class="headerlink" href="#id67" title="永久链接至标题">¶</a></h4>
<div class="highlight-qt notranslate"><div class="highlight"><pre><span></span>
QRect m_Rect;

bullet.load(/img/bullet_11.png);

m_Rect.setWidth(bullet.width());
m_Rect.setHeight(bullet.height());

m_Rect.moveTo(m_x, m_y);   //


矩型1.intersects(矩型2)  ---&gt; //判断是否相交
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id68">
<h3><strong>画笔</strong><a class="headerlink" href="#id68" title="永久链接至标题">¶</a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// 设置画笔</span>
<span class="n">QPen</span> <span class="nf">pen</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>  <span class="c1">// QColor()设置颜色agb</span>
<span class="n">pen</span><span class="p">.</span><span class="n">setWidth</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>  <span class="c1">// 设置宽度</span>
<span class="n">pen</span><span class="p">.</span><span class="n">setStyle</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">DashDotLine</span><span class="p">);</span>  <span class="c1">// 画的线类型</span>
<span class="c1">// 画家拿到画笔</span>
<span class="n">painter</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">pen</span><span class="p">);</span>
</pre></div>
</div>
<p>大致效果：</p>
<p><img alt="image-20220712163507250" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220712163507250.png" /></p>
<p>补充：</p>
<p><img alt="请添加图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-16476058928074.png" /></p>
<p><img alt="请添加图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-16476062372606.png" /></p>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-16476070062098.png" /></p>
<p><strong>重点：//#include <QFont></strong></p>
<p>+++</p>
</section>
<section id="id69">
<h3><strong>画刷</strong><a class="headerlink" href="#id69" title="永久链接至标题">¶</a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">//设置画刷</span>
<span class="n">QBrush</span> <span class="nf">brush</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">green</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Dense3Pattern</span><span class="p">);</span> <span class="c1">// 颜色 画刷类型</span>
<span class="n">painter</span><span class="p">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">brush</span><span class="p">);</span>
<span class="n">painter</span><span class="p">.</span><span class="n">drawRect</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">80</span><span class="p">);</span>
</pre></div>
</div>
<p><img alt="image-20220318203609853" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318203609853.png" /></p>
<p>==效果：==</p>
<p><img alt="image-20220318203721834" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318203721834.png" /></p>
<p>+++</p>
</section>
<section id="id70">
<h3><strong>字体</strong><a class="headerlink" href="#id70" title="永久链接至标题">¶</a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>//坐标 字符串 --&gt;设置文字
// 字体样式 字体大小 加粗 斜体
painter.drawText(200, 200,&quot;文字&quot;);  // 默认的字体

QFont font(&quot;华文彩云&quot;, 48, 75, true);   //QFont 设置字体：
font。setUnderline(turn)  // 设置下划线
painter.setFont(font);
painter.drawText(100, 400, &quot;我是中国人, 我爱我的祖国!!!&quot;);
</pre></div>
</div>
<p>大致效果：</p>
<img src="QT笔记.assets/image-20220712161210627.png" alt="image-20220712161210627" style="zoom:50%;" /><p>补充：</p>
</section>
<section id="id71">
<h3>写字<a class="headerlink" href="#id71" title="永久链接至标题">¶</a></h3>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/e9860a5cf6124408add2b62a3d92a84c.png" /></p>
<p><img alt="image-20220712154251023" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220712154251023.png" /></p>
</section>
<hr class="docutils" />
<section id="id72">
<h3>锥形渐变<a class="headerlink" href="#id72" title="永久链接至标题">¶</a></h3>
<section id="conical-gradient">
<h4>Conical  Gradient 函数<a class="headerlink" href="#conical-gradient" title="永久链接至标题">¶</a></h4>
<p>n. 锥形渐变  抗你q  格瑞顶t</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">//坐标 起始度数(0-360) 锥形渐变</span>
<span class="n">QConicalGradient</span> <span class="nf">conicalGradint</span><span class="p">(</span><span class="n">QPointF</span><span class="p">(</span><span class="mf">200.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>  <span class="c1">// QPointF 浮点型的坐标点</span>
<span class="n">conicalGradint</span><span class="p">.</span><span class="n">setColorAt</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">cyan</span><span class="p">);</span>   <span class="c1">// 渐变颜色-&gt;用给定的颜色在给定的位置创建一个停止点。给定位置必须在0到1的范围内。  Qt::cyan青色</span>
<span class="n">conicalGradint</span><span class="p">.</span><span class="n">setColorAt</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">black</span><span class="p">);</span>
<span class="n">conicalGradint</span><span class="p">.</span><span class="n">setColorAt</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">red</span><span class="p">);</span>
<span class="n">conicalGradint</span><span class="p">.</span><span class="n">setColorAt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">yellow</span><span class="p">);</span>

<span class="n">painter</span><span class="p">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">conicalGradint</span><span class="p">);</span>   <span class="c1">// 必须使用画刷</span>

<span class="n">painter</span><span class="p">.</span><span class="n">drawEllipse</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
</pre></div>
</div>
<p>大致效果：</p>
<p><img alt="image-20220712163415916" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220712163415916.png" /></p>
</section>
<hr class="docutils" />
<section id="id73">
<h4><strong>通过设置透明度</strong><a class="headerlink" href="#id73" title="永久链接至标题">¶</a></h4>
<p><strong>painter.setOpacity() 设置透明度</strong></p>
<div class="highlight-c++\ notranslate"><div class="highlight"><pre><span></span>// 绘制多条渐变直线
for(int num = 1; num &lt;= d_angle; num++)
{
    // painter.setOpacity() 设置透明度
    painter.setOpacity(1 - num * 1.0 / ((d_angle &gt; 30.0) ? 30 : d_angle));
    x = int(700 * qCos(qDegreesToRadians(d_angle - num)));    // 后面的最多30条线
    y = int(-700 * qSin(qDegreesToRadians(d_angle - num)));
    painter.drawLine(0, 0, x, y);
    if(num == 30)   // 绘制30条
    {
    break;
    }
    
}
</pre></div>
</div>
<p>效果:</p>
<p><img alt="image-20220801164450038" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220801164450038.png" /></p>
<hr class="docutils" />
<p>补充</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;ui_widget.h&quot;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&lt;QPainter&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QFont&gt;</span><span class="cp"></span>

<span class="n">Widget</span><span class="o">::</span><span class="n">Widget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">),</span>
    <span class="n">ui</span><span class="p">(</span><span class="k">new</span> <span class="n">Ui</span><span class="o">::</span><span class="n">Widget</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">setupUi</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

 <span class="cm">/* connect(ui-&gt;move, &amp;QPushButton::clicked, this, [=]()</span>
<span class="cm">    {</span>
<span class="cm">       // 手动刷新窗口</span>
<span class="cm">       update();   // 系统调用paintEvent 函数</span>
<span class="cm">    });</span>
<span class="cm"> */</span>
<span class="p">}</span>

<span class="n">Widget</span><span class="o">::~</span><span class="n">Widget</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">delete</span> <span class="n">ui</span><span class="p">;</span>
<span class="p">}</span>


<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">paintEvent</span><span class="p">(</span><span class="n">QPaintEvent</span> <span class="o">*</span><span class="p">)</span>    <span class="c1">//定义画家类</span>
<span class="p">{</span>
    <span class="c1">// 创建画家类对象</span>
    <span class="n">QPainter</span> <span class="n">p</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>   <span class="c1">// 指定绘图设备（重要）</span>

    <span class="c1">// 创建新画笔 -- 轮廓</span>
    <span class="n">QPen</span> <span class="n">pen</span><span class="p">;</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">setColor</span><span class="p">(</span><span class="cm">/*Qt::green*/</span><span class="n">QColor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">setWidth</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>   <span class="c1">// 像素</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">setStyle</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">DotLine</span><span class="p">);</span>
 
    <span class="c1">// 闭合区域使用画刷  brush 刷</span>
    <span class="n">QBrush</span> <span class="nf">brush</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s">&quot;:/Image/face.png&quot;</span><span class="p">));</span>
    <span class="n">p</span><span class="p">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">brush</span><span class="p">);</span>

    <span class="c1">// 将新画笔设置给画家类</span>
    <span class="n">p</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">pen</span><span class="p">);</span>
    
    <span class="c1">// 画背景图   drawPixmap</span>
    <span class="n">p</span><span class="p">.</span><span class="n">drawPixmap</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">QPixmap</span><span class="p">(</span><span class="s">&quot;:/Image/xks.png&quot;</span><span class="p">));</span>  <span class="c1">//（0，0）表示开画的初始位置</span>

    <span class="c1">// 画直线</span>
    <span class="n">p</span><span class="p">.</span><span class="n">drawLine</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">QPoint</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">500</span><span class="p">));</span>

    <span class="c1">// 画椭圆</span>
    <span class="n">p</span><span class="p">.</span><span class="n">drawEllipse</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>

    <span class="c1">// 画矩形</span>
    <span class="n">p</span><span class="p">.</span><span class="n">drawRect</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>

    <span class="c1">// 写字</span>
    <span class="c1">//QFont 设置字体：</span>
    <span class="n">QFont</span> <span class="nf">font</span><span class="p">(</span><span class="s">&quot;华文彩云&quot;</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
    <span class="n">p</span><span class="p">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">);</span>
    <span class="n">p</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="s">&quot;我是中国人, 我爱我的祖国!!!&quot;</span><span class="p">);</span>

    
  <span class="cm">/*  提供海贼船：</span>
<span class="cm">    int width = this-&gt;width();</span>
<span class="cm">    int heght = this-&gt;height();</span>
<span class="cm">    x += 5;</span>
<span class="cm">    if(x &gt; this-&gt;width()) //x如果大于窗口宽度就重新赋值</span>
<span class="cm">    {</span>
<span class="cm">        x = 20;</span>
<span class="cm">    }</span>
<span class="cm">    p.drawPixmap(x, 100, QPixmap(&quot;:/Image/sunny.png&quot;));</span>
<span class="cm">   */</span>
<span class="p">}</span>
</pre></div>
</div>
<p><img alt="image-20220318205352955" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318205352955.png" /></p>
</section>
</section>
<section id="id74">
<h3>绘制容器–作用可以重复使用<a class="headerlink" href="#id74" title="永久链接至标题">¶</a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">QPainter</span> <span class="nf">painter</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

<span class="c1">// 使用容器</span>
<span class="n">QPainterPath</span> <span class="n">path</span><span class="p">;</span>
<span class="n">path</span><span class="p">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">250</span><span class="p">);</span> <span class="c1">// 起始位置</span>
<span class="n">path</span><span class="p">.</span><span class="n">lineTo</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span> <span class="c1">// 画直线</span>
<span class="n">path</span><span class="p">.</span><span class="n">lineTo</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="n">path</span><span class="p">.</span><span class="n">addEllipse</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
<span class="n">painter</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QPen</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">red</span><span class="p">));</span>
<span class="n">painter</span><span class="p">.</span><span class="n">drawPath</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>  <span class="c1">// 绘制容器</span>

<span class="n">path</span><span class="p">.</span><span class="n">translate</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">painter</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QPen</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">blue</span><span class="p">));</span>
<span class="n">painter</span><span class="p">.</span><span class="n">drawPath</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>  <span class="c1">// 绘制容器</span>
</pre></div>
</div>
<p>效果：</p>
<p><img alt="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220712201315125.png" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220712201315125.png" /></p>
</section>
</section>
<hr class="docutils" />
<section id="id75">
<h2>抗锯齿和坐标系变换<a class="headerlink" href="#id75" title="永久链接至标题">¶</a></h2>
<p>作用 是提高画纸。<em>抗锯齿</em>，也叫<em>反锯齿</em>，它的作用是边缘柔化，可以消除混叠等</p>
<section id="id76">
<h3>1.抗锯齿<a class="headerlink" href="#id76" title="永久链接至标题">¶</a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">QPainter</span> <span class="nf">painter</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="c1">//1.反锯齿    Antialiasing /æntiˈeɪliəsɪŋ/ n.反锯齿  安题e零谁</span>
<span class="n">painter</span><span class="p">.</span><span class="n">setRenderHints</span><span class="p">(</span><span class="n">QPainter</span><span class="o">::</span><span class="n">Antialiasing</span> <span class="o">|</span> <span class="n">QPainter</span><span class="o">::</span><span class="n">TextAntialiasing</span><span class="p">);</span>  <span class="c1">// 启动抗锯齿,会增加计算机额外负担</span>
</pre></div>
</div>
</section>
<section id="id77">
<h3>2.坐标轴变换<a class="headerlink" href="#id77" title="永久链接至标题">¶</a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">//2. 坐标系的变换</span>
<span class="n">painter</span><span class="p">.</span><span class="n">drawLine</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">QPoint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">));</span>
<span class="n">painter</span><span class="p">.</span><span class="n">save</span><span class="p">();</span>  <span class="c1">// 保存当前坐标系</span>

<span class="n">painter</span><span class="p">.</span><span class="n">translate</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>  <span class="c1">// 平移 像素点</span>
<span class="n">painter</span><span class="p">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">90</span><span class="p">);</span>  <span class="c1">// 旋转 度数 顺时针  //rotate  v. （使）旋转，</span>
<span class="n">painter</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QPen</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">cyan</span><span class="p">,</span> <span class="mi">5</span><span class="p">));</span>
<span class="n">painter</span><span class="p">.</span><span class="n">drawLine</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">QPoint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">));</span>   <span class="c1">// 在新的坐标系中 画出</span>

<span class="n">painter</span><span class="p">.</span><span class="n">restore</span><span class="p">();</span>  <span class="c1">// 恢复坐标系</span>
</pre></div>
</div>
<p>效果：</p>
<p><img alt="image-20220712171939914" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220712171939914.png" /></p>
</section>
<section id="id78">
<h3>3.坐标轴缩放<a class="headerlink" href="#id78" title="永久链接至标题">¶</a></h3>
<p><strong>坐标和长宽都会变化</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">//3. 坐标系缩放</span>
<span class="n">painter</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QPen</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">red</span><span class="p">));</span>
<span class="n">painter</span><span class="p">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">yellow</span><span class="p">);</span>
<span class="n">painter</span><span class="p">.</span><span class="n">drawRect</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
<span class="n">painter</span><span class="p">.</span><span class="n">save</span><span class="p">();</span>
<span class="n">painter</span><span class="p">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>   <span class="c1">// 缩放  (nx,my)</span>
<span class="n">painter</span><span class="p">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">cyan</span><span class="p">);</span>
<span class="n">painter</span><span class="p">.</span><span class="n">drawRect</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
</pre></div>
</div>
<p><img alt="image-20220712172618842" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220712172618842.png" /></p>
</section>
<hr class="docutils" />
<section id="id79">
<h3>4.坐标轴扭曲<a class="headerlink" href="#id79" title="永久链接至标题">¶</a></h3>
<p><strong>x坐标轴扭曲表示: 左上角和右下角-&gt;撑</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">//4.坐标系扭曲</span>
<span class="n">painter</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QPen</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">blue</span><span class="p">));</span>
<span class="n">painter</span><span class="p">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">yellow</span><span class="p">);</span>
<span class="n">painter</span><span class="p">.</span><span class="n">drawRect</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
<span class="n">painter</span><span class="p">.</span><span class="n">save</span><span class="p">();</span>
<span class="n">painter</span><span class="p">.</span><span class="n">shear</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>   <span class="c1">// 扭曲  x坐标轴扭曲表示: 左上角和右下角</span>
<span class="n">painter</span><span class="p">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">cyan</span><span class="p">);</span>
<span class="n">painter</span><span class="p">.</span><span class="n">drawRect</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
</pre></div>
</div>
<p><img alt="image-20220712173604625" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220712173604625.png" /></p>
</section>
</section>
<hr class="docutils" />
<section id="id80">
<h2>刷新窗口—&gt;实现动的效果<a class="headerlink" href="#id80" title="永久链接至标题">¶</a></h2>
<p><strong>———手动调用绘图事件处理函数</strong></p>
<section id="id81">
<h3>案例1<a class="headerlink" href="#id81" title="永久链接至标题">¶</a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QPainter&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QTimer&gt;</span><span class="cp"></span>

<span class="n">Widget</span><span class="o">::</span><span class="n">Widget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span>
    <span class="o">:</span> <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="n">QTimer</span> <span class="o">*</span> <span class="n">timer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QTimer</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">timer</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">timer</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">QTimer</span><span class="o">::</span><span class="n">timeout</span><span class="p">,</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span>
        <span class="n">update</span><span class="p">();</span>  <span class="c1">// 刷新 窗口 --- &gt; 实现动的效果</span>
    <span class="p">});</span>
<span class="p">}</span>

<span class="n">Widget</span><span class="o">::~</span><span class="n">Widget</span><span class="p">()</span>
<span class="p">{</span>

<span class="p">}</span>

<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">paintEvent</span><span class="p">(</span><span class="n">QPaintEvent</span> <span class="o">*</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">angle</span> <span class="o">+=</span> <span class="mi">10</span><span class="p">;</span>   <span class="c1">// 数据会自动增加</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">angle</span> <span class="o">==</span> <span class="mi">360</span><span class="p">)</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">QPainter</span> <span class="nf">painter</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">setRenderHints</span><span class="p">(</span><span class="n">QPainter</span><span class="o">::</span><span class="n">Antialiasing</span> <span class="o">|</span> <span class="n">QPainter</span><span class="o">::</span><span class="n">TextAntialiasing</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">translate</span><span class="p">(</span><span class="n">width</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>   <span class="c1">// 坐标轴就在界面中心</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawEllipse</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">120</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">angle</span><span class="p">);</span> <span class="c1">// 旋转</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawLine</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">QPoint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>

<span class="p">}</span>
</pre></div>
</div>
<p><strong>效果：  指针会动</strong></p>
<p><img alt="image-20220712194253538" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220712194253538.png" /></p>
</section>
<hr class="docutils" />
<section id="id82">
<h3>案例2<a class="headerlink" href="#id82" title="永久链接至标题">¶</a></h3>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164760862218313.png" /></p>
<p><strong>效果：  点击移动按钮船会动</strong></p>
<p><img alt="image-20220712194457445" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220712194457445.png" /></p>
<hr class="docutils" />
<p><img alt="image-20220318224356633" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318224356633.png" /></p>
<p>==要的：==</p>
<p>​        <strong>手动刷新的是刷新 画家函数里的东西</strong></p>
<p>++++</p>
</section>
</section>
<section id="id83">
<h2>绘图设备（给画家的纸）<a class="headerlink" href="#id83" title="永久链接至标题">¶</a></h2>
<section id="id84">
<h3><strong>总述</strong><a class="headerlink" href="#id84" title="永久链接至标题">¶</a></h3>
<p><img alt="image-20220715085135073" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220715085135073.png" /></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>// QWidget    窗体

// QPixmap QImage QPicture QBitmap(黑白图片)

// QBitmap 父类 QPixmap

// QPixmap -- 图片类, 主要用来显示图片, 它针对于显示器显示做了特殊优化, 依赖于平台的, 只能在主线程中使用(UI线程)

// QIamge -- 图片(image)类 , 不依赖有平台（格式不会变）, (图片传输 , 可以在多线程中对其进行操作)

// 有绘图设备就不用非要画家函数了---因为和窗体无关  // 但是要把已有的电脑图片画出来就要用绘图事件
</pre></div>
</div>
<hr class="docutils" />
<p><img alt="img" src="https://img-blog.csdnimg.cn/ffffffe96f9740c38d8cbef73e51c14a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16" /></p>
<p><img alt="image-20220318214534172" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318214534172.png" /></p>
</section>
<hr class="docutils" />
<section id="widget">
<h3>1. 在widget中画图 —&gt; 画背景图<a class="headerlink" href="#widget" title="永久链接至标题">¶</a></h3>
<p>==<strong>在窗口中画出来</strong>==——<strong>必须需要画家事件函数</strong></p>
<p>步骤;</p>
<ol class="simple">
<li><p>加载图片</p></li>
<li><p>绘制出来 —&gt; 参数:   <strong>x, y,图片</strong></p></li>
</ol>
<hr class="docutils" />
<p>是可以分开写的</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">paintEvent</span><span class="p">(</span><span class="n">QPaintEvent</span> <span class="o">*</span><span class="p">)</span>     
<span class="p">{</span>
    <span class="n">QPainter</span> <span class="n">p</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="o">---</span>
    <span class="n">QPicture</span> <span class="n">pic</span>                   <span class="c1">//   可以使用Qpixmap(推荐) 或者 QPicture</span>
    <span class="n">pic</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;D:</span><span class="se">\\</span><span class="s">mypic.pic&quot;</span><span class="p">);</span>     <span class="c1">// 核心   // pic.width() ---&gt; 得到图片的宽度  				</span>
    <span class="o">---</span>
    <span class="n">p</span><span class="p">.</span><span class="n">drawPicture</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">pic</span><span class="p">);</span>    <span class="c1">// 画出来</span>
<span class="p">}</span>
</pre></div>
</div>
<p>==<strong>在窗口中画出来</strong>==（相当于画背景图）</p>
<p><img alt="在这里插入图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164761108902017.png" /></p>
</section>
<hr class="docutils" />
<section id="qpixmap">
<h3>2. 在QPixmap中画图:<a class="headerlink" href="#qpixmap" title="永久链接至标题">¶</a></h3>
<p><strong>主要用来显示图片</strong>,   它针对于显示器显示做了特殊优化, 依赖于平台的, 只能在主线程中使用(UI线程)</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// 在QPixmap中画图</span>
    <span class="n">QPixmap</span> <span class="nf">pix</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">);</span>  <span class="c1">// 纸的大小（默认是黑色）</span>

    <span class="n">pix</span><span class="p">.</span><span class="n">fill</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">red</span><span class="p">);</span> <span class="c1">// 设置一下纸的颜色</span>

    <span class="n">QPainter</span> <span class="nf">p</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pix</span><span class="p">);</span>    <span class="c1">//创建一个画家 // 画到指定的纸</span>

    <span class="n">p</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QPen</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">green</span><span class="p">,</span> <span class="mi">10</span><span class="p">));</span>  <span class="c1">//设置画家的画笔</span>
    <span class="n">p</span><span class="p">.</span><span class="n">drawRect</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">280</span><span class="p">);</span>    <span class="c1">//画个矩形</span>
    <span class="n">p</span><span class="p">.</span><span class="n">drawEllipse</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>  <span class="c1">//画个圆</span>

    <span class="n">pix</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">&quot;C:</span><span class="se">\\</span><span class="s">mypixmap.png&quot;</span><span class="p">);</span>   <span class="c1">//保存图片</span>
</pre></div>
</div>
<ul>
<li><blockquote>
<div><p>指定绘图设备    1. 构造函数中(参数是绘图设备)如：如： QPainter p(&amp;pix);</p>
<p>​                             2.或者： begin(参数是绘图设备)和 end();   对应使用</p>
</div></blockquote>
</li>
</ul>
</section>
<hr class="docutils" />
<section id="qimage">
<h3>3. 在QImage中画图：<a class="headerlink" href="#qimage" title="永久链接至标题">¶</a></h3>
<p>不依赖有平台（格式不会变）, <strong>(图片传输</strong> , 可以在多线程中对其进行操作)</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// 在QImage中画图</span>
    <span class="n">QImage</span> <span class="nf">img</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="n">QImage</span><span class="o">::</span><span class="n">Format_RGB32</span><span class="p">);</span>  <span class="c1">// 纸的大小, 指定格式  // 宽度 高度 格式</span>

    <span class="n">img</span><span class="p">.</span><span class="n">fill</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">white</span><span class="p">)</span>  <span class="c1">//设置一下纸的颜色</span>
        
    <span class="n">p</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="o">&amp;</span><span class="n">img</span><span class="p">);</span>  <span class="c1">// begin(参数是绘图设备) 和 end();   对应使用</span>

    <span class="n">p</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QPen</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">green</span><span class="p">,</span> <span class="mi">10</span><span class="p">));</span>  <span class="c1">//设置画家的画笔</span>
    <span class="n">p</span><span class="p">.</span><span class="n">drawRect</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">280</span><span class="p">);</span>    <span class="c1">//画个矩形</span>
    <span class="n">p</span><span class="p">.</span><span class="n">drawEllipse</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>  <span class="c1">//画个圆</span>

    <span class="n">p</span><span class="p">.</span><span class="n">end</span><span class="p">();</span>         <span class="c1">// 2. begin(参数是绘图设备)和 end();   对应使用</span>
    <span class="n">img</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">&quot;C:</span><span class="se">\\</span><span class="s">myImage.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>修改像素</strong></p>
<p><img alt="image-20220715092226636" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220715092226636.png" /></p>
<p><img alt="image-20220715092307219" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220715092307219.png" /></p>
<hr class="docutils" />
</section>
<hr class="docutils" />
<section id="qpicture">
<h3>4. 在QPicture中画图（只是一个绘图设备）:<a class="headerlink" href="#qpicture" title="永久链接至标题">¶</a></h3>
<ul>
<li><p>作用：</p>
<p><strong>// 1. 保存的是  绘图步骤 – 画家类</strong>
<strong>// 2. 不是图片, 二进制文件,看不了图片(save保存生成的文件)（这个可以用任意后缀）</strong>
<strong>// 3. 不依赖平台</strong></p>
</li>
</ul>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>在QPicture中画图:

     QPicture pic;  // 纸的大小（有默认值）（假纸）
     p.begin(&amp;pic);
     p.setPen(QPen(Qt::green, 10));
     p.drawRect(10, 10, 280, 280);
     p.drawEllipse(150, 150, 50, 50);
     p.end();
     pic.save(&quot;C:\\mypic.aaa&quot;);    // 可以使用任何的扩展名
     //作用不依赖与平台
</pre></div>
</div>
<blockquote>
<div><p>QPicture 绘画完虽然以.jpg保存,但并不是 一个图片,而是绘图步骤,所以我们可以通过重写画家类把这个绘图步骤绘画出来.</p>
<p>可以使用任何的扩展名 , 如果我们要画一个机密图 ,就可以采用这种方式,别人即使得到我们的文件,也不一定知道我们是用QT中的Qpicture绘画出来的.</p>
</div></blockquote>
<p>==<strong>在窗口中画出来:</strong>==</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">paintEvent</span><span class="p">(</span><span class="n">QPaintEvent</span> <span class="o">*</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">QPainter</span> <span class="n">p</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">QPicture</span> <span class="n">pic</span>                   <span class="c1">//   一般可以使用Qpixmap 或者 用QPicture画的就要用--&gt;QPicture</span>
    <span class="n">pic</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;C:</span><span class="se">\\</span><span class="s">mypic.aaa&quot;</span><span class="p">);</span>     <span class="c1">// 核心   // 表示通过qpicture的形式加载</span>
    <span class="n">p</span><span class="p">.</span><span class="n">drawPicture</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">pic</span><span class="p">);</span>    <span class="c1">// 画出来</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="qbitmap">
<h3>5.在QBitmap中画图(黑白图)<a class="headerlink" href="#qbitmap" title="永久链接至标题">¶</a></h3>
<p><img alt="image-20220715163455761" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220715163455761.png" /></p>
<p><strong>效果:   红色画笔画的但是显示黑白的</strong></p>
<p><img alt="image-20220715162855092" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220715162855092.png" /></p>
<hr class="docutils" />
<p>==<strong>在窗口中画出来</strong>==</p>
<p><strong>代码:</strong></p>
<p><img alt="image-20220715163208105" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220715163436790.png" /></p>
<p><strong>效果:</strong></p>
<img src="QT笔记.assets/image-20220715163222950.png" alt="image-20220715163222950" style="zoom:50%;" /></section>
<hr class="docutils" />
<section id="id85">
<h3>代码集合：<a class="headerlink" href="#id85" title="永久链接至标题">¶</a></h3>
<p>代码:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;ui_widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QPainter&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QPicture&gt;</span><span class="cp"></span>

<span class="n">Widget</span><span class="o">::</span><span class="n">Widget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">),</span>
    <span class="n">ui</span><span class="p">(</span><span class="k">new</span> <span class="n">Ui</span><span class="o">::</span><span class="n">Widget</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">setupUi</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

    <span class="c1">// 使用QPixmap画图</span>
    <span class="n">QPixmap</span> <span class="nf">pixmap</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">);</span>
    <span class="n">pixmap</span><span class="p">.</span><span class="n">fill</span><span class="p">();</span>
    <span class="n">QPainter</span> <span class="n">p</span><span class="p">;</span>
    <span class="n">p</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pixmap</span><span class="p">);</span>
    <span class="n">p</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QPen</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">red</span><span class="p">,</span> <span class="mi">5</span><span class="p">));</span>
    <span class="n">p</span><span class="p">.</span><span class="n">drawRect</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">280</span><span class="p">);</span>
    <span class="n">p</span><span class="p">.</span><span class="n">drawEllipse</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
    <span class="n">p</span><span class="p">.</span><span class="n">end</span><span class="p">();</span>
    <span class="n">pixmap</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">&quot;d:</span><span class="se">\\</span><span class="s">mypixmap.png&quot;</span><span class="p">);</span>

    <span class="c1">// 使用QImage 画图</span>
    <span class="n">QImage</span> <span class="nf">image</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="n">QImage</span><span class="o">::</span><span class="n">Format_RGB32</span><span class="p">);</span>
    <span class="n">image</span><span class="p">.</span><span class="n">fill</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">yellow</span><span class="p">);</span>
    <span class="n">p</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="o">&amp;</span><span class="n">image</span><span class="p">);</span>
    <span class="n">p</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QPen</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">blue</span><span class="p">,</span> <span class="mi">5</span><span class="p">));</span>
    <span class="n">p</span><span class="p">.</span><span class="n">drawRect</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">280</span><span class="p">);</span>
    <span class="n">p</span><span class="p">.</span><span class="n">drawEllipse</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
    <span class="n">p</span><span class="p">.</span><span class="n">end</span><span class="p">();</span>
    <span class="n">image</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">&quot;d:</span><span class="se">\\</span><span class="s">myimage.png&quot;</span><span class="p">);</span>

    <span class="c1">// 使用QPicture 画图</span>
    <span class="n">QPicture</span> <span class="n">pic</span><span class="p">;</span>
    <span class="n">p</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pic</span><span class="p">);</span>
    <span class="n">p</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QPen</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">blue</span><span class="p">,</span> <span class="mi">5</span><span class="p">));</span>
    <span class="n">p</span><span class="p">.</span><span class="n">drawRect</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">280</span><span class="p">);</span>
    <span class="n">p</span><span class="p">.</span><span class="n">drawEllipse</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
    <span class="n">p</span><span class="p">.</span><span class="n">end</span><span class="p">();</span>
    <span class="n">pic</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">&quot;d:</span><span class="se">\\</span><span class="s">mypic.pic&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">Widget</span><span class="o">::~</span><span class="n">Widget</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">delete</span> <span class="n">ui</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//在窗口中画出来</span>
<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">paintEvent</span><span class="p">(</span><span class="n">QPaintEvent</span> <span class="o">*</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">QPainter</span> <span class="n">p</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">QPicture</span> <span class="n">pic</span><span class="p">;</span>
    <span class="n">pic</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;D:</span><span class="se">\\</span><span class="s">mypic.pic&quot;</span><span class="p">);</span>
    <span class="n">p</span><span class="p">.</span><span class="n">drawPicture</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">pic</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>+++</p>
</section>
</section>
<section id="id86">
<h2>知识点十七: 不规则窗口—&gt;透明窗口<a class="headerlink" href="#id86" title="永久链接至标题">¶</a></h2>
<p>==<strong>核心：</strong>==</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>    <span class="c1">// 去掉边框      Flags标志</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">FramelessWindowHint</span><span class="p">);</span>   
    <span class="c1">// (框)设置背景透明：</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">setAttribute</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">WA_TranslucentBackground</span><span class="p">);</span>   <span class="c1">//120 Attribute “啊崔bui特” 属性   //对话                                                         框的属性设置一样</span>
</pre></div>
</div>
<p><strong>代码：</strong></p>
<p>.h文件：</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifndef WIDGET_H</span>
<span class="cp">#define WIDGET_H</span>

<span class="cp">#include</span> <span class="cpf">&lt;QWidget&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">Ui</span> <span class="p">{</span>
<span class="k">class</span> <span class="nc">Widget</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Widget</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>

<span class="k">public</span><span class="o">:</span>
    <span class="k">explicit</span> <span class="n">Widget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
    <span class="o">~</span><span class="n">Widget</span><span class="p">();</span>

<span class="k">protected</span><span class="o">:</span>
    <span class="kt">void</span> <span class="n">paintEvent</span><span class="p">(</span><span class="n">QPaintEvent</span> <span class="o">*</span><span class="p">);</span>  <span class="c1">//绘图事件</span>
    
<span class="c1">//下面代码不是蝴蝶动的代码：</span>
    <span class="kt">void</span> <span class="nf">mousePressEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="p">);</span> <span class="c1">//重写鼠标事件  按压</span>
    <span class="kt">void</span> <span class="nf">mouseMoveEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="p">);</span>  <span class="c1">//重写鼠标事件  移动</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">Ui</span><span class="o">::</span><span class="n">Widget</span> <span class="o">*</span><span class="n">ui</span><span class="p">;</span>
    
    <span class="n">QPoint</span> <span class="n">pt</span><span class="p">;</span>  <span class="c1">// 差值</span>
    <span class="kt">bool</span> <span class="n">fly</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">y</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="c1">// WIDGET_H</span>
</pre></div>
</div>
<p>.cpp文件：</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;ui_widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QPainter&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QMouseEvent&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;QTimer&gt;</span><span class="cp"></span>

<span class="n">Widget</span><span class="o">::</span><span class="n">Widget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">),</span>
    <span class="n">ui</span><span class="p">(</span><span class="k">new</span> <span class="n">Ui</span><span class="o">::</span><span class="n">Widget</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">setupUi</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="c1">// 加载图片 // 两张图</span>
    <span class="n">QPixmap</span> <span class="n">up</span><span class="p">;</span>
    <span class="n">QPixmap</span> <span class="n">down</span><span class="p">;</span>     
    <span class="n">up</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;:/image/up&quot;</span><span class="p">);</span>
    <span class="n">down</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;:/image/down&quot;</span><span class="p">);</span>
    
    <span class="c1">// 去掉边框：</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">FramelessWindowHint</span><span class="p">);</span>
    <span class="c1">// (框)设置背景透明：</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">setAttribute</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">WA_TranslucentBackground</span><span class="p">);</span>  <span class="c1">//120  //对话框的属性设置一样</span>

    <span class="n">fly</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="c1">// 定时器 设置时间间隔</span>
    <span class="c1">// QTimer</span>
    <span class="c1">// connect(timer, timeout, [=](){ 刷新窗口 });</span>
    <span class="c1">//定时器每个1s执行：</span>
    <span class="n">QTimer</span><span class="o">*</span> <span class="n">timer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QTimer</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">timer</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">timer</span><span class="p">,</span><span class="o">&amp;</span><span class="n">QTimer</span><span class="o">::</span><span class="n">timeout</span><span class="p">,</span><span class="k">this</span><span class="p">,[</span><span class="o">=</span><span class="p">](){</span>
        <span class="n">fly</span> <span class="o">=</span> <span class="o">!</span><span class="n">fly</span><span class="p">;</span>
        <span class="n">qsrand</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">qrand</span><span class="p">()</span><span class="o">%</span><span class="mi">20</span> <span class="o">+</span> <span class="n">x</span><span class="p">;</span>  <span class="c1">//20以内</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">qrand</span><span class="p">()</span><span class="o">%</span><span class="mi">20</span> <span class="o">+</span> <span class="n">y</span><span class="p">;</span>

        <span class="c1">//做一个边界判断</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">width</span><span class="p">())</span>
            <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">height</span><span class="p">())</span>
            <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">width</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">height</span><span class="p">();</span>

        <span class="n">update</span><span class="p">();</span>  <span class="c1">//更新窗口</span>
    <span class="p">});</span>

    <span class="c1">//主窗口最大化</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">showMaximized</span><span class="p">();</span>
    
    <span class="n">qsrand</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span> <span class="c1">//时间种子</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">qrand</span><span class="p">()</span><span class="o">%</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">width</span><span class="p">();</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">qrand</span><span class="p">()</span><span class="o">%</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">height</span><span class="p">();</span>

<span class="c1">//  QDesktopWidget* wg = QApplication::desktop(); //staric function//获取屏幕（显示器）的对象</span>

<span class="p">}</span>

<span class="n">Widget</span><span class="o">::~</span><span class="n">Widget</span><span class="p">(){</span><span class="k">delete</span> <span class="n">ui</span><span class="p">;}</span>

<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">paintEvent</span><span class="p">(</span><span class="n">QPaintEvent</span> <span class="o">*</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">//在指定绘图设备</span>
    <span class="n">QPainter</span> <span class="n">p</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="c1">// 在窗口中将图片画出来</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">p</span><span class="p">.</span><span class="n">drawPixmap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">up</span><span class="p">);</span>
    <span class="k">else</span>
        <span class="n">p</span><span class="p">.</span><span class="n">drawPixmap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">down</span><span class="p">);</span>

<span class="p">}</span>

<span class="c1">//下面代码不是蝴蝶动的代码：</span>
<span class="cm">/*</span>
<span class="cm">//右击鼠标关闭窗口,左键鼠标拖动:</span>

<span class="cm">//重写鼠标事件  按的操作</span>
<span class="cm">void Widget::mousePressEvent(QMouseEvent *e)</span>
<span class="cm">{</span>
<span class="cm">    if(e-&gt;button() == Qt::LeftButton)   //button是判断一瞬间的状态</span>
<span class="cm">    {</span>
<span class="cm">        // 求差值（ 鼠标左键按下的点 - 图像窗口坐上角的点坐标） 才是真鼠标移动的</span>
<span class="cm">        pt = e-&gt;globalPos() - this-&gt;frameGeometry().topLeft();  //this-&gt;frameGeometry().topLeft();</span>
<span class="cm">                                                                //返回的是窗口的位置信息</span>
<span class="cm">    }</span>
<span class="cm">    else if(e-&gt;button() == Qt::RightButton)  //按下鼠标右键就关闭</span>
<span class="cm">    {</span>
<span class="cm">        // close windows</span>
<span class="cm">        this-&gt;close();</span>
<span class="cm">    }</span>
<span class="cm">}</span>

<span class="cm">//重写鼠标事件  移动的操作</span>
<span class="cm">void Widget::mouseMoveEvent(QMouseEvent *e)</span>
<span class="cm">{</span>
<span class="cm">    // mvoe x , y 使用的是屏幕坐标系</span>
<span class="cm">    //而 e-&gt;x() , e-&gt;y() 是窗口的坐标系 Widget（看鼠标事件那章）</span>

<span class="cm">    this-&gt;move(e-&gt;globalPos() - pt);</span>
<span class="cm">}</span>
<span class="cm">*/</span>
</pre></div>
</div>
<p>==效果：可以随机移动；并且可以扇翅膀（因为有两张翅膀）。==</p>
<p><img alt="image-20220318225910748" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220318225910748.png" /></p>
<p>+++</p>
</section>
<section id="id87">
<h2><strong>绘制弧线</strong><a class="headerlink" href="#id87" title="永久链接至标题">¶</a></h2>
<p><img alt="image-20220801150033968" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220801150033968.png" /></p>
<p><img alt="image-20220801150538680" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220801150538680.png" /></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;ui_widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QPainter&gt;</span><span class="cp"></span>

<span class="n">Widget</span><span class="o">::</span><span class="n">Widget</span><span class="p">(</span><span class="n">QWidget</span><span class="o">*</span> <span class="n">parent</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">),</span>
    <span class="n">ui</span><span class="p">(</span><span class="k">new</span> <span class="n">Ui</span><span class="o">::</span><span class="n">Widget</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">setupUi</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">resize</span><span class="p">(</span><span class="mi">1600</span><span class="p">,</span> <span class="mi">900</span><span class="p">);</span>
    <span class="n">setStyleSheet</span><span class="p">(</span><span class="s">&quot;background-color: balck&quot;</span><span class="p">);</span>  <span class="c1">// 设置窗口背景颜色</span>
<span class="p">}</span>

<span class="n">Widget</span><span class="o">::~</span><span class="n">Widget</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">delete</span> <span class="n">ui</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">paintEvent</span><span class="p">(</span><span class="n">QPaintEvent</span><span class="o">*</span> <span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">QPainter</span> <span class="n">painter</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="c1">//QPen pen;</span>
    <span class="c1">//pen.setColor(Qt::green);</span>
    <span class="c1">//painter.setPen(pen);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QPen</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">green</span><span class="p">));</span>
    <span class="c1">// 起始x,y  宽度高度  起始角度</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawArc</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">1550</span><span class="p">,</span> <span class="mi">1550</span><span class="p">,</span> <span class="mi">0</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">180</span> <span class="o">*</span> <span class="mi">16</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawArc</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">1240</span><span class="p">,</span> <span class="mi">1240</span><span class="p">,</span> <span class="mi">0</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">180</span> <span class="o">*</span> <span class="mi">16</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawArc</span><span class="p">(</span><span class="mi">335</span><span class="p">,</span> <span class="mi">335</span><span class="p">,</span> <span class="mi">930</span><span class="p">,</span> <span class="mi">930</span><span class="p">,</span> <span class="mi">0</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">180</span> <span class="o">*</span> <span class="mi">16</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawArc</span><span class="p">(</span><span class="mi">490</span><span class="p">,</span> <span class="mi">490</span><span class="p">,</span> <span class="mi">620</span><span class="p">,</span> <span class="mi">620</span><span class="p">,</span> <span class="mi">0</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">180</span> <span class="o">*</span> <span class="mi">16</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawArc</span><span class="p">(</span><span class="mi">645</span><span class="p">,</span> <span class="mi">645</span><span class="p">,</span> <span class="mi">310</span><span class="p">,</span> <span class="mi">310</span><span class="p">,</span> <span class="mi">0</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">180</span> <span class="o">*</span> <span class="mi">16</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="id88">
<h1>项目超声波雷达项目界面设计<a class="headerlink" href="#id88" title="永久链接至标题">¶</a></h1>
<section id="id89">
<h2>基础界面设置<a class="headerlink" href="#id89" title="永久链接至标题">¶</a></h2>
<p><img alt="image-20220801160141503" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220801160141503.png" /></p>
<p><img alt="image-20220801152530415" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220801152530415.png" /></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;ui_widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QPainter&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QtMath&gt;</span><span class="cp"></span>

<span class="n">Widget</span><span class="o">::</span><span class="n">Widget</span><span class="p">(</span><span class="n">QWidget</span><span class="o">*</span> <span class="n">parent</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">),</span>
    <span class="n">ui</span><span class="p">(</span><span class="k">new</span> <span class="n">Ui</span><span class="o">::</span><span class="n">Widget</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">setupUi</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">resize</span><span class="p">(</span><span class="mi">1600</span><span class="p">,</span> <span class="mi">900</span><span class="p">);</span>
    <span class="n">setStyleSheet</span><span class="p">(</span><span class="s">&quot;background-color: balck&quot;</span><span class="p">);</span>    <span class="c1">// 设置背景黑色</span>
<span class="p">}</span>

<span class="n">Widget</span><span class="o">::~</span><span class="n">Widget</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">delete</span> <span class="n">ui</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">paintEvent</span><span class="p">(</span><span class="n">QPaintEvent</span><span class="o">*</span> <span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">QPainter</span> <span class="n">painter</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">QPen</span> <span class="n">pen</span><span class="p">;</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">setRenderHint</span><span class="p">(</span><span class="n">QPainter</span><span class="o">::</span><span class="n">Antialiasing</span><span class="p">);</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">green</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">pen</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawArc</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1400</span><span class="p">,</span> <span class="mi">1400</span><span class="p">,</span> <span class="mi">0</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">180</span> <span class="o">*</span> <span class="mi">16</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawArc</span><span class="p">(</span><span class="mi">240</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">1120</span><span class="p">,</span> <span class="mi">1120</span><span class="p">,</span> <span class="mi">0</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">180</span> <span class="o">*</span> <span class="mi">16</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawArc</span><span class="p">(</span><span class="mi">380</span><span class="p">,</span> <span class="mi">380</span><span class="p">,</span> <span class="mi">840</span><span class="p">,</span> <span class="mi">840</span><span class="p">,</span> <span class="mi">0</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">180</span> <span class="o">*</span> <span class="mi">16</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawArc</span><span class="p">(</span><span class="mi">520</span><span class="p">,</span> <span class="mi">520</span><span class="p">,</span> <span class="mi">560</span><span class="p">,</span> <span class="mi">560</span><span class="p">,</span> <span class="mi">0</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">180</span> <span class="o">*</span> <span class="mi">16</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawArc</span><span class="p">(</span><span class="mi">660</span><span class="p">,</span> <span class="mi">660</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">0</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">180</span> <span class="o">*</span> <span class="mi">16</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawLine</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1600</span><span class="p">,</span> <span class="mi">800</span><span class="p">);</span>  <span class="c1">// 画底部直线</span>
    <span class="c1">// 下面进行坐标系变换画出 几条直线</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">save</span><span class="p">();</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">translate</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">800</span><span class="p">);</span>   <span class="c1">// 设置新的坐标系原点</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">painter</span><span class="p">.</span><span class="n">rotate</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">);</span>  <span class="c1">// 坐标系旋转30度</span>
        <span class="n">painter</span><span class="p">.</span><span class="n">drawLine</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">720</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>       <span class="c1">// 画线, 长度720,漏了一点出来的</span>
    <span class="p">}</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">restore</span><span class="p">();</span>
    <span class="c1">//下面进行坐标系变换画出 0 30 60 .. 的文字</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">save</span><span class="p">();</span>
    <span class="n">QFont</span> <span class="nf">font</span><span class="p">(</span><span class="s">&quot;宋体&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">QFont</span><span class="o">::</span><span class="n">Bold</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">green</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">translate</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">800</span><span class="p">);</span>  <span class="c1">// 设置新的坐标系原点</span>
    <span class="c1">// qCos() 三角函数   #include &lt;QMath&gt;</span>
    <span class="c1">// qDegreesToRadians(0.0) 度数转换为弧度</span>
    <span class="c1">// 720是坐标x, -720 是坐标y . 注意坐标系的画法.</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qCos</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)),</span> <span class="o">-</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qSin</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;0°&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qCos</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">30.0</span><span class="p">)),</span> <span class="o">-</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qSin</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">30.0</span><span class="p">)),</span> <span class="s">&quot;30°&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qCos</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">60.0</span><span class="p">)),</span> <span class="o">-</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qSin</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">60.0</span><span class="p">)),</span> <span class="s">&quot;60°&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qCos</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">90.0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qSin</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">90.0</span><span class="p">)),</span> <span class="s">&quot;90°&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qCos</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">120.0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">55</span><span class="p">,</span> <span class="o">-</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qSin</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">120.0</span><span class="p">)),</span> <span class="s">&quot;120°&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qCos</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">150.0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">75</span><span class="p">,</span> <span class="o">-</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qSin</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">150.0</span><span class="p">)),</span> <span class="s">&quot;150°&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qCos</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">180.0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">80</span><span class="p">,</span> <span class="o">-</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qSin</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">180.0</span><span class="p">)),</span> <span class="s">&quot;180°&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">140</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="s">&quot;10cm&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">280</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="s">&quot;20cm&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">420</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="s">&quot;30cm&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">560</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="s">&quot;40cm&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">700</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="s">&quot;50cm&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">restore</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id90">
<h2>扫描<a class="headerlink" href="#id90" title="永久链接至标题">¶</a></h2>
<p><strong>动—&gt; 定时器或者更新窗口</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;ui_widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QPainter&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QtMath&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QTimer&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QDebug&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="n">Widget</span><span class="o">::</span><span class="n">Widget</span><span class="p">(</span><span class="n">QWidget</span><span class="o">*</span> <span class="n">parent</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">),</span>
    <span class="n">ui</span><span class="p">(</span><span class="k">new</span> <span class="n">Ui</span><span class="o">::</span><span class="n">Widget</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">setupUi</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">resize</span><span class="p">(</span><span class="mi">1600</span><span class="p">,</span> <span class="mi">900</span><span class="p">);</span>
    <span class="n">setStyleSheet</span><span class="p">(</span><span class="s">&quot;background-color: balck&quot;</span><span class="p">);</span>
    <span class="c1">// 定时器每个20ms进入</span>
    <span class="n">QTimer</span><span class="o">*</span> <span class="n">timer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QTimer</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">timer</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">timer</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">QTimer</span><span class="o">::</span><span class="n">timeout</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Widget</span><span class="o">::</span><span class="n">timerTimeOut</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">Widget</span><span class="o">::~</span><span class="n">Widget</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">delete</span> <span class="n">ui</span><span class="p">;</span>
<span class="p">}</span>


<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">paintEvent</span><span class="p">(</span><span class="n">QPaintEvent</span><span class="o">*</span> <span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">QPainter</span> <span class="n">painter</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">QPen</span> <span class="n">pen</span><span class="p">;</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">setRenderHint</span><span class="p">(</span><span class="n">QPainter</span><span class="o">::</span><span class="n">Antialiasing</span><span class="p">);</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">green</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">pen</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawArc</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1400</span><span class="p">,</span> <span class="mi">1400</span><span class="p">,</span> <span class="mi">0</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">180</span> <span class="o">*</span> <span class="mi">16</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawArc</span><span class="p">(</span><span class="mi">240</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">1120</span><span class="p">,</span> <span class="mi">1120</span><span class="p">,</span> <span class="mi">0</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">180</span> <span class="o">*</span> <span class="mi">16</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawArc</span><span class="p">(</span><span class="mi">380</span><span class="p">,</span> <span class="mi">380</span><span class="p">,</span> <span class="mi">840</span><span class="p">,</span> <span class="mi">840</span><span class="p">,</span> <span class="mi">0</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">180</span> <span class="o">*</span> <span class="mi">16</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawArc</span><span class="p">(</span><span class="mi">520</span><span class="p">,</span> <span class="mi">520</span><span class="p">,</span> <span class="mi">560</span><span class="p">,</span> <span class="mi">560</span><span class="p">,</span> <span class="mi">0</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">180</span> <span class="o">*</span> <span class="mi">16</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawArc</span><span class="p">(</span><span class="mi">660</span><span class="p">,</span> <span class="mi">660</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">0</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">180</span> <span class="o">*</span> <span class="mi">16</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawLine</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1600</span><span class="p">,</span> <span class="mi">800</span><span class="p">);</span>  <span class="c1">// 画底部直线</span>
    <span class="c1">// 下面进行坐标系变换画出 几条直线</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">save</span><span class="p">();</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">translate</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">800</span><span class="p">);</span>   <span class="c1">// 设置新的坐标系原点</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">painter</span><span class="p">.</span><span class="n">rotate</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">);</span>  <span class="c1">// 坐标系旋转30度</span>
        <span class="n">painter</span><span class="p">.</span><span class="n">drawLine</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">720</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>       <span class="c1">// 画线, 长度720,漏了一点出来的</span>
    <span class="p">}</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">restore</span><span class="p">();</span>
    <span class="c1">//下面进行坐标系变换画出 0 30 60 .. 的文字</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">save</span><span class="p">();</span>
    <span class="n">QFont</span> <span class="nf">font</span><span class="p">(</span><span class="s">&quot;宋体&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">QFont</span><span class="o">::</span><span class="n">Bold</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">green</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">translate</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">800</span><span class="p">);</span>  <span class="c1">// 设置新的坐标系原点</span>
    <span class="c1">// qCos() 三角函数   #include &lt;QMath&gt;</span>
    <span class="c1">// qDegreesToRadians(0.0) 度数转换为弧度</span>
    <span class="c1">// 720是坐标x, -720 是坐标y . 注意坐标系的画法.</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qCos</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)),</span> <span class="o">-</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qSin</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;0°&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qCos</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">30.0</span><span class="p">)),</span> <span class="o">-</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qSin</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">30.0</span><span class="p">)),</span> <span class="s">&quot;30°&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qCos</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">60.0</span><span class="p">)),</span> <span class="o">-</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qSin</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">60.0</span><span class="p">)),</span> <span class="s">&quot;60°&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qCos</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">90.0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qSin</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">90.0</span><span class="p">)),</span> <span class="s">&quot;90°&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qCos</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">120.0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">55</span><span class="p">,</span> <span class="o">-</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qSin</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">120.0</span><span class="p">)),</span> <span class="s">&quot;120°&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qCos</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">150.0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">75</span><span class="p">,</span> <span class="o">-</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qSin</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">150.0</span><span class="p">)),</span> <span class="s">&quot;150°&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qCos</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">180.0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">80</span><span class="p">,</span> <span class="o">-</span><span class="mi">720</span> <span class="o">*</span> <span class="n">qSin</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="mf">180.0</span><span class="p">)),</span> <span class="s">&quot;180°&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">140</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="s">&quot;10cm&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">280</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="s">&quot;20cm&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">420</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="s">&quot;30cm&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">560</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="s">&quot;40cm&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawText</span><span class="p">(</span><span class="mi">700</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="s">&quot;50cm&quot;</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">restore</span><span class="p">();</span>
    <span class="c1">// 画扫描线</span>
    <span class="c1">// pen.setWidth(12);</span>
    <span class="c1">// painter.setPen(pen);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QPen</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">green</span><span class="p">,</span> <span class="mi">11</span><span class="p">));</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">save</span><span class="p">();</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">translate</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">800</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="kt">int</span><span class="p">(</span><span class="mi">700</span> <span class="o">*</span> <span class="n">qCos</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="n">angle</span><span class="p">)));</span>    <span class="c1">// angle在不断更新--&gt;坐标也在更新</span>
    <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="kt">int</span><span class="p">(</span><span class="o">-</span><span class="mi">700</span> <span class="o">*</span> <span class="n">qSin</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="n">angle</span><span class="p">)));</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawLine</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
    <span class="kt">double</span> <span class="n">d_angle</span> <span class="o">=</span> <span class="n">angle</span><span class="p">;</span>
    <span class="c1">// 顺时针时渐变:</span>
    <span class="k">if</span><span class="p">(</span><span class="n">flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// 绘制多条渐变直线</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">num</span> <span class="o">&lt;=</span> <span class="n">d_angle</span><span class="p">;</span> <span class="n">num</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// painter.setOpacity() 设置透明度</span>
            <span class="n">painter</span><span class="p">.</span><span class="n">setOpacity</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">num</span> <span class="o">*</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">((</span><span class="n">d_angle</span> <span class="o">&gt;</span> <span class="mf">30.0</span><span class="p">)</span> <span class="o">?</span> <span class="mi">30</span> <span class="o">:</span> <span class="n">d_angle</span><span class="p">));</span>
            <span class="n">x</span> <span class="o">=</span> <span class="kt">int</span><span class="p">(</span><span class="mi">700</span> <span class="o">*</span> <span class="n">qCos</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="n">d_angle</span> <span class="o">-</span> <span class="n">num</span><span class="p">)));</span>    <span class="c1">// 后面的最多30条线</span>
            <span class="n">y</span> <span class="o">=</span> <span class="kt">int</span><span class="p">(</span><span class="o">-</span><span class="mi">700</span> <span class="o">*</span> <span class="n">qSin</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="n">d_angle</span> <span class="o">-</span> <span class="n">num</span><span class="p">)));</span>
            <span class="n">painter</span><span class="p">.</span><span class="n">drawLine</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">num</span> <span class="o">==</span> <span class="mi">30</span><span class="p">)</span>   <span class="c1">// 绘制30条</span>
            <span class="p">{</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">// 逆时针时渐变:</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">num</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="mi">180</span> <span class="o">-</span> <span class="n">d_angle</span><span class="p">);</span> <span class="n">num</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">painter</span><span class="p">.</span><span class="n">setOpacity</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">num</span> <span class="o">*</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">((</span><span class="mi">180</span> <span class="o">-</span> <span class="n">d_angle</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">30.0</span> <span class="o">?</span> <span class="mi">30</span> <span class="o">:</span> <span class="p">(</span><span class="mi">180</span> <span class="o">-</span> <span class="n">d_angle</span><span class="p">)));</span>
            <span class="n">x</span> <span class="o">=</span> <span class="kt">int</span><span class="p">(</span><span class="mi">700</span> <span class="o">*</span> <span class="n">qCos</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="n">d_angle</span> <span class="o">+</span> <span class="n">num</span><span class="p">)));</span>
            <span class="n">y</span> <span class="o">=</span> <span class="kt">int</span><span class="p">(</span><span class="o">-</span><span class="mi">700</span> <span class="o">*</span> <span class="n">qSin</span><span class="p">(</span><span class="n">qDegreesToRadians</span><span class="p">(</span><span class="n">d_angle</span> <span class="o">+</span> <span class="n">num</span><span class="p">)));</span>
            <span class="n">painter</span><span class="p">.</span><span class="n">drawLine</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">num</span> <span class="o">==</span> <span class="mi">30</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">restore</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Widget</span><span class="o">::</span><span class="n">timerTimeOut</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">//更新角度angle</span>
    <span class="k">if</span><span class="p">(</span><span class="n">flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">angle</span><span class="o">++</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">angle</span> <span class="o">==</span> <span class="mi">180</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">angle</span><span class="o">--</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">angle</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">update</span><span class="p">();</span>   <span class="c1">// 更新窗口 // 画家事件便会自动刷新</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="id91">
<h1>——————————————————<a class="headerlink" href="#id91" title="永久链接至标题">¶</a></h1>
</section>
<hr class="docutils" />
<section id="qt">
<h1>知识点十八: Qt中的随机数<a class="headerlink" href="#qt" title="永久链接至标题">¶</a></h1>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>生成随机数：
    
qsrand(time(NULL));
Int n1= qrand()%8;  //产生0-7d
</pre></div>
</div>
</section>
<section id="day04">
<h1>day04<a class="headerlink" href="#day04" title="永久链接至标题">¶</a></h1>
<section id="event-eventfilter">
<h2>知识点十九: 重写事件event/eventFilter–&gt;过滤事件<a class="headerlink" href="#event-eventfilter" title="永久链接至标题">¶</a></h2>
<p><img alt="请添加图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164761586556123.png" /></p>
<p>事件分发器的规则是 :
<code class="docutils literal notranslate"><span class="pre">如果返回值true--代表事件被处理过了,不再向下分发,停止了.</span></code>
<code class="docutils literal notranslate"><span class="pre">false</span> <span class="pre">--事件没有被处理,会继续分发.</span></code>
event过滤事件是在event中进行拦截处理</p>
<p><strong>定时器的第一种写法:重写timerEvent</strong></p>
<p>需要在对应的.h文件中申明 <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">timerEvent(QTimerEvent</span> <span class="pre">*envent);</span></code></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">//需要在对应的.h文件中声明bool event(QEvent  *event1);</span>

<span class="kt">bool</span> <span class="n">mylabel</span><span class="o">::</span><span class="n">event</span><span class="p">(</span><span class="n">QEvent</span>  <span class="o">*</span><span class="n">event1</span><span class="p">)</span>
<span class="p">{</span>
    <span class="cm">/*返回值</span>
<span class="cm">     * true --代表事件被处理过了,不再向下分发,停止了.</span>
<span class="cm">     * false --事件没有被处理,会继续分发.</span>
<span class="cm">    */</span>
        <span class="k">if</span><span class="p">(</span><span class="n">event1</span><span class="o">-&gt;</span><span class="n">type</span><span class="p">()</span> <span class="o">==</span> <span class="n">QEvent</span><span class="o">::</span><span class="n">Timer</span> <span class="p">)</span> <span class="c1">//过滤定时器事件 </span>
        <span class="p">{</span>
            <span class="k">return</span>  <span class="nb">true</span><span class="p">;</span>     <span class="c1">//返回一个true就不会执行该操作</span>

        <span class="p">}</span>

        <span class="k">return</span>  <span class="n">QLabel</span><span class="o">::</span><span class="n">event</span><span class="p">(</span> <span class="n">event1</span><span class="p">)</span> <span class="p">;</span>  <span class="c1">// 让父类执行默认的处理</span>

<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="eventfilter">
<h2>知识点二十: 事件过滤器eventFilter<a class="headerlink" href="#eventfilter" title="永久链接至标题">¶</a></h2>
<p><img alt="请添加图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16.png" /></p>
<p>.
步骤一: 给窗口安装事件过滤器,例如前面是给实例化的对象dsq
<code class="docutils literal notranslate"><span class="pre">dsp</span> <span class="pre">-&gt;</span> <span class="pre">insatllEventFilter(this)</span> <span class="pre">;</span></code>
.
步骤二: 需要在事件过滤器中处理</p>
<p><img alt="在这里插入图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-16476686438092.png" /></p>
<p>==   注意return的是主窗口的类 ==</p>
</section>
<section id="id92">
<h2>知识点二十一:<a class="headerlink" href="#id92" title="永久链接至标题">¶</a></h2>
<section id="id93">
<h3>QT文件读取<a class="headerlink" href="#id93" title="永久链接至标题">¶</a></h3>
<blockquote>
<div><p>需求:点击选择文件按钮,就打开本地选择文件 ,右边的line Edit里面显示文件的路径,下面Text Edit显示文本内容</p>
</div></blockquote>
<p>==效果：==</p>
<p><img alt="image-20220319135913121" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220319135913121.png" /></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;ui_widget.h&quot;</span><span class="cp"></span>

<span class="cp">#include</span><span class="cpf">&lt;QFile&gt;          //读取文件</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;QFileDialog&gt;    //文件对话框</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;QMessageBox&gt;    //提示对话框</span><span class="cp"></span>

<span class="n">Widget</span><span class="o">::</span><span class="n">Widget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">),</span>
    <span class="n">ui</span><span class="p">(</span><span class="k">new</span> <span class="n">Ui</span><span class="o">::</span><span class="n">Widget</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">setupUi</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">selectFile</span><span class="p">,</span><span class="o">&amp;</span><span class="n">QPushButton</span><span class="o">::</span><span class="n">clicked</span><span class="p">,</span><span class="k">this</span><span class="p">,[</span><span class="o">=</span><span class="p">]()</span>
    <span class="p">{</span>
       <span class="c1">//打开文件对话框:  </span>
       <span class="n">QString</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">::</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s">&quot;open file&quot;</span><span class="p">,</span><span class="s">&quot;C:</span><span class="se">\\</span><span class="s">&quot;</span><span class="p">)</span> <span class="p">;</span>  
       <span class="c1">//没有选择文件进行警告：</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">filename</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">()</span><span class="o">==</span><span class="nb">true</span><span class="p">)</span>
       <span class="p">{</span>
           <span class="n">QMessageBox</span><span class="o">::</span><span class="n">warning</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s">&quot;warning&quot;</span><span class="p">,</span><span class="s">&quot;select file faild!&quot;</span><span class="p">);</span>
           <span class="k">return</span><span class="p">;</span>
       <span class="p">}</span>
       
      
       <span class="n">ui</span><span class="o">-&gt;</span><span class="n">filePath</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="n">filename</span><span class="p">);</span> <span class="c1">//把文件显示到到filePath文本窗口中</span>

       <span class="c1">//创建文件对象,并打开文件（filename）开始读取对象：</span>
       <span class="n">QFile</span> <span class="nf">file</span><span class="p">(</span><span class="n">filename</span><span class="p">);</span>
        
     <span class="c1">//采用file对象读取 中文乱码转换：</span>
      <span class="cm">/* QT中读文件;默认读取的文件格式不是是utf-8,需要转换</span>
<span class="cm">//       #include &lt;QTextCodec&gt;</span>
<span class="cm">//       QTextCodec * textcode = QTextCodec::codecForName( &quot;gbk&quot;) ;</span>
<span class="cm">//       setText(textcode-&gt;toUnicode(array));</span>
<span class="cm">*/</span>

       <span class="c1">//指定打开方式：</span>
       <span class="kt">bool</span> <span class="n">a</span> <span class="o">=</span> <span class="n">file</span><span class="p">.</span><span class="n">open</span><span class="p">(</span><span class="n">QFile</span><span class="o">::</span><span class="n">ReadOnly</span><span class="p">);</span>  <span class="c1">// Readonly是只读 ， 返回值是bool</span>
       <span class="c1">//打开失败的情况：</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="nb">false</span><span class="p">){</span>
           <span class="n">QMessageBox</span><span class="o">::</span><span class="n">critical</span> <span class="p">(</span><span class="k">this</span>  <span class="p">,</span>   <span class="s">&quot;警告&quot;</span> <span class="p">,</span> <span class="s">&quot;文件打开失败&quot;</span><span class="p">);</span>
           <span class="k">return</span> <span class="p">;</span>
       <span class="p">}</span>

       <span class="c1">//读文件： //默认读取的文件格式是utf-8,也就是说如果你的txt文件是utf8格式的就正常显示 ,如果是gbk格式的就会乱码，用上述方法修改</span>
       <span class="n">QByteArray</span> <span class="n">array</span> <span class="o">=</span>  <span class="n">file</span><span class="p">.</span><span class="n">readAll</span><span class="p">()</span> <span class="p">;</span>  <span class="c1">//直接所有读取</span>

    <span class="c1">//一行一行读取：</span>
    <span class="cm">/*QByteArray array ;</span>
<span class="cm">     while (! file.atEnd())</span>
<span class="cm">     {    //如果不在最后一行,那么一直读:</span>
<span class="cm">          QByteArray array = array + file.readLine() ;</span>
<span class="cm">     }</span>
<span class="cm">    */</span>

       <span class="c1">//显示到textEdit文本框:</span>
       <span class="n">ui</span><span class="o">-&gt;</span><span class="n">textEdit</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="n">array</span><span class="p">);</span>

       <span class="c1">//关闭文件:</span>
       <span class="n">file</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
    <span class="p">});</span>
<span class="p">}</span>


<span class="n">Widget</span><span class="o">::~</span><span class="n">Widget</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">delete</span> <span class="n">ui</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>//设置文件打开方式：file.open(QFile::ReadOnly)</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>     <span class="o">*</span> <span class="n">QIODevice</span><span class="p">::</span><span class="n">ReadWrite</span> <span class="n">可读写</span>
     <span class="o">*</span> <span class="n">QIODevice</span><span class="p">::</span><span class="n">Text</span> <span class="n">换行符生效</span>
     <span class="o">*</span> <span class="n">QIODevice</span><span class="p">::</span><span class="n">Append</span> <span class="n">追加写入</span>
     <span class="o">*</span> <span class="n">QFile</span><span class="p">::</span><span class="n">Truncate</span> <span class="n">表示将原文件清空</span>
</pre></div>
</div>
</section>
<section id="id94">
<h3>QT文件写入<a class="headerlink" href="#id94" title="永久链接至标题">¶</a></h3>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-16476704694936.png" /></p>
</section>
</section>
<section id="id95">
<h2>知识点二十二: QT中的文本流和数据流<a class="headerlink" href="#id95" title="永久链接至标题">¶</a></h2>
<section id="qtextstream">
<h3>文本流QTextStream的读写方式<a class="headerlink" href="#qtextstream" title="永久链接至标题">¶</a></h3>
<blockquote>
<div><p>#include <QTextStream>   //操作基础数据类型:  int , float , string</p>
</div></blockquote>
<p><strong>文本流的读取方式</strong></p>
<p><img alt="请添加图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164767128522310.png" /></p>
<p><strong>文本流的写入方式</strong>：</p>
<p><img alt="在这里插入图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-16476709210298.png" /></p>
<p>+++</p>
</section>
<section id="qdatastream">
<h3><strong>数据流QDataStream的读写方式</strong><a class="headerlink" href="#qdatastream" title="永久链接至标题">¶</a></h3>
<blockquote>
<div><p>#include <QDataStream>   //可以操作二进制类型: QImage  Qpoint  QRect ,不依赖于平台</p>
</div></blockquote>
<p><img alt="请添加图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164767151414512.png" /></p>
<p>不建议使用：</p>
<p><img alt="请添加图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164767152652714.png" /></p>
<p><strong>对内存进行操作,读写内存</strong>QByteArray（读写)</p>
<blockquote>
<div><p>网络通信</p>
</div></blockquote>
<p><img alt="在这里插入图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164767155200116.png" /></p>
</section>
</section>
<section id="qfileinfo">
<h2>知识点二十三: QFileInfo文件属性<a class="headerlink" href="#qfileinfo" title="永久链接至标题">¶</a></h2>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;QFileInfo&gt;</span><span class="cp"></span>
</pre></div>
</div>
<p><img alt="在这里插入图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164767227747718.png" /></p>
<p><img alt="在这里插入图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/28277bbaeb104f35ad86497119865007-164767230675721.png" /></p>
<blockquote>
<div><p>要的：间接放个文件   或者直接放一个路径</p>
</div></blockquote>
<section id="qdatetime">
<h3>QDateTime 获取系统时间<a class="headerlink" href="#qdatetime" title="永久链接至标题">¶</a></h3>
<p>#include <QTimer>
#include <QDateTime></p>
<p><img alt="在这里插入图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164767294318923.png" /></p>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_18,color_FFFFFF,t_70,g_se,x_16.png" /></p>
</section>
</section>
<section id="qttcp">
<h2>知识点二十四: QT中的TCP通信<a class="headerlink" href="#qttcp" title="永久链接至标题">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include&lt;QTcpServer&gt;  // 监听套接字</span>
<span class="c1">#include&lt;QtcpSocket&gt;  // 通讯的套接字 “说剋特”</span>
</pre></div>
</div>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164767323707627.png" /></p>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164767355410129.png" /></p>
<section id="id96">
<h3>服务器端：<a class="headerlink" href="#id96" title="永久链接至标题">¶</a></h3>
<p><strong>.pro文件；</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">QT</span>       <span class="o">+=</span> <span class="n">core</span> <span class="n">gui</span> <span class="n">network</span>
</pre></div>
</div>
<p><strong>.h文件：</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifndef SERVER_H</span>
<span class="cp">#define SERVER_H</span>

<span class="cp">#include</span> <span class="cpf">&lt;QWidget&gt;</span><span class="cp"></span>

<span class="cp">#include</span><span class="cpf">&lt;QtcpSocket&gt;       // 通讯的套接字    “说剋特”</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;QtcpSocket&gt;       // 监听套接字</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">Ui</span> <span class="p">{</span>
<span class="k">class</span> <span class="nc">Server</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Server</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>

<span class="k">public</span><span class="o">:</span>
    <span class="k">explicit</span> <span class="n">Server</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
    <span class="o">~</span><span class="n">Server</span><span class="p">();</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">Ui</span><span class="o">::</span><span class="n">Server</span> <span class="o">*</span><span class="n">ui</span><span class="p">;</span>
    <span class="n">QTcpServer</span><span class="o">*</span> <span class="n">server</span><span class="p">;</span>  <span class="c1">//监听套接字</span>
    <span class="n">QTcpSocket</span><span class="o">*</span> <span class="n">conn</span><span class="p">;</span> <span class="c1">// 通讯的套接字</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="c1">// SERVER_H</span>
</pre></div>
</div>
<p><strong>.cpp文件：</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;server.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;ui_server.h&quot;</span><span class="cp"></span>

<span class="n">Server</span><span class="o">::</span><span class="n">Server</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">),</span>
    <span class="n">ui</span><span class="p">(</span><span class="k">new</span> <span class="n">Ui</span><span class="o">::</span><span class="n">Server</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">setupUi</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        
    <span class="c1">//ui实例化</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">sIp</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;127.0.0.1&quot;</span><span class="p">);</span>  <span class="c1">//在sIp命名的文本窗口里设置127.0.0.1（本地）</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">sPort</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;9999&quot;</span><span class="p">);</span>
        
      
    <span class="c1">//实例化 init</span>
    <span class="n">server</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QTcpServer</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="c1">//监听</span>
    <span class="n">server</span><span class="o">-&gt;</span><span class="n">listen</span><span class="p">(</span><span class="n">QHostAddress</span><span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">sIp</span><span class="o">-&gt;</span><span class="n">text</span><span class="p">()),</span> <span class="n">ui</span><span class="o">-&gt;</span><span class="n">sPort</span><span class="o">-&gt;</span><span class="n">text</span><span class="p">().</span><span class="n">toInt</span><span class="p">());</span>  <span class="c1">//port是字符串，用toint（）转化成整形值</span>
    
      
    <span class="c1">//链接(建立链接)【接受信号&amp;QTcpServer::newConnection】</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="o">&amp;</span><span class="n">QTcpServer</span><span class="o">::</span><span class="n">newConnection</span><span class="p">,</span><span class="k">this</span><span class="p">,[</span><span class="o">=</span><span class="p">]()</span>
    <span class="p">{</span>
       <span class="c1">//接受客服端的套接字对象 accpept</span>
       <span class="c1">//sock_addr 结构体 == 相当于qt中的 类QTcpSocket</span>
       <span class="n">conn</span> <span class="o">=</span> <span class="n">server</span><span class="o">-&gt;</span><span class="n">nextPendingConnection</span><span class="p">();</span>  <span class="c1">//监听请求队列拿到一个请求给“通讯”,初始化了conn .                                nextPendingConnection()接受客服端的套接字对象【及保存客户端的IP，port】</span>
       <span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg_record</span><span class="o">-&gt;</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;有新的连接.....&quot;</span><span class="p">);</span>
        
       <span class="c1">//保证conn 是一个有效的对像</span>
       <span class="c1">//接受数据 【&amp;QTcpSocket::readyRead】 （保证在连接成功的情况下接受数据）</span>
       <span class="n">connect</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="o">&amp;</span><span class="n">QTcpSocket</span><span class="o">::</span><span class="n">readyRead</span><span class="p">,</span><span class="k">this</span><span class="p">,[</span><span class="o">=</span><span class="p">]()</span>
       <span class="p">{</span>
           <span class="n">QByteArray</span> <span class="n">array</span> <span class="o">=</span> <span class="n">conn</span><span class="o">-&gt;</span><span class="n">readAll</span><span class="p">();</span>  <span class="c1">//conn-&gt;readAll();读取数据    QByteArray array接受返回值</span>
           <span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg_record</span><span class="o">-&gt;</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;对方说的：&quot;</span> <span class="o">+</span><span class="n">array</span><span class="p">);</span>   <span class="c1">//接受到的数据也放到聊天记录文本框</span>
       <span class="p">});</span>
    <span class="p">});</span>
   
        
    <span class="c1">//发送数据【write】</span>
    <span class="n">connect</span><span class="p">(</span> <span class="n">ui</span><span class="o">-&gt;</span><span class="n">send</span><span class="p">,</span><span class="o">&amp;</span><span class="n">QPushButton</span><span class="o">::</span><span class="n">clicked</span><span class="p">,</span><span class="k">this</span><span class="p">,[</span><span class="o">=</span><span class="p">]()</span>
    <span class="p">{</span>
        <span class="n">conn</span><span class="o">-&gt;</span><span class="n">write</span><span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">toPlainText</span><span class="p">().</span><span class="n">toUtf8</span><span class="p">().</span><span class="n">data</span><span class="p">());</span>  <span class="c1">//访问发送的文本框内容，并发送数据   //toPlainText()返回值是QString 而write（）接受值是char*或QBytearrayy</span>
<span class="c1">//把QString转化成QBytearrayy 用.toUtf8().data()转化</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg_record</span><span class="o">-&gt;</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;My Say: &quot;</span> <span class="o">+</span> <span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">toPlainText</span><span class="p">()</span> <span class="p">);</span>  <span class="c1">//在msg_record命名聊天记录文本框中显示聊天记录</span>
        <span class="c1">//clear</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">clear</span><span class="p">();</span>  <span class="c1">//发送完成后清空 msg_record命名聊天记录文本框</span>
    <span class="p">});</span>
<span class="p">}</span>

<span class="n">Server</span><span class="o">::~</span><span class="n">Server</span><span class="p">(){</span><span class="k">delete</span> <span class="n">ui</span><span class="p">;}</span>
</pre></div>
</div>
<p>==<strong>要的：</strong>==</p>
<ul class="simple">
<li><p>**server-&gt;listen(QHostAddress(ui-&gt;sIp-&gt;text()),ui-&gt;sPort-&gt;text().toInt()   **</p>
<ul>
<li><p>建立连接<strong>接受信号【&amp;QTcpServer::newConnection】   用toInt（）转化成整形值</strong></p></li>
</ul>
</li>
<li><p><strong>nextPendingConnection()接受客服端的套接字对象【及保存客户端的IP，port】</strong></p></li>
<li><p><strong>接受数据 【&amp;QTcpSocket::readyRead】</strong></p></li>
<li><p><strong>conn-&gt;readAll();  接受读取数据</strong></p></li>
<li><p><strong>发送数据【write（）】       .toPlainText().toUtf8().data()转换： 把QString转化成QBytearrayy</strong></p></li>
</ul>
<p>+++</p>
</section>
<section id="id97">
<h3>客户端：<a class="headerlink" href="#id97" title="永久链接至标题">¶</a></h3>
<p>客户端 .h 文件：</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifndef CLIENT_H</span>
<span class="cp">#define CLIENT_H</span>

<span class="cp">#include</span> <span class="cpf">&lt;QWidget&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;QTcpSocket&gt;</span><span class="cp"></span>
<span class="k">namespace</span> <span class="n">Ui</span> <span class="p">{</span>
<span class="k">class</span> <span class="nc">Client</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Client</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>

<span class="k">public</span><span class="o">:</span>
    <span class="k">explicit</span> <span class="n">Client</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
    <span class="o">~</span><span class="n">Client</span><span class="p">();</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">Ui</span><span class="o">::</span><span class="n">Client</span> <span class="o">*</span><span class="n">ui</span><span class="p">;</span>
    
    <span class="n">QTcpSocket</span><span class="o">*</span> <span class="n">client</span><span class="p">;</span>    <span class="c1">// 通讯的套接字</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="c1">// CLIENT_H</span>
</pre></div>
</div>
<p>客户端.cpp文件：</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;client.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;ui_client.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;QHostAddress&gt;</span><span class="cp"></span>

<span class="n">Client</span><span class="o">::</span><span class="n">Client</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">),</span>
    <span class="n">ui</span><span class="p">(</span><span class="k">new</span> <span class="n">Ui</span><span class="o">::</span><span class="n">Client</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">setupUi</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="c1">//ui实例化</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">sIp</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;127.0.0.1&quot;</span><span class="p">);</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">sPort</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;9999&quot;</span><span class="p">);</span>

    <span class="c1">//init</span>
    <span class="n">client</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QTcpSocket</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        
    <span class="c1">//链接(建立链接）  连接服务器    </span>
    <span class="n">client</span><span class="o">-&gt;</span><span class="n">connectToHost</span><span class="p">(</span><span class="n">QHostAddress</span><span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">sIp</span><span class="o">-&gt;</span><span class="n">text</span><span class="p">()),</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">sPort</span><span class="o">-&gt;</span><span class="n">text</span><span class="p">().</span><span class="n">toInt</span><span class="p">());</span>
        
    <span class="c1">//接收数据:  [如果链接成功去]</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">client</span><span class="p">,</span><span class="o">&amp;</span><span class="n">QTcpSocket</span><span class="o">::</span><span class="n">readyRead</span><span class="p">,</span><span class="k">this</span><span class="p">,[</span><span class="o">=</span><span class="p">](){</span>
       <span class="c1">//接受数据</span>
        <span class="n">QByteArray</span> <span class="n">array</span> <span class="o">=</span> <span class="n">client</span><span class="o">-&gt;</span><span class="n">readAll</span><span class="p">();</span>  <span class="c1">//client-&gt;readAll();读取数据    QByteArray array接受返回值</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg_record</span><span class="o">-&gt;</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;对方说的：&quot;</span> <span class="o">+</span> <span class="n">array</span><span class="p">);</span>   <span class="c1">//接受到的数据也放到聊天记录文本框</span>
    <span class="p">});</span>
        
        
    <span class="c1">//发送数据</span>
    <span class="n">connect</span><span class="p">(</span> <span class="n">ui</span><span class="o">-&gt;</span><span class="n">send</span><span class="p">,</span><span class="o">&amp;</span><span class="n">QPushButton</span><span class="o">::</span><span class="n">clicked</span><span class="p">,</span><span class="k">this</span><span class="p">,[</span><span class="o">=</span><span class="p">]()</span>
    <span class="p">{</span>
        <span class="n">client</span><span class="o">-&gt;</span><span class="n">write</span><span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">toPlainText</span><span class="p">().</span><span class="n">toUtf8</span><span class="p">().</span><span class="n">data</span><span class="p">());</span>  <span class="c1">//访问发送的文本框内容，并发送数据   toPlainText()返回值是QString 而write（）接受值是char*或QBytearrayy</span>
                                                              <span class="c1">//把QString转化成QBytearrayy 用.toUtf8().data()转化</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg_record</span><span class="o">-&gt;</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;Me Say: &quot;</span> <span class="o">+</span> <span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">toPlainText</span><span class="p">()</span> <span class="p">);</span>  <span class="c1">//在聊天记录文本框中显示聊天记录</span>
        <span class="c1">//clear</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">clear</span><span class="p">();</span>  <span class="c1">//发送完成后清空</span>
    <span class="p">});</span>
<span class="p">}</span>

<span class="n">Client</span><span class="o">::~</span><span class="n">Client</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">delete</span> <span class="n">ui</span><span class="p">;</span>

   
</pre></div>
</div>
<p><strong>要点：</strong>//链接(建立链接）  连接服务器
client-&gt;<strong>connectToHost</strong>(QHostAddress(ui-&gt;sIp-&gt;text()),ui-&gt;sPort-&gt;text().toInt())</p>
<p>+++</p>
<p>main.cpp文件：</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;server.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;QApplication&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;client.h&gt;           //添加客户端头文件</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="n">QApplication</span> <span class="n">a</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span>
    
    
    <span class="n">Server</span> <span class="n">w</span><span class="p">;</span>
    <span class="n">w</span><span class="p">.</span><span class="n">show</span><span class="p">();</span>
    <span class="n">w</span><span class="p">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s">&quot;server&quot;</span><span class="p">);</span>
    <span class="n">w</span><span class="p">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">714</span><span class="p">,</span><span class="mi">650</span><span class="p">);</span>

    <span class="n">Client</span> <span class="n">c</span><span class="p">;</span>
    <span class="n">c</span><span class="p">.</span><span class="n">show</span><span class="p">();</span>
    <span class="n">c</span><span class="p">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s">&quot;client&quot;</span><span class="p">);</span>
    <span class="n">c</span><span class="p">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">496</span><span class="p">,</span><span class="mi">430</span><span class="p">);</span>


    <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">exec</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="qtudp">
<h2>知识点二十五: QT中的UDP通信<a class="headerlink" href="#qtudp" title="永久链接至标题">¶</a></h2>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164767641423131.png" /></p>
<p><strong>.pro文件；</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+=</span> <span class="n">core</span> <span class="n">gui</span> <span class="n">network</span>
</pre></div>
</div>
<p>*.h文件：</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifndef WIDGET_H</span>
<span class="cp">#define WIDGET_H</span>

<span class="cp">#include</span> <span class="cpf">&lt;QWidget&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;QUdpSocket&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">Ui</span> <span class="p">{</span>
<span class="k">class</span> <span class="nc">Widget</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Widget</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>

<span class="k">public</span><span class="o">:</span>
    <span class="k">explicit</span> <span class="n">Widget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
    <span class="o">~</span><span class="n">Widget</span><span class="p">();</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">Ui</span><span class="o">::</span><span class="n">Widget</span> <span class="o">*</span><span class="n">ui</span><span class="p">;</span>
    
    <span class="n">QUdpSocket</span><span class="o">*</span> <span class="n">udp1</span><span class="p">;</span>        <span class="c1">// 通讯的套接字</span>

<span class="p">};</span>

<span class="cp">#endif </span><span class="c1">// WIDGET_H</span>
</pre></div>
</div>
<section id="id98">
<h3>服务器端<a class="headerlink" href="#id98" title="永久链接至标题">¶</a></h3>
<p><strong>.cpp文件：</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;ui_widget.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;QHostAddress&gt;</span><span class="cp"></span>

<span class="n">Widget</span><span class="o">::</span><span class="n">Widget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">),</span>
    <span class="n">ui</span><span class="p">(</span><span class="k">new</span> <span class="n">Ui</span><span class="o">::</span><span class="n">Widget</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">setupUi</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">cIp</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;127.0.0.1&quot;</span><span class="p">);</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">cPort</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;9999&quot;</span><span class="p">);</span>
        
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">sPort</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;8888&quot;</span><span class="p">);</span>  <span class="c1">//服务器端口</span>
    <span class="c1">//init</span>
    <span class="n">udp1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QUdpSocket</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="c1">//if want recive must bind port绑定自己的端口</span>
    <span class="n">udp1</span><span class="o">-&gt;</span><span class="n">bind</span><span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">sPort</span><span class="o">-&gt;</span><span class="n">text</span><span class="p">().</span><span class="n">toInt</span><span class="p">());</span>
        
        
    <span class="c1">//send msg发送数据       （不能保证在连接成功的情况下接受数据）</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">send</span><span class="p">,</span><span class="o">&amp;</span><span class="n">QPushButton</span><span class="o">::</span><span class="n">clicked</span><span class="p">,</span><span class="k">this</span><span class="p">,[</span><span class="o">=</span><span class="p">]()</span>
    <span class="p">{</span>
        <span class="n">udp1</span><span class="o">-&gt;</span><span class="n">writeDatagram</span><span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">toPlainText</span><span class="p">().</span><span class="n">toUtf8</span><span class="p">().</span><span class="n">data</span><span class="p">(),</span> <span class="n">QHostAddress</span><span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">cIp</span><span class="o">-&gt;</span><span class="n">text</span><span class="p">()),</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">cPort</span><span class="o">-&gt;</span><span class="n">text</span><span class="p">().</span><span class="n">toInt</span><span class="p">()</span> <span class="p">);</span> <span class="c1">//QHostAddress(ui-&gt;cIp-&gt;text(),ui-&gt;cPort-&gt;text().toInt(</span>
                                                                                                                             <span class="c1">//对方的</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg_record</span><span class="o">-&gt;</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;My say: &quot;</span> <span class="o">+</span> <span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">toPlainText</span><span class="p">());</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">clear</span><span class="p">();</span>     <span class="c1">//清理msg</span>
    <span class="p">});</span>
        
        
    <span class="c1">//read msg接受数据：</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">udp1</span><span class="p">,</span><span class="o">&amp;</span><span class="n">QUdpSocket</span><span class="o">::</span><span class="n">readyRead</span><span class="p">,</span><span class="k">this</span><span class="p">,[</span><span class="o">=</span><span class="p">]</span>
    <span class="p">{</span>
        <span class="n">qint64</span> <span class="n">size</span> <span class="o">=</span> <span class="n">udp1</span><span class="o">-&gt;</span><span class="n">pendingDatagramSize</span><span class="p">();</span>   <span class="c1">//pending待定   Datagram数据报</span>
        <span class="n">QByteArray</span> <span class="nf">array</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">udp1</span><span class="o">-&gt;</span><span class="n">readDatagram</span><span class="p">(</span><span class="n">array</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="n">size</span><span class="p">);</span>
        
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg_record</span><span class="o">-&gt;</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;对方： &quot;</span> <span class="o">+</span> <span class="n">array</span><span class="p">);</span>

    <span class="p">});</span>
<span class="p">}</span>

<span class="n">Widget</span><span class="o">::~</span><span class="n">Widget</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">delete</span> <span class="n">ui</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>客户端 .h 文件：没有添加的</p>
</section>
<section id="id99">
<h3><strong>客户端</strong><a class="headerlink" href="#id99" title="永久链接至标题">¶</a></h3>
<p><strong>.cpp文件：</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;client.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;ui_client.h&quot;</span><span class="cp"></span>

<span class="n">Client</span><span class="o">::</span><span class="n">Client</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">),</span>
    <span class="n">ui</span><span class="p">(</span><span class="k">new</span> <span class="n">Ui</span><span class="o">::</span><span class="n">Client</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">setupUi</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">setupUi</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">sIp</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;127.0.0.1&quot;</span><span class="p">);</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">sPort</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;8888&quot;</span><span class="p">);</span>
        
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">cPort</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;9999&quot;</span><span class="p">);</span> <span class="c1">//自己的端口</span>

    <span class="n">udp2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QUdpSocket</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="c1">//if want recive must bind port</span>
    <span class="n">udp2</span><span class="o">-&gt;</span><span class="n">bind</span><span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">cPort</span><span class="o">-&gt;</span><span class="n">text</span><span class="p">().</span><span class="n">toInt</span><span class="p">());</span>
        
        
    <span class="c1">//send msg指定要发送的客户端IP和端口</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">send</span><span class="p">,</span><span class="o">&amp;</span><span class="n">QPushButton</span><span class="o">::</span><span class="n">clicked</span><span class="p">,</span><span class="k">this</span><span class="p">,[</span><span class="o">=</span><span class="p">]</span>
    <span class="p">{</span>
        <span class="n">udp2</span><span class="o">-&gt;</span><span class="n">writeDatagram</span><span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">toPlainText</span><span class="p">().</span><span class="n">toUtf8</span><span class="p">().</span><span class="n">data</span><span class="p">(),</span><span class="n">QHostAddress</span><span class="p">(</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">sIp</span><span class="o">-&gt;</span><span class="n">text</span><span class="p">()),</span><span class="n">ui</span><span class="o">-&gt;</span><span class="n">sPort</span><span class="o">-&gt;</span><span class="n">text</span><span class="p">().</span><span class="n">toInt</span><span class="p">());</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg_record</span><span class="o">-&gt;</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;My say: &quot;</span> <span class="o">+</span> <span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">toPlainText</span><span class="p">());</span>
        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">clear</span><span class="p">();</span>
    <span class="p">});</span>
        
        
    <span class="c1">//read msg、接受数据</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">udp2</span><span class="p">,</span><span class="o">&amp;</span><span class="n">QUdpSocket</span><span class="o">::</span><span class="n">readyRead</span><span class="p">,</span><span class="k">this</span><span class="p">,[</span><span class="o">=</span><span class="p">]{</span>

        <span class="n">qint64</span> <span class="n">size</span> <span class="o">=</span> <span class="n">udp2</span><span class="o">-&gt;</span><span class="n">pendingDatagramSize</span><span class="p">();</span>
        <span class="n">QByteArray</span> <span class="nf">array</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">udp2</span><span class="o">-&gt;</span><span class="n">readDatagram</span><span class="p">(</span><span class="n">array</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="n">size</span><span class="p">);</span>

        <span class="n">ui</span><span class="o">-&gt;</span><span class="n">msg_record</span><span class="o">-&gt;</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;对方: &quot;</span> <span class="o">+</span> <span class="n">array</span><span class="p">);</span>
    <span class="p">});</span>

<span class="p">}</span>

<span class="n">Client</span><span class="o">::~</span><span class="n">Client</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">delete</span> <span class="n">ui</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><img alt="在这里插入图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/bd69de69a88e4bfab5cb649ddec9b6eb.gif" /></p>
<p>==要点：==</p>
<ul class="simple">
<li><p><strong>bind(ui-&gt;sPort-&gt;text().toInt())    直接建立连接，不用监听</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>发送数据 writeDatagram</strong>      .toPlainText().toUtf8().data()转换： 把QString转化成QBytearrayy****</p></li>
</ul>
<ul>
<li><p><strong>接受数据 【&amp;QTcpSocket::readyRead】</strong>**</p>
<ul class="simple">
<li><p><strong>qint64 size = udp1-&gt;pendingDatagramSize();   //pending待定   Datagram数据报</strong></p></li>
</ul>
<p>​       <strong>QByteArray array(size,0);</strong>
​       <strong>udp1-&gt;readDatagram(array.data(),size);</strong></p>
</li>
</ul>
</section>
</section>
<section id="id100">
<h2>知识点二 十六: QT广播/组播<a class="headerlink" href="#id100" title="永久链接至标题">¶</a></h2>
<section id="udp">
<h3><strong>广播</strong>：UDP<a class="headerlink" href="#udp" title="永久链接至标题">¶</a></h3>
<blockquote>
<div><p>例如前面在UDP中， 我们发送信息都是指定发送的内容，对方的IP地址和对方的端口号，相当于给一个人发信息。广播的意义在于给好多人发消息。
.
<strong>于是IP换一下就成为广播了</strong></p>
</div></blockquote>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164767917981534.png" /></p>
<p><strong>组播</strong></p>
<blockquote>
<div><p>例如服务器要进行组播,组播的话要进行设置组播段号,同时还需要要自身绑定更改</p>
</div></blockquote>
<p><img alt="image-20220319164310017" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220319164310017.png" /></p>
<p>+++</p>
</section>
</section>
</section>
<section id="day05">
<h1>day05<a class="headerlink" href="#day05" title="永久链接至标题">¶</a></h1>
<section id="tcp">
<h2>知识点二十七: TCP文件传输<a class="headerlink" href="#tcp" title="永久链接至标题">¶</a></h2>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/V244FV%%4NV71PS%G_BW%60R.png" /></p>
<p><img alt="image-20220319164657448" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220319164657448.png" /></p>
<p><img alt="img" src="https://img-blog.csdnimg.cn/3beba34d0ca6451faa953dbc22e3f5d8.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16" /></p>
<section id="id101">
<h3><strong>服务端</strong>：<a class="headerlink" href="#id101" title="永久链接至标题">¶</a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifndef SERVER_H</span>
<span class="cp">#define SERVER_H</span>

<span class="cp">#include</span> <span class="cpf">&lt;QWidget&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;QTcpServer&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;QTcpSocket&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;QFile&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;QTimer&gt;</span><span class="cp"></span>
<span class="k">namespace</span> <span class="n">Ui</span> <span class="p">{</span>
<span class="k">class</span> <span class="nc">Server</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Server</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>

<span class="k">public</span><span class="o">:</span>
    <span class="k">explicit</span> <span class="n">Server</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">sendData</span><span class="p">();</span> <span class="c1">//接受文件数据</span>
    <span class="o">~</span><span class="n">Server</span><span class="p">();</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">Ui</span><span class="o">::</span><span class="n">Server</span> <span class="o">*</span><span class="n">ui</span><span class="p">;</span>
    <span class="n">QTcpServer</span><span class="o">*</span> <span class="n">watch</span><span class="p">;</span>
    <span class="n">QTcpSocket</span><span class="o">*</span> <span class="n">chat</span><span class="p">;</span>

<span class="p">};</span>

<span class="cp">#endif </span><span class="c1">// SERVER_H</span>
</pre></div>
</div>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-16476828244772.png" /></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>#include &quot;server.h&quot;
#include &quot;ui_server.h&quot;
#include &lt;QFile&gt;
#include &lt;QFileDialog&gt;
#include &lt;QMessageBox&gt;
#include &lt;QTimer&gt;
#include &lt;QPushButton&gt;

Server::Server(QWidget *parent) :
    QWidget(parent),
    ui(new Ui::Server)
{
    ui-&gt;setupUi(this);
    //监听套接字
    watch =new QTcpServer(this);

    //监听  这里是任意 IP 但是指定了端口号
    watch-&gt;listen( QHostAddress::Any , 77 );

    //如果有新的连接  watch相对与之前的serrver都是命名
    connect( watch ,&amp;QTcpServer::newConnection,   this, [=]()
    {

        //接收客户端套接字对象,从连接请求中选择一个请求连接
        chat = watch-&gt;nextPendingConnection();

        //获取对方的ip和端口：
        QString ip = chat-&gt;peerAddress().toString();
        quint16 sort = chat-&gt;peerPort();
        
		//input1是文本框命称
        ui-&gt;input1-&gt;append( QString(&quot;连接成功%1:%2&quot;).arg(ip).arg(sort) );
        ui-&gt;input1-&gt;append(&quot;请选则你要传输的文件&quot; );
    });

        
    //选择文件 + 读取文件：
     connect(ui-&gt;choose1 , &amp;QPushButton::clicked , this, [=]()
     {
        QString filepath = QFileDialog::getOpenFileName ( this ,  &quot;请选择文件&quot; , &quot;e\\&quot; );
        if( filepath.isEmpty() == true  )
            QMessageBox::warning (this  ,   &quot;警告&quot; , &quot;文件打开失败&quot;);
      
        //文本框里显示文件路径：
        ui-&gt;input1-&gt;append(filepath);

        //获取文件的名字和大小
        QFileInfo qfi(filepath) ;
        //为头报文做准备    
        QString filename= qfi.fileName();
        qint64 filesize = qfi.size();

        //设置已发送大小变量
         qint64 sendsize = 0;

         //读取文件
        QFile file；
        file.setFileName(filepath) ;    //or QFile file(filepath)
        bool a = file.open(QFile::ReadOnly);
        if (a == false)
        {
            QMessageBox::critical (this  ,   &quot;警告&quot; , &quot;文件读取失败&quot;);
            return ;
        }
    });

   QTimer timer = new QTimer(this);
   connect (&amp;timer ,&amp;QTimer::timeout , this , [=](){
        //先关闭定时器要用的时候开启
       timer.stop();
       // 调用自定义的函数：
       sendData();  
    });

   //发送按钮
   connect(ui-&gt;send1 , &amp;QPushButton::clicked , this, [=]()
   {
         //【先】发送头报文
         QString  head = QString(&quot;%1##%2&quot;).arg(filename).arg(filesize);

         qint64 len_head = chat-&gt;write( head.toUtf8() );   
      /* tcp 通讯的：
        conn-&gt;write(ui-&gt;msg-&gt;toPlainText().toUtf8().data());  
       //访问发送的文本框内容，并发送数据  
       //toPlainText()返回值是QString 而write（）接受值是char*或QBytearrayy
        //把QString转化成QBytearrayy 用.toUtf8().data()转化
       */
       
      
         if (len_head &gt; 0)         //如果发送的投报文有就执行
         {
            timer.start(1000) ;   //开启定时器
            ui-&gt;input1-&gt;append(&quot;正在发送文件&quot;);
         }
         else
         {
           qDebug()&lt;&lt;&quot;头部信息发送失败&quot; ;
           file.close();
         }
   });
}

//自定义的函数：
void Server::sendData(){

    //发送文件信息

    //发送文件
    qint64 len = 0 ;

    do{
        //设置,每次发送的大小为4k 
        char buf[4*1024]= {0};

        //读入源文件数据read（）
        len= file.read(  buf , sizeof(buf) );

        //发出数据 （这里是读多少,发送多少）
        len=chat-&gt;write( buf , len);

        //发送数据需要累积
        sendsize = sendsize + len;

    }while(len&gt;0 );   //只要len&gt;0 就不断循环do中的内容

    if (filesize == sendsize)
        {

        ui-&gt;input1-&gt;append(&quot;发送成功&quot;);
        file.close();

        //把客户端关了
        chat-&gt;disconnectFromHost();
        chat-&gt;close();
    }
}


Server::~Server(){ delete ui;}
</pre></div>
</div>
<p>+++</p>
</section>
<section id="id102">
<h3><strong>客户端</strong>：<a class="headerlink" href="#id102" title="永久链接至标题">¶</a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifndef CLIENT_H</span>
<span class="cp">#define CLIENT_H</span>

<span class="cp">#include</span> <span class="cpf">&lt;QWidget&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;QTcpSocket&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;QFile&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">Ui</span> <span class="p">{</span>
<span class="k">class</span> <span class="nc">client</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">client</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>

<span class="k">public</span><span class="o">:</span>
    <span class="k">explicit</span> <span class="n">client</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
    <span class="o">~</span><span class="n">client</span><span class="p">();</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">Ui</span><span class="o">::</span><span class="n">client</span> <span class="o">*</span><span class="n">ui</span><span class="p">;</span>
    <span class="n">QTcpSocket</span><span class="o">*</span> <span class="n">chat1</span><span class="p">;</span>
    <span class="n">QFile</span> <span class="n">file</span><span class="p">;</span>
    <span class="n">QString</span> <span class="n">filename</span><span class="p">;</span>
    <span class="n">qint64</span> <span class="n">filesize</span><span class="p">;</span>
    <span class="n">qint64</span> <span class="n">recevesize</span><span class="p">;</span>

    <span class="kt">bool</span> <span class="n">a</span><span class="p">;</span>

<span class="p">};</span>

<span class="cp">#endif </span><span class="c1">// CLIENT_H</span>
</pre></div>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>#include &quot;client.h&quot;
#include &quot;ui_client.h&quot;
#include &lt;QMessageBox&gt;
#include&lt;QHostAddress&gt;

client::client(QWidget *parent) :
    QWidget(parent),
    ui(new Ui::client)
{
    ui-&gt;setupUi(this);

    chat1= new QTcpSocket;

    a = true ;

    connect( ui-&gt;connect ,  &amp;QPushButton::clicked , this ,  [=](){

        QString ip = ui-&gt;ip1-&gt;text();
        qint16 sort = ui-&gt;sort1-&gt;text().toInt();

        //连接服务器 connectToHost
        chat1-&gt;connectToHost(QHostAddress(ip) , sort);

    } );
        

    //接受数据
    connect ( chat1 , &amp;QTcpSocket::readyRead, this, [=]()
    {

        QByteArray bta = chat1-&gt;readAll();    //发的就是头报文
        qDebug()&lt;&lt;bta;


        if(true == a )
        {

            //用a ==true,表示接受头部信息
            a = false ; 下一次执行else的代码去判断是否接受完毕（因为服务器是用循环一部分一部分发送的） 

            //解析头 ,字节数组转换为QString
            filename =QString(bta).section(&quot;##&quot;,0,0);
            filesize = QString(bta).section(&quot;##&quot;,1,1).toInt();

            recevesize=0;

            qDebug()&lt;&lt;filename&lt;&lt;filesize ;

            //打开文件(不会显示的)
            file.setFileName(&quot;C:\\&quot;+filename);
            bool ab = file.open(QFile::WriteOnly);
            if (ab == false)
                QMessageBox::critical (this  ,   &quot;警告&quot; , &quot; 接受文件失败&quot;);
        
        else  //文件信息
        {
            qint64 len = file.write(bta);  //这里的write是文件的读写
            recevesize = len +recevesize;

            if (recevesize == filesize)
            {
                file.close();
                QMessageBox::information(this , &quot;恭喜&quot; , &quot;文件接受完成&quot;);
                //关掉连接
                chat1-&gt;disconnectFromHost();
                chat1-&gt;close();
             }
         }
   });
}

client::~client(){delete ui;}
</pre></div>
</div>
<p>效果：</p>
<p><img alt="image-20220319195502998" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220319195502998.png" /></p>
<p>+++</p>
</section>
</section>
<section id="id103">
<h2>知识点二十八：视频播放 —&gt;基础  视频功能实现<a class="headerlink" href="#id103" title="永久链接至标题">¶</a></h2>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">//QMediaPlayer 类是   高级媒体播放类。可用于回放歌曲、电影及互联网广播内容。 ”Media“</span>
<span class="cp">#include</span> <span class="cpf">&lt;QMediaPlayer&gt;</span><span class="cp"></span>

<span class="c1">//这个是控制声音相关的  “哦丢‘</span>
<span class="cp">#include</span> <span class="cpf">&lt;QAudioOutput &gt;</span><span class="cp"></span>

<span class="c1">//QVideoWidget可以用于QMediaPlayer为渲染视频 和QMdeidaPlaylist为访问播放列表的功能</span>
<span class="cp">#include</span> <span class="cpf">&lt;QVideoWidget&gt;</span><span class="cp"></span>
</pre></div>
</div>
<p><img alt="请添加图片描述" src="https://img-blog.csdnimg.cn/5f258ba2762d4e34bf941c3fee5bdda4.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16" /></p>
<blockquote>
<div><p>在相应的pro文件里面引入</p>
</div></blockquote>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">QT</span>       <span class="o">+=</span> <span class="n">core</span> <span class="n">gui</span> <span class="n">multimedia</span> <span class="n">multimediawidgets</span> 
</pre></div>
</div>
<p><img alt="img" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/d438b0e100ec4776b0467cca2f8bc739-16477618983796.png" /></p>
<blockquote>
<div><p>对应的.h文件中</p>
</div></blockquote>
<p><img alt="在这里插入图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-16477619362408.png" /></p>
<blockquote>
<div><p>对应.cp文件中</p>
</div></blockquote>
<p><img alt="在这里插入图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164776232175310.png" /></p>
<blockquote>
<div><p>上面的代码是最基本的 播放，可以看到我们定义了一个播放窗口，实现效果如下： 并没有按我们预想的那样，展示在橙色区域，那是因为我们没有给他做一个联动。</p>
</div></blockquote>
<p><img alt="在这里插入图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164776239980712.png" /></p>
<p>==ui界面：==</p>
<p><img alt="请添加图片描述" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAd2Vla3Nvb28=,size_20,color_FFFFFF,t_70,g_se,x_16-164776288821514.png" /></p>
<p>代码：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p><img alt="image-20220320171047328" src="Qt/note/QT%E7%AC%94%E8%AE%B0.assets/image-20220320171047328.png" /></p>
</section>
</section>
<hr class="docutils" />
<section id="id104">
<h1>—————————————————–<a class="headerlink" href="#id104" title="永久链接至标题">¶</a></h1>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2022, JinDao.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>